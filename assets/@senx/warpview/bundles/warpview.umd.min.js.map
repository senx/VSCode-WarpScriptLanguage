{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.js","ng://@senx/warpview/src/lib/model/dataModel.ts","ng://@senx/warpview/src/lib/utils/logger.ts","ng://@senx/warpview/src/lib/utils/gts.lib.ts","ng://@senx/warpview/src/lib/model/chartBounds.ts","ng://@senx/warpview/src/lib/utils/color-lib.ts","ng://@senx/warpview/src/lib/utils/chart-lib.ts","ng://@senx/warpview/src/lib/model/param.ts","ng://@senx/warpview/src/lib/plotly/plotly.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-component.ts","ng://@senx/warpview/src/lib/services/resize.service.ts","ng://@senx/warpview/src/lib/utils/timsort.ts","ng://@senx/warpview/src/lib/elements/warp-view-chart/warp-view-chart.component.ts","ng://@senx/warpview/src/lib/services/http-error-handler.service.ts","ng://@senx/warpview/src/lib/services/warp10.service.ts","ng://@senx/warpview/src/lib/elements/warp-view-tile/warp-view-tile.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-spinner/warp-view-spinner.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-toggle/warp-view-toggle.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-bar/warp-view-bar.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-bubble/warp-view-bubble.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-datagrid/warp-view-datagrid.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-datagrid/warp-view-paginable/warp-view-paginable.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-display/warp-view-display.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-drill-down/warp-view-drill-down.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-drill-down/model/datum.ts","ng://@senx/warpview/src/lib/elements/warp-view-drill-down/calendar-heatmap/calendar-heatmap.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-modal/warp-view-modal.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-gts-popup/warp-view-gts-popup.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-gts-tree/warp-view-gts-tree.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-gts-tree/warp-view-tree-view/warp-view-tree-view.component.ts","ng://@senx/warpview/src/lib/model/GTS.ts","ng://@senx/warpview/src/lib/elements/warp-view-gts-tree/warp-view-chip/warp-view-chip.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-image/warp-view-image.component.ts","ng://@senx/warpview/src/lib/utils/map-lib.ts","ng://@senx/warpview/src/lib/elements/warp-view-map/warp-view-map.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-map/warp-view-heatmap-sliders/warp-view-heatmap-sliders.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-pie/warp-view-pie.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-gauge/warp-view-gauge.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-annotation/warp-view-annotation.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-polar/warp-view-polar.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-radar/warp-view-radar.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-plot/warp-view-plot.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-resize/warp-view-resize.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-slider/warp-view-slider.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-range-slider/warp-view-range-slider.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-spectrum/warp-view-spectrum.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-box/warp-view-box.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-3d-line/warp-view-3d-line.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-globe/warp-view-globe.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-event-drop/warp-view-event-drop.component.ts","ng://@senx/warpview/src/lib/elements/warp-view-result-tile/warp-view-result-tile.component.ts","ng://@senx/warpview/src/lib/warp-view-angular.module.ts"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","TypeError","pop","push","__read","o","m","r","ar","error","__spread","concat","DataModel","Logger","className","isDebug","name","setDebug","debug","log","level","methods","args","logChain","Date","toISOString","join","LEVEL","DEBUG","console","ERROR","INFO","WARN","warn","_i","info","GTSLib","cleanArray","actual","filter","unique","arr","u","a","l","isArray","splice","propertyIsEnumerable","formatElapsedTime","elapsed","toFixed","isValidResponse","data","response","JSON","parse","LOG","isEmbeddedImage","item","test","isEmbeddedImageObject","image","caption","isPositionArray","positions","isPositionsArrayWithValues","isPositionsArrayWithTwoValues","forEach","j","gtsFromJSON","json","id","gts","c","gtsFromJSONList","jsonList","prefixId","gtsList","undefined","isGts","content","flatDeep","arr1","reduce","acc","val","flattenGtsIdArray","res","walk","sanitizeNames","input","replace","serializeGtsMetadata","_this","serializedLabels","serializedAttributes","keys","key","isGtsToPlot","some","isGtsToPlotOnMap","isSingletonGTS","isGtsToAnnotate","gtsSort","isSorted","sort","getData","getDivider","timeUnit","timestampDivider","formatLabel","serializedGTS","split","display","labels_1","substr","labels_2","ChartBounds","tsmin","tsmax","msmin","msmax","marginLeft","ColorLib","getColor","scheme","color","getColorGradient","transparentize","getBlendedColorGradient","bg","blend_colors","getColorScale","map","hexToRgb","hex","exec","parseInt","alpha","generateColors","num","generateTransparentColors","hsvGradientFromRgbColors","c1","c2","steps","c1hsv","rgb2hsv","c2hsv","h","gradient","hsvGradient","rgb","hsv2rgb","Math","floor","normR","normG","normB","M","max","min","distCCW","distCW","q","rgb2hex","componentToHex","toString","color1","color2","percentage","Error","substring","color3","color3Str","int_to_hex","round","COHESIVE","COHESIVE_2","BELIZE","VIRIDIS","MAGMA","INFERNO","PLASMA","YL_OR_RD","YL_GN_BU","BU_GN","WARP10","NINETEEN_EIGHTY_FOUR","ATLANTIS","DO_ANDROIDS_DREAM","DELOREAN","CTHULHU","ECTOPLASM","T_MAX_400_FILM","ChartLib","mergeDeep","base","extended","prop","DEFAULT_WIDTH","DEFAULT_HEIGHT","horizontal","stacked","showControls","showErrors","showStatus","showDots","timeZone","tiles","showTimeSlider","showTimeRange","timeSliderMode","bounds","PlotlyComponent","iterableDiffers","el","keyValueDiffers","defaultClassName","revision","useResizeHandler","updateOnLayoutChange","updateOnDataChange","updateOnlyWithRevision","initialized","EventEmitter","update","purge","afterExport","afterPlot","animated","animatingFrame","animationInterrupted","autoSize","beforeExport","buttonClicked","click","plotly_click","clickAnnotation","deselect","doubleClick","framework","hover","legendClick","legendDoubleClick","relayout","restyle","redraw","selected","selecting","sliderChange","sliderEnd","sliderStart","transitioning","transitionInterrupted","unhover","relayouting","eventNames","ngOnInit","createPlot","figure","createFigure","emit","plotlyInstance","ngOnDestroy","resizeHandler","getWindow","removeEventListener","remove","ngOnChanges","changes","currentValue","isFirstChange","layout","config","updatePlot","updateWindowResizeHandler","ngDoCheck","shouldUpdate","layoutDiffer","diff","find","dataDiffer","dataDifferTrackBy","window","getBoundingClientRect","rect","getClassName","classes","restyleChart","properties","curves","Plotlyjs.restyle","Plotlyjs.react","plotEl","nativeElement","gd","eventName","toLowerCase","on","err","frames","_transitionData","_frames","Plotlyjs.purge","setTimeout","Plots","resize","addEventListener","obj","uid","stringify","div","Component","selector","template","encapsulation","ViewEncapsulation","ShadowDom","IterableDiffers","ElementRef","KeyValueDiffers","ViewChild","static","Input","Output","WarpViewComponent","renderer","sizeService","ngZone","width","height","chartDraw","_options","Param","defOptions","dotsLimit","heatControls","timeMode","showRangeSelector","gridLineColor","_debug","_showLegend","_responsive","_unit","_autoResize","_hiddenData","tooltipPosition","top","left","loading","noData","margin","plotlyConfig","responsive","showAxisDragHandles","scrollZoom","showTips","plotGlPixelRatio","staticPlot","displaylogo","modeBarButtonsToRemove","sizeChanged$","subscribe","size","parentElement","parentSize","graph","layout_1","defineProperty","hiddenData","unit","showLegend","options","deepEqual","_data","legendFormatter","x","series","highlighted","displayedCurves","labeledData","text","line","marker","curveNumber","html","theta","sa","sb","slice","indexOf","orientation","initChart","moment.tz","setDefault","dataModel","globalParams","divider","plotlyData","convert","paper_bgcolor","plot_bgcolor","minDate","maxDate","xmin","xmax","ceil","ymin","yRanges","ymax","xaxis","range","hideTooltip","hideTooltipTimer","clearTimeout","toolTip","style","point","delta","Number","MAX_VALUE","points","y_1","yvals","abs","x_1","xvals","event","offsetX","chartContainer","clientWidth","top_1","moveTooltip","getTooltipPosition","setProperty","$event","getLabelColor","getCSSColor","trim","getGridColor","property","defColor","getComputedStyle","getPropertyValue","Size","SizeService","change","Timsort","array","compare","minGallop","DEFAULT_MIN_GALLOPING","tmpStorageLength","DEFAULT_TMP_STORAGE_LENGTH","stackLength","runStart","runLength","stackSize","tmp","log10","minRunLength","DEFAULT_MIN_MERGE","makeAscendingRun","lo","hi","runHi","reverseRun","binaryInsertionSort","start","pivot","right","mid","gallopLeft","hint","maxOffset","lastOffset","offset","gallopRight","alphabeticalCompare","al","bl","POWERS_OF_TEN","aStr","String","bStr","remaining","ts","minRun","force","pushRun","mergeRuns","forceMergeRuns","mergeAt","start1","length1","start2","length2","k","mergeLow","mergeHigh","cursor1","cursor2","dest","count1","count2","exit","customCursor","customDest","WarpViewChartComponent","_super","standalone","boundsDidChange","pointHover","warpViewChartResize","_type","visibility","maxTick","minTick","visibleGtsId","gtsId","dataHashset","chartBounds","visibilityStatus","afterBoundsUpdate","maxPlottable","parsing","unhighliteCurve","Subject","highliteCurve","showlegend","autosize","hovermode","hoverdistance","font","yaxis","exponentformat","fixedrange","automargin","showline","tslib_1.__extends","previousVisibility","newVisibility","visible_1","hidden_1","visible","type","drawChart","refresh","getTimeClip","newHeight","rangeslider","bgcolor","thickness","reparseNewData","tick0","moment","tz","gridcolor","zerolinecolor","pipe","debounceTime","opacity","off","emitNewBounds","source","valueOf","dataset","NEGATIVE_INFINITY","POSITIVE_INFINITY","nonPlottable","timestampMode_1","tsLimit_1","ticks","params","datasetColor","mode","hoverinfo","connectgaps","fill","shape","fillcolor","values","utc","querySelector","getAttribute","updateBounds","autorange","setRealBounds","y_2","x_2","Renderer2","NgZone","HttpErrorHandler","createHandleError","serviceName","operation","handleError","statusText","message","status","of","Injectable","Warp10Service","http","httpErrorHandler","warpScript","url","post","observe","responseType","tap","catchError","providedIn","HttpClient","WarpViewTileComponent","warp10Service","warpscriptResult","execStatus","execError","isAlone","loaderMessage","_gtsFilter","_warpScript","execUrl","gtsFilter","execute","ngAfterViewInit","warpRef","textContent","handleKeyDown","detectWarpScriptSpecialComments","extraParamsPattern","warpscriptLines","currentLine","search","lineOnMatch","re","RegExp","parameterName","parameterValue","isRefresh","execResult","body_1","headers","get","fetched","_autoRefresh","autoRefresh","timer","clearInterval","setInterval","chartDrawn","providers","HostListener","WarpViewSpinnerComponent","WarpViewToggleComponent","text1","text2","stateChange","state","checked","switched","WarpViewBarComponent","buildGraph","series_1","columns","index","rows","unshift","barmode","WarpViewBubbleComponent","sizes","WarpViewDatagridComponent","elemsCount","_tabularData","getHeaderParam","def","dataList","parseData","parseCustomData","flatData","dataSet","title","formatDate","date","WarpViewPaginableComponent","windowed","page","pages","displayedValues","drawGridData","goto","prev","decodeURIComponent","str","WarpViewDisplayComponent","toDisplay","flexFont","displayDuration","getStyle","background-color","bgColor","fontColor","wrapper","fitties","unsubscribe","fitty","maxSize","clientHeight","minSize","fit","now","duration","humanize","WarpViewDrillDownComponent","parentWidth","onResize","resizeTimer","heatMapData","details","dates","reducer","accumulator","refDate","startOf","total","summary","CalendarHeatmapComponent","overview","handler","_minColor","DEF_MIN_COLOR","_maxColor","DEF_MAX_COLOR","gutter","gWidth","gHeight","itemSize","labelPadding","transitionDuration","inTransition","tooltipWidth","tooltipPadding","history","Datum","getTooltip","tooltipHtml","format","calculateDimensions","minColor","maxColor","getNumberOfWeeks","dayIndex","subtract","trunc","chart","svg","select","append","attr","items","labels","buttons","tooltip","groupBy","xs","rv","updateDataSummary","uniques","project","unsortedSummary","drawGlobalOverview","end","drawYearOverview","endOf","drawMonthOverview","drawWeekOverview","drawDayOverview","startPeriod","endPeriod","yData","isBetween","group","asYears","scale","year","month","yearData","current","_summary","maxValue","yearLabels","yearScale","scaleBand","rangeRound","padding","domain","scaleLinear","selectAll","enter","removeGlobalOverview","transition","ease","easeLinear","delay","callback","empty","each","yearLabel","startOfYear","endOfYear","calcItemX","calcItemSize","calcItemY","removeYearOverview","circle","currentTarget","repeat","cos","PI","random","asMonths","monthLabels","monthScale","selectedMonth","isSame","dayLabels","timeDays","toDate","dayScale","weekday","bandwidth","selectedDay","day","drawButton","startOfMonth","endOfMonth","monthData","det","hours","sum","weekLabels","incWeek","week","add","weekScale","calcItemXMonth","removeMonthOverview","startOfWeek","endOfWeek","weekData","hoursLabels","hourScale","removeWeekOverview","hour","startOfDay","endOfDay","dayData","gtsNames","gtsNameScale","hourLabels","textLength","node","getComputedTextLength","gtsName","hourIndex","button","removeDayOverview","hideBackButton","WarpViewModalComponent","modalTitle","kbdLastKeyPressed","warpViewModalOpen","warpViewModalClose","opened","open","zIndex","close","isOpened","path","nodeName","WarpViewGtsPopupComponent","maxToShow","warpViewSelectedGTS","_gts","_kbdLastKeyPressed","displayed","modalOpenned","prepareData","_gtsList","showPopup","onWarpViewModalOpen","onWarpViewModalClose","modal","isHidden","WarpViewGtsTreeComponent","expand","initOpen","doRender","foldGTSTree","foldAll","root","toggleVisibility","warpViewSelectedGTSHandler","WarpViewTreeViewComponent","branch","hidden","hide","eventsSubscription","events","GTS","WarpViewChipComponent","param","refreshCounter","_node","colorizeChip","setState","chip","toArray","switchPlotState","preventDefault","WarpViewImageComponent","imageTitle","MapLib","toLeafletMapPaths","paths","gtsToPath","lat","lon","annotationsToLeafletPositions","annotations","this_1","annotation","extractCommonParameters","render","validateWeightedDotsPositionArray","borderColor","baseRadius","isNaN","BASE_RADIUS","posArray","minValue","numSteps","pos","toLeafletMapPositionArray","this_2","validateWeightedColoredDotsPositionArray","minColorValue","maxColorValue","startColor","endColor","tests","numColorSteps","colorGradient","colorValue","getBoundsArray","positionsData","annotationsData","geoJson","pointsArray","position","geometry","coordinates","south","west","north","east","pathDataToLeaflet","pathData","firstIndex","from","lastIndex","to","toGeoJSON","defShapes","geoJsons","mapTypes","NONE","DEFAULT","link","attribution","HOT","TOPO","TOPO2","SURFER","HYDRA","HYDRA2","TONER","subdomains","TONER_LITE","TERRAIN","ESRI","SATELLITE","OCEANS","GRAY","attibs","GRAYSCALE","WATERCOLOR","CARTODB","CARTODB_DARK","WarpViewMapComponent","heatData","_firstDraw","currentValuesMarkers","annotationsMarkers","positionArraysMarkers","_iconAnchor","_popupAnchor","positionData","firstDraw","finalHeight","pathDataLayer","Leaflet","featureGroup","annotationsDataLayer","positionDataLayer","tileLayerGroup","geoJsonLayer","_map","resizeMe","reZoom","startZoom","startLat","startLong","drawMap","timeSlider","timeRangeSlider","setStyle","mapDiv","invalidateSize","heatRadiusDidChange","_heatLayer","setOptions","radius","detail","valueAsNumber","heatBlurDidChange","blur","heatOpacityDidChange","minOpacity","timeStart","timeSpan","flattenGTS","displayMap","icon","iconUrl","iconAnchor","popupAnchor","patchMapTileGapBug","originalInitTile","GridLayer","_initTile","isPatched","include","tile","tileSize","getTileSize","reDraw","lowerTimeBound","timeSliderMin","upperTimeBound","timeSliderMax","mapType","mapOpts","maxZoom","maxNativeZoom","tilesLayer","tileLayer","clearLayers","preferCanvas","layers","zoomAnimation","addTo","bringToBack","getCenter","lng","currentLong","getZoom","currentZoom","currentLat","plottedGts","updateGtsPath","beforeCurrentValue","afterCurrentValue","updatePositionArray","updateAnnotation","addLayer","timeEnd","opts","fillColor","pointToLayer","geoJsonPoint","latlng","geoShape","geoJSON","bindPopup","getBounds","isValid","setView","animate","fitBounds","heatLayer","heatRadius","heatBlur","heatOpacity","circleMarker","fillOpacity","weight","addPopup","polyline","content_1","inStep","onRangeSliderChange","highValue","onRangeSliderWindowChange","onSliderChange","updateTimeSpan","target","None","WarpViewHeatmapSlidersComponent","radiusChanged","blurChanged","opacityChanged","WarpViewPieComponent","legend","textfont","plotData","pieData","colors","hoverlabel","bordercolor","hole","WarpViewGaugeComponent","CHART_MARGIN","grid","pattern","xgap","ygap","MIN_VALUE","align","reference","number","gauge","axis","tickcolor","tickfont","bar","WarpViewAnnotationComponent","displayExpander","expanded","_standalone","lineHeight","gridwidth","showticklabels","autoexpand","dtick","nticks","rangemode","tickson","zeroline","isStandalone","trimmed","classList","handleKeyup","count","calculatedHeight","offsetY","paddingLeft","innerHTML","pointerEvents","timestampMode","tsLimit","symbol","toggle","WarpViewPolarComponent","familly","polar","angularaxis","radialaxis","minVal","maxVal","WarpViewRadarComponent","WarpViewPlotComponent","showLine","initialChartHeight","initialMapHeight","showGTSTree","_toHide","showChart","showMap","timeClipValue","warningMessage","gtsIdList","kbdCounter","gtsFilterCount","gtsBrowserIndex","preventDefaultKeyList","preventDefaultKeyListInModals","resizeArea","handleKeydown","ev","handleKeyPress","requestAnimationFrame","mainPlotDiv","focus","run","handleMouseMove","evt","pageX","handleMouseEnter","main","handleMouseOut","optionChanged_1","opt","inputTextKeyboardEvents","stopImmediatePropagation","applyFilter","pushKbdEvent","tzSelected","tzSelector","setAttribute","resizeChart","timeClip","idListClicked","_c","_a","_b","gtsPopupModal","filterInput","tc","toLocaleString","getTZ","names","onChartDraw","GTSTree","controls","WarpViewResizeComponent","minHeight","initialHeight","dragging","handleDiv","moveListener","handleDraggingMove","bind","clickUpListener","handleDraggingEnd","document","yTopParent","pageY","WarpViewSliderComponent","show","_step","loaded","manualRefresh","_min","_max","tmpVAl","slider","_uiSlider","updateSliderOptions","tooltips","getFormat","noUiSlider.create","set","updateOptions","WarpViewRangeSliderComponent","onChange","connect","WarpViewSpectrumComponent","histo","histnorm","histfunc","contours","showlabels","labelfont","colorbar","xpad","showscale","colorscale","autocolorscale","WarpViewBoxComponent","boxmode","lastIndexOf","boxmean","boxpoints","WarpView3dLineComponent","zaxis","z","WarpViewGlobeComponent","geo","projection","showframe","fitbounds","showocean","oceancolor","showland","landcolor","showlakes","lakecolor","showcountries","lonaxis","showgrid","lataxis","geoData","geoData_1","WarpViewEventDropComponent","eventConf","d3","verticalGrid","tickPadding","indicator","row","drop","onMouseOver","d3.event","d3\n                        .select","onMouseOut","elemChart","eventDrops","WarpViewResultTileComponent","graphs","spectrum","pie","radar","bubble","gts-tree","datagrid","drilldown","plot","box","line3d","globe","drops","onResized","newWidth","WarpViewAngularModule","NgModule","declarations","imports","CommonModule","HttpClientModule","AngularResizedEventModule","FormsModule","exports","entryComponents"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Param} from './param';\n\nexport class DataModel {\n  data: any[] | string;\n  params?: Param[];\n  globalParams?: Param;\n  bounds?: {\n    xmin?: number,\n    xmax?: number,\n    ymin?: number,\n    ymax?: number\n  };\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\n/* tslint:disable:no-console */\n\nexport class Logger {\n\n  className: string;\n  isDebug = false;\n\n  constructor(className: any, isDebug: boolean = false) {\n    this.className = className.name;\n    this.isDebug = isDebug;\n  }\n\n  setDebug(debug: boolean) {\n    this.isDebug = debug;\n  }\n\n  log(level: LEVEL, methods: any[], args: any[]) {\n    let logChain = [];\n    logChain.push(`[${new Date().toISOString()} - [${this.className}] ${methods.join(' - ')}`);\n    logChain = logChain.concat(args);\n    switch (level) {\n      case LEVEL.DEBUG: {\n        if (this.isDebug) {\n          console.debug(...logChain);\n        }\n        break;\n      }\n      case LEVEL.ERROR: {\n        console.error(...logChain);\n        break;\n      }\n      case LEVEL.INFO: {\n        console.log(...logChain);\n        break;\n      }\n      case LEVEL.WARN: {\n        console.warn(...logChain);\n        break;\n      }\n      default: {\n        if (this.isDebug) {\n          console.log(...logChain);\n        }\n      }\n    }\n  }\n\n  debug(methods: any[], ...args: any[]) {\n    this.log(LEVEL.DEBUG, methods, args);\n  }\n\n  error(methods: any[], ...args: any[]) {\n    this.log(LEVEL.ERROR, methods, args);\n  }\n\n  warn(methods: any[], ...args: any[]) {\n    this.log(LEVEL.WARN, methods, args);\n  }\n\n  info(methods: any[], ...args: any[]) {\n    this.log(LEVEL.INFO, methods, args);\n  }\n}\n\nexport enum LEVEL {\n  DEBUG, ERROR, WARN, INFO\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {DataModel} from '../model/dataModel';\nimport {GTS} from '../model/GTS';\nimport {Logger} from './logger';\n\n// @dynamic\nexport class GTSLib {\n  private static LOG: Logger = new Logger(GTSLib);\n\n  static cleanArray(actual: any[]) {\n    return actual.filter((i) => !!i);\n  }\n\n  static unique(arr) {\n    const u = {};\n    const a = [];\n    for (let i = 0, l = arr.length; i < l; ++i) {\n      if (!u.hasOwnProperty(arr[i])) {\n        a.push(arr[i]);\n        u[arr[i]] = 1;\n      }\n    }\n    return a;\n  }\n\n  static isArray(value) {\n    return value && typeof value === 'object' && value instanceof Array && typeof value.length === 'number'\n      && typeof value.splice === 'function' && !(value.propertyIsEnumerable('length'));\n  }\n\n  static formatElapsedTime(elapsed: number) {\n    if (elapsed < 1000) {\n      return elapsed.toFixed(3) + ' ns';\n    }\n    if (elapsed < 1000000) {\n      return (elapsed / 1000).toFixed(3) + ' s';\n    }\n    if (elapsed < 1000000000) {\n      return (elapsed / 1000000).toFixed(3) + ' ms';\n    }\n    if (elapsed < 1000000000000) {\n      return (elapsed / 1000000000).toFixed(3) + ' s ';\n    }\n    // Max exec time for nice output: 999.999 minutes (should be OK, timeout should happen before that).\n    return (elapsed / 60000000000).toFixed(3) + ' m ';\n  }\n\n  static isValidResponse(data) {\n    let response;\n    try {\n      response = JSON.parse(data);\n    } catch (e) {\n      this.LOG.error(['isValidResponse'], 'Response non JSON compliant', data);\n      return false;\n    }\n    if (!GTSLib.isArray(response)) {\n      this.LOG.error(['isValidResponse'], 'Response isn\\'t an Array', response);\n      return false;\n    }\n    return true;\n  }\n\n  static isEmbeddedImage(item) {\n    return !(typeof item !== 'string' || !/^data:image/.test(item));\n  }\n\n  static isEmbeddedImageObject(item) {\n    return !((item === null) || (item.image === null) ||\n      (item.caption === null) || !GTSLib.isEmbeddedImage(item.image));\n  }\n\n  static isPositionArray(item) {\n    if (!item || !item.positions) {\n      return false;\n    }\n    if (GTSLib.isPositionsArrayWithValues(item) || GTSLib.isPositionsArrayWithTwoValues(item)) {\n      return true;\n    }\n    (item.positions || []).forEach(p => {\n      if (p.length < 2 || p.length > 3) {\n        return false;\n      }\n      for (const j in p) {\n        if (typeof p[j] !== 'number') {\n          return false;\n        }\n      }\n    });\n    return true;\n  }\n\n  static isPositionsArrayWithValues(item) {\n    if ((item === null) || (item.positions === null)) {\n      return false;\n    }\n    (item.positions || []).forEach(p => {\n      if (p.length !== 3) {\n        return false;\n      }\n      for (const j in p) {\n        if (typeof p[j] !== 'number') {\n          return false;\n        }\n      }\n    });\n    return true;\n  }\n\n  static isPositionsArrayWithTwoValues(item) {\n    if ((item === null) || (item.positions === null)) {\n      return false;\n    }\n    (item.positions || []).forEach(p => {\n      if (p.length !== 4) {\n        return false;\n      }\n      for (const j in p) {\n        if (typeof p[j] !== 'number') {\n          return false;\n        }\n      }\n    });\n    return true;\n  }\n\n  static gtsFromJSON(json, id) {\n    return {gts: {c: json.c, l: json.l, a: json.a, v: json.v, id}};\n  }\n\n  static gtsFromJSONList(jsonList, prefixId) {\n    const gtsList = [];\n    let id;\n    (jsonList || []).forEach((item, i) => {\n      let gts = item;\n      if (item.gts) {\n        gts = item.gts;\n      }\n      if ((prefixId !== undefined) && (prefixId !== '')) {\n        id = prefixId + '-' + i;\n      } else {\n        id = i;\n      }\n      if (GTSLib.isArray(gts)) {\n        gtsList.push(GTSLib.gtsFromJSONList(gts, id));\n      }\n      if (GTSLib.isGts(gts)) {\n        gtsList.push(GTSLib.gtsFromJSON(gts, id));\n      }\n      if (GTSLib.isEmbeddedImage(gts)) {\n        gtsList.push({image: gts, caption: 'Image', id});\n      }\n      if (GTSLib.isEmbeddedImageObject(gts)) {\n        gtsList.push({image: gts.image, caption: gts.caption, id});\n      }\n    });\n    return {\n      content: gtsList || [],\n    };\n  }\n\n  static flatDeep(arr1: any[]): any[] {\n    if (!GTSLib.isArray(arr1)) {\n      arr1 = [arr1];\n    }\n    return arr1.reduce((acc, val) => Array.isArray(val) ? acc.concat(GTSLib.flatDeep(val)) : acc.concat(val), []);\n  }\n\n  static flattenGtsIdArray(a: any[], r: number): { res: any[], r: number } {\n    const res = [];\n    if (GTSLib.isGts(a)) {\n      a = [a];\n    }\n    (a || []).forEach(d => {\n      if (GTSLib.isArray(d)) {\n        const walk = GTSLib.flattenGtsIdArray(d, r);\n        res.push(walk.res);\n        r = walk.r;\n      } else if (d && d.v) {\n        d.id = r;\n        res.push(d);\n        r++;\n      }\n    });\n    return {res, r};\n  }\n\n  static sanitizeNames(input: string): string {\n    return (input || '').replace(/{/g, '&#123;')\n      .replace(/}/g, '&#125;')\n      .replace(/,/g, '&#44;')\n      .replace(/>/g, '&#62;')\n      .replace(/</g, '&#60;')\n      .replace(/\"/g, '&#34;')\n      .replace(/'/g, '&#39;');\n  }\n\n  static serializeGtsMetadata(gts) {\n    const serializedLabels = [];\n    const serializedAttributes = [];\n    if (gts.l) {\n      Object.keys(gts.l).forEach((key) => {\n        serializedLabels.push(this.sanitizeNames(key + '=' + gts.l[key]));\n      });\n    }\n    if (gts.a) {\n      Object.keys(gts.a).forEach((key) => {\n        serializedAttributes.push(this.sanitizeNames(key + '=' + gts.a[key]));\n      });\n    }\n    // tslint:disable-next-line:max-line-length\n    return `${this.sanitizeNames(gts.c)}{${serializedLabels.join(',')}${serializedAttributes.length > 0 ? ',' : ''}${serializedAttributes.join(',')}}`;\n  }\n\n  static isGts(item) {\n    return !!item && (item.c === '' || !!item.c) && !!item.v && GTSLib.isArray(item.v);\n  }\n\n  static isGtsToPlot(gts) {\n    if (!GTSLib.isGts(gts) || gts.v.length === 0) {\n      return false;\n    }\n    // We look at the first non-null value, if it's a String or Boolean it's an annotation GTS,\n    // if it's a number it's a GTS to plot\n    return (gts.v || []).some(v => {\n      // noinspection JSPotentiallyInvalidConstructorUsage\n      return typeof v[v.length - 1] === 'number' || !!v[v.length - 1].constructor.prototype.toFixed;\n    });\n  }\n  static isGtsToPlotOnMap(gts) {\n    if (!GTSLib.isGts(gts) || gts.v.length === 0) {\n      return false;\n    }\n    // We look at the first non-null value, if it's a String or Boolean it's an annotation GTS,\n    // if it's a number it's a GTS to plot\n    return (gts.v || []).some(v => {\n      // noinspection JSPotentiallyInvalidConstructorUsage\n      return v.length >= 3 && (typeof v[v.length - 1] === 'number' || !!v[v.length - 1].constructor.prototype.toFixed);\n    });\n  }\n\n  static isSingletonGTS(gts) {\n    if (!GTSLib.isGts(gts) || gts.v.length === 0) {\n      return false;\n    }\n    return (gts.v || []).length === 1;\n  }\n\n  static isGtsToAnnotate(gts) {\n    if (!GTSLib.isGts(gts) || gts.v.length === 0) {\n      return false;\n    }\n    // We look at the first non-null value, if it's a String or Boolean it's an annotation GTS,\n    // if it's a number it's a GTS to plot\n    return (gts.v || []).some(v => {\n      if (v[v.length - 1] !== null) {\n        // noinspection JSPotentiallyInvalidConstructorUsage\n        return typeof (v[v.length - 1]) !== 'number' &&\n          (!!v[v.length - 1].constructor && v[v.length - 1].constructor.name !== 'Big') &&\n          v[v.length - 1].constructor.prototype.toFixed === undefined;\n      }\n    });\n  }\n\n  static gtsSort(gts) {\n    if (gts.isSorted) {\n      return;\n    }\n    gts.v = gts.v.sort((a, b) => a[0] - b[0]);\n    gts.isSorted = true;\n  }\n\n  static getData(data: any): DataModel {\n    if (typeof data === 'string') {\n      return GTSLib.getData(JSON.parse(data as string));\n    } else if (data && data.hasOwnProperty('data')) {\n      if (!GTSLib.isArray(data.data)) {\n        data.data = [data.data];\n      }\n      return data as DataModel;\n    } else if (GTSLib.isArray(data) && data.length > 0 && data[0].data) {\n      return data[0] as DataModel;\n    } else if (GTSLib.isArray(data)) {\n      return {data: data as GTS[]} as DataModel;\n    }\n    return new DataModel();\n  }\n\n  static getDivider(timeUnit: string): number {\n    let timestampDivider = 1000; // default for s timeunit\n    if (timeUnit === 'ms') {\n      timestampDivider = 1;\n    }\n    if (timeUnit === 'ns') {\n      timestampDivider = 1000000;\n    }\n    return timestampDivider;\n  }\n\n  static formatLabel = (data: string): string => {\n    const serializedGTS = data.split('{');\n    let display = `<span class=\"gtsInfo\"><span class='gts-classname'>${serializedGTS[0]}</span>`;\n    if (serializedGTS.length > 1) {\n      display += `<span class='gts-separator'>{</span>`;\n      const labels = serializedGTS[1].substr(0, serializedGTS[1].length - 1).split(',');\n      if (labels.length > 0) {\n        labels.forEach((l, i) => {\n          const label = l.split('=');\n          if (l.length > 1) {\n            display += `<span><span class='gts-labelname'>${label[0]}</span>\n<span class='gts-separator'>=</span><span class='gts-labelvalue'>${label[1]}</span>`;\n            if (i !== labels.length - 1) {\n              display += `<span>, </span>`;\n            }\n          }\n        });\n      }\n      display += `<span class='gts-separator'>}</span>`;\n    }\n    if (serializedGTS.length > 2) {\n      display += `<span class='gts-separator'>{</span>`;\n      const labels = serializedGTS[2].substr(0, serializedGTS[2].length - 1).split(',');\n      if (labels.length > 0) {\n        labels.forEach((l, i) => {\n          const label = l.split('=');\n          if (l.length > 1) {\n            display += `<span><span class='gts-attrname'>${label[0]}</span>\n<span class='gts-separator'>=</span><span class='gts-attrvalue'>${label[1]}</span>`;\n            if (i !== labels.length - 1) {\n              display += `<span>, </span>`;\n            }\n          }\n        });\n      }\n      display += `<span class='gts-separator'>}</span>`;\n    }\n    display += '</span>';\n    return display;\n  };\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nexport class ChartBounds {\n  tsmin = 0;\n  tsmax = 0;\n  msmin = '';\n  msmax = '';\n  marginLeft = 0;\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n// @dynamic\nexport class ColorLib {\n  static color = {\n    COHESIVE: [\n      '#F2D354',\n      '#E4612F',\n      '#D32C2E',\n      '#6D2627',\n      '#6C7F55',\n      '#934FC6',\n      '#F07A5D',\n      '#ED8371',\n      '#94E751',\n      '#C457F7',\n      '#973AF7',\n      '#B6FF7A',\n      '#C7FFD5',\n      '#90E4D0',\n      '#E09234',\n      '#D2FF91',\n      '#17B201'\n    ],\n    COHESIVE_2: [\n      '#6F694E',\n      '#65D0B2',\n      '#D8F546',\n      '#FF724B',\n      '#D6523E',\n      '#F9F470',\n      '#F4BC78',\n      '#B1D637',\n      '#FFCFC8',\n      '#56CDAB',\n      '#CFDD22',\n      '#B3F5D2',\n      '#97DB29',\n      '#9DC5EE',\n      '#CFC0F5',\n      '#EDEA29',\n      '#5EC027',\n      '#386C94'\n    ],\n    BELIZE: [\n      '#5899DA',\n      '#E8743B',\n      '#19A979',\n      '#ED4A7B',\n      '#945ECF',\n      '#13A4B4',\n      '#525DF4',\n      '#BF399E',\n      '#6C8893',\n      '#EE6868',\n      '#2F6497'\n    ],\n    VIRIDIS: [\n      '#440154',\n      '#481f70',\n      '#443983',\n      '#3b528b',\n      '#31688e',\n      '#287c8e',\n      '#21918c',\n      '#20a486',\n      '#35b779',\n      '#5ec962',\n      '#90d743',\n      '#c8e020',\n    ],\n    MAGMA: [\n      '#000004',\n      '#100b2d',\n      '#2c115f',\n      '#51127c',\n      '#721f81',\n      '#932b80',\n      '#b73779',\n      '#d8456c',\n      '#f1605d',\n      '#fc8961',\n      '#feb078',\n      '#fed799',\n    ],\n    INFERNO: [\n      '#000004',\n      '#110a30',\n      '#320a5e',\n      '#57106e',\n      '#781c6d',\n      '#9a2865',\n      '#bc3754',\n      '#d84c3e',\n      '#ed6925',\n      '#f98e09',\n      '#fbb61a',\n      '#f4df53',\n    ],\n    PLASMA: [\n      '#0d0887',\n      '#3a049a',\n      '#5c01a6',\n      '#7e03a8',\n      '#9c179e',\n      '#b52f8c',\n      '#cc4778',\n      '#de5f65',\n      '#ed7953',\n      '#f89540',\n      '#fdb42f',\n      '#fbd524',\n    ],\n    YL_OR_RD: [\n      '#ffffcc',\n      '#ffeda0',\n      '#fed976',\n      '#feb24c',\n      '#fd8d3c',\n      '#fc4e2a',\n      '#e31a1c',\n      '#bd0026',\n      '#800026',\n    ],\n    YL_GN_BU: [\n      '#ffffd9',\n      '#edf8b1',\n      '#c7e9b4',\n      '#7fcdbb',\n      '#41b6c4',\n      '#1d91c0',\n      '#225ea8',\n      '#253494',\n      '#081d58',\n    ],\n    BU_GN: [\n      '#f7fcfd',\n      '#ebf7fa',\n      '#dcf2f2',\n      '#c8eae4',\n      '#aadfd2',\n      '#88d1bc',\n      '#68c2a3',\n      '#4eb485',\n      '#37a266',\n      '#228c49',\n      '#0d7635',\n      '#025f27',\n    ],\n    WARP10: [\n      '#ff9900',\n      '#004eff',\n      '#E53935',\n      '#7CB342',\n      '#F4511E',\n      '#039BE5',\n      '#D81B60',\n      '#C0CA33',\n      '#6D4C41',\n      '#8E24AA',\n      '#00ACC1',\n      '#FDD835',\n      '#5E35B1',\n      '#00897B',\n      '#FFB300',\n      '#3949AB',\n      '#43A047',\n      '#1E88E5',\n    ],\n    NINETEEN_EIGHTY_FOUR: ['#31C0F6', '#A500A5', '#FF7E27'],\n    ATLANTIS: ['#74D495', '#3F3FBA', '#FF4D9E'],\n    DO_ANDROIDS_DREAM: ['#8F8AF4', '#A51414', '#F4CF31'],\n    DELOREAN: ['#FD7A5D', '#5F1CF2', '#4CE09A'],\n    CTHULHU: ['#FDC44F', '#007C76', '#8983FF'],\n    ECTOPLASM: ['#DA6FF1', '#00717A', '#ACFF76'],\n    T_MAX_400_FILM: ['#F6F6F8', '#A4A8B6', '#545667']\n  };\n\n  static getColor(i: number, scheme: string) {\n    return ColorLib.color[scheme][i % ColorLib.color[scheme].length];\n  }\n\n  static getColorGradient(id: number, scheme: string) {\n    return [\n      [0, ColorLib.transparentize(ColorLib.getColor(id, scheme), 0)],\n      [1, ColorLib.transparentize(ColorLib.getColor(id, scheme), 0.7)]\n    ];\n  }\n\n  static getBlendedColorGradient(id: number, scheme: string, bg = '#000000') {\n    return [\n      [0, ColorLib.blend_colors(bg, ColorLib.getColor(id, scheme), 0)],\n      [1, ColorLib.blend_colors(bg, ColorLib.getColor(id, scheme), 1)]\n    ];\n  }\n\n  static getColorScale(scheme: string) {\n    return ColorLib.color[scheme].map((c, i) => [i, c]);\n  }\n\n  static hexToRgb(hex) {\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? [\n      parseInt(result[1], 16),\n      parseInt(result[2], 16),\n      parseInt(result[3], 16)\n    ] : null;\n  }\n\n  static transparentize(color, alpha = 0.5): string {\n    return 'rgba(' + ColorLib.hexToRgb(color).concat(alpha).join(',') + ')';\n  }\n\n  static generateColors(num, scheme) {\n    const color = [];\n    for (let i = 0; i < num; i++) {\n      color.push(ColorLib.getColor(i, scheme));\n    }\n    return color;\n  }\n\n  static generateTransparentColors(num, scheme) {\n    const color = [];\n    for (let i = 0; i < num; i++) {\n      color.push(ColorLib.transparentize(ColorLib.getColor(i, scheme)));\n    }\n    return color;\n  }\n\n  static hsvGradientFromRgbColors(c1, c2, steps) {\n    const c1hsv = ColorLib.rgb2hsv(c1.r, c1.g, c1.b);\n    const c2hsv = ColorLib.rgb2hsv(c2.r, c2.g, c2.b);\n    c1.h = c1hsv[0];\n    c1.s = c1hsv[1];\n    c1.v = c1hsv[2];\n    c2.h = c2hsv[0];\n    c2.s = c2hsv[1];\n    c2.v = c2hsv[2];\n    const gradient = ColorLib.hsvGradient(c1, c2, steps);\n    for (const i in gradient) {\n      if (gradient[i]) {\n        gradient[i].rgb = ColorLib.hsv2rgb(gradient[i].h, gradient[i].s, gradient[i].v);\n        gradient[i].r = Math.floor(gradient[i].rgb[0]);\n        gradient[i].g = Math.floor(gradient[i].rgb[1]);\n        gradient[i].b = Math.floor(gradient[i].rgb[2]);\n      }\n    }\n    return gradient;\n  }\n\n  private static rgb2hsv(r: number, g: number, b: number) {\n    // Normalize\n    const normR = r / 255.0;\n    const normG = g / 255.0;\n    const normB = b / 255.0;\n    const M = Math.max(normR, normG, normB);\n    const m = Math.min(normR, normG, normB);\n    const d = M - m;\n    let h;\n    let s;\n    let v;\n    v = M;\n    if (d === 0) {\n      h = 0;\n      s = 0;\n    } else {\n      s = d / v;\n      switch (M) {\n        case normR:\n          h = ((normG - normB) + d * (normG < normB ? 6 : 0)) / 6 * d;\n          break;\n        case normG:\n          h = ((normB - normR) + d * 2) / 6 * d;\n          break;\n        case normB:\n          h = ((normR - normG) + d * 4) / 6 * d;\n          break;\n      }\n    }\n    return [h, s, v];\n  }\n\n  private static hsvGradient(c1: any, c2: any, steps: any) {\n    const gradient = new Array(steps);\n    // determine clockwise and counter-clockwise distance between hues\n    const distCCW = (c1.h >= c2.h) ? c1.h - c2.h : 1 + c1.h - c2.h;\n    const distCW = (c1.h >= c2.h) ? 1 + c2.h - c1.h : c2.h - c1.h;\n    // make gradient for this part\n    for (let i = 0; i < steps; i++) {\n      // interpolate h, s, b\n      let h = (distCW <= distCCW) ? c1.h + (distCW * i / (steps - 1)) : c1.h - (distCCW * i / (steps - 1));\n      if (h < 0) {\n        h = 1 + h;\n      }\n      if (h > 1) {\n        h = h - 1;\n      }\n      const s = (1 - i / (steps - 1)) * c1.s + i / (steps - 1) * c2.s;\n      const v = (1 - i / (steps - 1)) * c1.v + i / (steps - 1) * c2.v;\n      // add to gradient array\n      gradient[i] = {h, s, v};\n    }\n    return gradient;\n  }\n\n  private static hsv2rgb(h: any, s: any, v: any) {\n    let r;\n    let g;\n    let b;\n    const i = Math.floor(h * 6);\n    const f = h * 6 - i;\n    const p = v * (1 - s);\n    const q = v * (1 - f * s);\n    const t = v * (1 - (1 - f) * s);\n    switch (i % 6) {\n      case 0:\n        r = v;\n        g = t;\n        b = p;\n        break;\n      case 1:\n        r = q;\n        g = v;\n        b = p;\n        break;\n      case 2:\n        r = p;\n        g = v;\n        b = t;\n        break;\n      case 3:\n        r = p;\n        g = q;\n        b = v;\n        break;\n      case 4:\n        r = t;\n        g = p;\n        b = v;\n        break;\n      case 5:\n        r = v;\n        g = p;\n        b = q;\n        break;\n    }\n    return [r * 255, g * 255, b * 255];\n  }\n\n  static rgb2hex(r, g, b) {\n    function componentToHex(c) {\n      const hex = c.toString(16);\n      return hex.length === 1 ? '0' + hex : hex;\n    }\n\n    return '#' + componentToHex(r) + componentToHex(g) + componentToHex(b);\n  }\n\n  static blend_colors(color1, color2, percentage) {\n    // check input\n    color1 = color1 || '#000000';\n    color2 = color2 || '#ffffff';\n    percentage = percentage || 0.5;\n    // 1: validate input, make sure we have provided a valid hex\n    if (color1.length !== 4 && color1.length !== 7) {\n      throw new Error('colors must be provided as hexes');\n    }\n    if (color2.length !== 4 && color2.length !== 7) {\n      throw new Error('colors must be provided as hexes');\n    }\n    if (percentage > 1 || percentage < 0) {\n      throw new Error('percentage must be between 0 and 1');\n    }\n    // 2: check to see if we need to convert 3 char hex to 6 char hex, else slice off hash\n    //      the three character hex is just a representation of the 6 hex where each character is repeated\n    //      ie: #060 => #006600 (green)\n    if (color1.length === 4) {\n      color1 = color1[1] + color1[1] + color1[2] + color1[2] + color1[3] + color1[3];\n    } else {\n      color1 = color1.substring(1);\n    }\n    if (color2.length === 4) {\n      color2 = color2[1] + color2[1] + color2[2] + color2[2] + color2[3] + color2[3];\n    } else {\n      color2 = color2.substring(1);\n    }\n    console.log('valid: c1 => ' + color1 + ', c2 => ' + color2);\n    // 3: we have valid input, convert colors to rgb\n    color1 = [parseInt(color1[0] + color1[1], 16), parseInt(color1[2] + color1[3], 16), parseInt(color1[4] + color1[5], 16)];\n    color2 = [parseInt(color2[0] + color2[1], 16), parseInt(color2[2] + color2[3], 16), parseInt(color2[4] + color2[5], 16)];\n    console.log('hex -> rgba: c1 => [' + color1.join(', ') + '], c2 => [' + color2.join(', ') + ']');\n    // 4: blend\n    const color3 = [\n      (1 - percentage) * color1[0] + percentage * color2[0],\n      (1 - percentage) * color1[1] + percentage * color2[1],\n      (1 - percentage) * color1[2] + percentage * color2[2]\n    ];\n    const color3Str = '#' + ColorLib.int_to_hex(color3[0]) + ColorLib.int_to_hex(color3[1]) + ColorLib.int_to_hex(color3[2]);\n    console.log(color3Str);\n    // return hex\n    return color3Str;\n  }\n\n  /*\n      convert a Number to a two character hex string\n      must round, or we will end up with more digits than expected (2)\n      note: can also result in single digit, which will need to be padded with a 0 to the left\n      @param: num         => the number to conver to hex\n      @returns: string    => the hex representation of the provided number\n  */\n  static int_to_hex(num: number) {\n    let hex = Math.round(num).toString(16);\n    if (hex.length === 1) {\n      hex = '0' + hex;\n    }\n    return hex;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\n// @dynamic\nexport class ChartLib {\n\n  static DEFAULT_WIDTH = 640;\n  static DEFAULT_HEIGHT = 480;\n\n  static mergeDeep<T>(base: T, extended: any) {\n    base = base || {} as T;\n    for (const prop in extended || {}) {\n      if (extended.hasOwnProperty(prop)) {\n        // If property is an object, merge properties\n        if (Object.prototype.toString.call(extended[prop]) === '[object Object]') {\n          base[prop] = ChartLib.mergeDeep<T>(base[prop], extended[prop]);\n        } else {\n          base[prop] = extended[prop];\n        }\n      }\n    }\n    return base as T;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\nexport class Param {\n  scheme = 'WARP10';\n  bgColor?: string;\n  datasetColor?: string;\n  fontColor?: string;\n  borderColor?: string;\n  gridLineColor?: string;\n  showLegend?: boolean;\n  responsive?: boolean;\n  horizontal = false;\n  stacked = false;\n  key?: string;\n  unit?: string;\n  interpolate?: string;\n  type?: string;\n  showRangeSelector?: boolean;\n  autoRefresh?: number;\n  showControls = true;\n  showErrors = true;\n  showStatus = true;\n  showGTSTree?: boolean;\n  foldGTSTree?: boolean;\n  timeMode?: 'timestamp' | 'date' | 'custom' | 'duration';\n  showDots = false;\n  delta?: number;\n  timeUnit: 'us' | 'ms' | 'ns' = 'us';\n  minColor?: string;\n  maxColor?: string;\n  split?: 'Y' | 'M' | 'D' | 'h' | 'm' | 's';\n  popupButtonValidateClass?: string;\n  popupButtonValidateLabel?: string;\n  timeZone = 'UTC';\n  properties?: any;\n  map?: {\n    tiles?: string[];\n    heatRadius?: number;\n    heatBlur?: number;\n    heatOpacity?: number;\n    heatControls?: boolean;\n    dotsLimit?: number;\n    mapType?: string;\n    showTimeSlider?: boolean;\n    showTimeRange?: boolean;\n    timeSliderMin?: number;\n    timeSliderMax?: number;\n    timeSliderStep?: number;\n    timeSliderMode?: 'timestamp' | 'date' | 'custom';\n    timeStart?: number,\n    timeSpan?: number,\n    startLat?: number;\n    startLong?: number;\n    startZoom?: number;\n    timeSpanList?: any[]\n  } = {\n    tiles: [],\n    showTimeSlider: false,\n    showTimeRange: false,\n    timeSliderMode: 'timestamp'\n  };\n  bounds: {\n    minDate?: number;\n    maxDate?: number;\n    yRanges?: [number, number];\n  } = {};\n  histo?: {\n    histnorm: 'percent' | 'probability' | 'density' | 'probability density';\n    histfunc: 'count' | 'sum' | 'avg' | 'min' | 'max';\n  };\n}\n","import {\n  Component,\n  DoCheck,\n  ElementRef,\n  EventEmitter,\n  Input,\n  IterableDiffer,\n  IterableDiffers,\n  KeyValueDiffer,\n  KeyValueDiffers,\n  OnChanges,\n  OnDestroy,\n  OnInit,\n  Output,\n  SimpleChange,\n  SimpleChanges,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport * as Plotlyjs from 'plotly.js/dist/plotly';\nimport {Config, Data, Layout, PlotlyHTMLElement, Plots} from 'plotly.js';\nimport {Logger} from '../utils/logger';\n\nexport interface Figure {\n  data: Data[];\n  layout: Partial<Layout>;\n  frames: Partial<Config>;\n}\n\n@Component({\n  selector: 'warpview-plotly',\n  templateUrl: './plotly.component.html',\n  styleUrls: ['./plotly.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class PlotlyComponent implements OnInit, OnChanges, OnDestroy, DoCheck {\n  protected defaultClassName = 'js-plotly-plot';\n  protected LOG: Logger;\n\n  public plotlyInstance: PlotlyHTMLElement;\n  public resizeHandler?: (instance: PlotlyHTMLElement) => void;\n  public layoutDiffer: KeyValueDiffer<string, any>;\n  public dataDiffer: IterableDiffer<Partial<any>>;\n\n  @ViewChild('plot', {static: true}) plotEl: ElementRef;\n\n  @Input() data?: Partial<any>[];\n  @Input() layout?: Partial<any>;\n  @Input() config?: Partial<Config>;\n  @Input() frames?: Partial<any>[];\n  @Input() style?: { [key: string]: string };\n\n  @Input() divId?: string;\n  @Input() revision = 0;\n  @Input() className?: string | string[];\n  @Input() debug = false;\n  @Input() useResizeHandler = false;\n\n  @Input() updateOnLayoutChange = true;\n  @Input() updateOnDataChange = true;\n  @Input() updateOnlyWithRevision = true;\n\n  @Output() initialized = new EventEmitter<PlotlyHTMLElement>();\n  @Output() update = new EventEmitter<Figure>();\n  @Output() purge = new EventEmitter<Figure>();\n  @Output() error = new EventEmitter<Error>();\n\n  @Output() afterExport = new EventEmitter();\n  @Output() afterPlot = new EventEmitter();\n  @Output() animated = new EventEmitter();\n  @Output() animatingFrame = new EventEmitter();\n  @Output() animationInterrupted = new EventEmitter();\n  @Output() autoSize = new EventEmitter();\n  @Output() beforeExport = new EventEmitter();\n  @Output() buttonClicked = new EventEmitter();\n  @Output() click = new EventEmitter();\n  @Output() plotly_click = new EventEmitter();\n  @Output() clickAnnotation = new EventEmitter();\n  @Output() deselect = new EventEmitter();\n  @Output() doubleClick = new EventEmitter();\n  @Output() framework = new EventEmitter();\n  @Output() hover = new EventEmitter();\n  @Output() legendClick = new EventEmitter();\n  @Output() legendDoubleClick = new EventEmitter();\n  @Output() relayout = new EventEmitter();\n  @Output() restyle = new EventEmitter();\n  @Output() redraw = new EventEmitter();\n  @Output() selected = new EventEmitter();\n  @Output() selecting = new EventEmitter();\n  @Output() sliderChange = new EventEmitter();\n  @Output() sliderEnd = new EventEmitter();\n  @Output() sliderStart = new EventEmitter();\n  @Output() transitioning = new EventEmitter();\n  @Output() transitionInterrupted = new EventEmitter();\n  @Output() unhover = new EventEmitter();\n  @Output() relayouting = new EventEmitter();\n\n  public eventNames = [\n    // 'afterExport',\n    //   'afterPlot', // 'animated', 'animatingFrame', 'animationInterrupted', 'autoSize',\n    // 'beforeExport', 'buttonClicked', 'clickAnnotation', 'deselect', 'doubleClick', 'framework',\n    'hover', 'unhover',\n    // 'legendClick', 'legendDoubleClick',\n    'relayout',\n    // 'restyle', 'redraw', 'selected', 'selecting', 'sliderChange',\n    // 'sliderEnd', 'sliderStart', 'transitioning', 'transitionInterrupted', 'relayouting'\n  ];\n  rect: any;\n\n  constructor(\n    public iterableDiffers: IterableDiffers,\n    public el: ElementRef,\n    public keyValueDiffers: KeyValueDiffers\n  ) {\n    this.LOG = new Logger(PlotlyComponent, this.debug);\n  }\n\n  ngOnInit() {\n    this.createPlot().then(() => {\n      const figure = this.createFigure();\n      this.LOG.debug(['figure'], figure);\n      this.initialized.emit(this.plotlyInstance);\n    });\n  }\n\n  ngOnDestroy() {\n    if (typeof this.resizeHandler === 'function') {\n      this.getWindow().removeEventListener('resize', this.resizeHandler as any);\n      this.resizeHandler = undefined;\n    }\n\n    const figure = this.createFigure();\n    this.purge.emit(figure);\n    this.remove(this.plotlyInstance);\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    this.LOG.debug(['ngOnChanges'], changes);\n    const revision: SimpleChange = changes.revision;\n    if (changes.debug) {\n      this.debug = changes.debug.currentValue;\n    }\n    if ((revision && !revision.isFirstChange()) || !!changes.layout || !!changes.data || !!changes.config) {\n      this.updatePlot();\n    }\n    if (!!changes.debug) {\n      this.LOG.setDebug(changes.debug.currentValue);\n    }\n    this.updateWindowResizeHandler();\n    this.LOG.debug(['ngOnChanges'], changes);\n  }\n\n  ngDoCheck() {\n    if (this.updateOnlyWithRevision) {\n      return false;\n    }\n    let shouldUpdate = false;\n    if (this.updateOnLayoutChange) {\n      if (this.layoutDiffer) {\n        const layoutHasDiff = this.layoutDiffer.diff(this.layout);\n        if (layoutHasDiff) {\n          shouldUpdate = true;\n        }\n      } else if (this.layout) {\n        this.layoutDiffer = this.keyValueDiffers.find(this.layout).create();\n      } else {\n        this.layoutDiffer = undefined;\n      }\n    }\n\n    if (this.updateOnDataChange) {\n      if (this.dataDiffer) {\n        const dataHasDiff = this.dataDiffer.diff(this.data);\n        if (dataHasDiff) {\n          shouldUpdate = true;\n        }\n      } else if (Array.isArray(this.data)) {\n        this.dataDiffer = this.iterableDiffers.find(this.data).create(this.dataDifferTrackBy);\n      } else {\n        this.dataDiffer = undefined;\n      }\n    }\n    if (shouldUpdate && this.plotlyInstance) {\n      this.updatePlot();\n    }\n  }\n\n  getWindow(): any {\n    return window;\n  }\n\n  getBoundingClientRect() {\n    return this.rect;\n  }\n\n  getClassName(): string {\n    let classes = [this.defaultClassName];\n    if (Array.isArray(this.className)) {\n      classes = classes.concat(this.className);\n    } else if (this.className) {\n      classes.push(this.className);\n    }\n\n    return classes.join(' ');\n  }\n\n  restyleChart(properties: any, curves: any[]) {\n    Plotlyjs.restyle(this.plotlyInstance, properties, curves);\n  }\n\n  createPlot(): Promise<void> {\n    this.LOG.debug(['createPlot'], this.data, this.layout, this.config, this.plotlyInstance);\n    return Plotlyjs.react(this.plotEl.nativeElement, this.data, this.layout, this.config).then(plotlyInstance => {\n      this.rect = this.el.nativeElement.getBoundingClientRect();\n      this.plotlyInstance = plotlyInstance;\n      this.LOG.debug(['plotlyInstance'], plotlyInstance);\n      this.getWindow().gd = this.debug ? plotlyInstance : undefined;\n\n      this.eventNames.forEach(name => {\n        const eventName = `plotly_${name.toLowerCase()}`;\n        // @ts-ignore\n        plotlyInstance.on(eventName, (data: any) => {\n          this.LOG.debug(['plotlyEvent', eventName], data);\n          (this[name] as EventEmitter<any>).emit(data);\n        });\n      });\n\n      plotlyInstance.on('plotly_click', (data: any) => {\n        this.click.emit(data);\n        this.plotly_click.emit(data);\n      });\n\n      this.updateWindowResizeHandler();\n      this.afterPlot.emit(plotlyInstance);\n    }, err => {\n      console.error('Error while plotting:', err);\n      this.error.emit(err);\n    });\n  }\n\n  createFigure(): Figure {\n    const p: any = this.plotlyInstance;\n    return {\n      data: p.data,\n      layout: p.layout,\n      frames: p._transitionData ? p._transitionData._frames : null\n    };\n  }\n\n  updatePlot() {\n    this.LOG.debug(['updatePlot'], this.data, this.layout, {...this.config});\n    if (!this.plotlyInstance) {\n      const error = new Error(`Plotly component wasn't initialized`);\n      this.error.emit(error);\n      return;\n    }\n    Plotlyjs.purge(this.plotlyInstance);\n    this.createPlot().then(() => {\n      const figure = this.createFigure();\n      this.update.emit(figure);\n    }, err => {\n      console.error('Error while updating plot:', err);\n      this.error.emit(err);\n    });\n  }\n\n  updateWindowResizeHandler() {\n    if (this.useResizeHandler) {\n      if (this.resizeHandler === undefined) {\n        this.resizeHandler = () => setTimeout(() => Plots.resize(this.plotlyInstance));\n        this.getWindow().addEventListener('resize', this.resizeHandler as any);\n      }\n    } else {\n      if (typeof this.resizeHandler === 'function') {\n        this.getWindow().removeEventListener('resize', this.resizeHandler as any);\n        this.resizeHandler = undefined;\n      }\n    }\n  }\n\n  dataDifferTrackBy(_: number, item: any): any {\n    const obj = Object.assign({}, item, {uid: ''});\n    return JSON.stringify(obj);\n  }\n\n\n  remove(div: PlotlyHTMLElement) {\n    Plotlyjs.purge(div);\n    delete this.plotlyInstance;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {ChartLib} from '../utils/chart-lib';\nimport {Param} from '../model/param';\nimport {Logger} from '../utils/logger';\nimport {DataModel} from '../model/dataModel';\nimport {GTS} from '../model/GTS';\nimport {GTSLib} from '../utils/gts.lib';\nimport * as moment from 'moment-timezone';\nimport {ElementRef, EventEmitter, Input, NgZone, Output, Renderer2, ViewChild} from '@angular/core';\nimport deepEqual from 'deep-equal';\nimport {Size, SizeService} from '../services/resize.service';\nimport {PlotlyComponent} from '../plotly/plotly.component';\nimport {Config} from 'plotly.js';\n\nexport type VisibilityState = 'unknown' | 'nothingPlottable' | 'plottablesAllHidden' | 'plottableShown';\n\nexport abstract class WarpViewComponent {\n  @ViewChild('toolTip', {static: true}) toolTip: ElementRef;\n  @ViewChild('graph', {static: false}) graph: PlotlyComponent;\n  @ViewChild('chartContainer', {static: true}) chartContainer: ElementRef;\n\n  @Input('width') width = ChartLib.DEFAULT_WIDTH;\n  @Input('height') height = ChartLib.DEFAULT_HEIGHT;\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    this._hiddenData = hiddenData;\n  }\n\n  get hiddenData(): number[] {\n    return this._hiddenData;\n  }\n\n  @Input('unit') set unit(unit: string) {\n    this._unit = unit;\n    this.update(undefined, false);\n  }\n\n  get unit() {\n    return this._unit;\n  }\n\n  @Input('debug') set debug(debug: boolean | string) {\n    if (typeof debug === 'string') {\n      debug = 'true' === debug;\n    }\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Input('showLegend') set showLegend(showLegend: boolean | string) {\n    if (typeof showLegend === 'string') {\n      showLegend = 'true' === showLegend;\n    }\n    this._showLegend = showLegend;\n  }\n\n  get showLegend() {\n    return this._showLegend;\n  }\n\n  @Input('responsive') set responsive(responsive: boolean | string) {\n    if (typeof responsive === 'string') {\n      responsive = 'true' === responsive;\n    }\n    this._responsive = responsive;\n  }\n\n  get responsive() {\n    return this._responsive;\n  }\n\n  @Input('options') set options(options: Param | string) {\n    this.LOG.debug(['onOptions'], options);\n    if (typeof options === 'string') {\n      options = JSON.parse(options);\n    }\n    if (!deepEqual(options, this._options)) {\n      this.LOG.debug(['onOptions', 'changed'], options);\n      this._options = ChartLib.mergeDeep(this._options, options as Param) as Param;\n      this.update(this._options, false);\n    }\n  }\n\n  @Input('data') set data(data: DataModel | GTS[] | string) {\n    this.LOG.debug(['onData'], data);\n    if (data) {\n      this._data = GTSLib.getData(data);\n      this.update(this._options, true);\n      this.LOG.debug(['onData'], this._data);\n    }\n  }\n\n  @Output('chartDraw') chartDraw = new EventEmitter<any>();\n\n  _options: Param = new Param();\n  protected LOG: Logger;\n  protected defOptions = ChartLib.mergeDeep(this._options, {\n    dotsLimit: 1000,\n    heatControls: false,\n    timeMode: 'date',\n    showRangeSelector: true,\n    gridLineColor: '#8e8e8e',\n    showDots: false,\n    timeZone: 'UTC',\n    timeUnit: 'us',\n    showControls: true,\n    bounds: {}\n  }) as Param;\n\n  protected _debug = false;\n  protected _showLegend = false;\n  protected _responsive = true;\n  protected _unit = '';\n  protected _data: DataModel;\n  protected _autoResize = true;\n  protected _hiddenData: number[] = [];\n  protected divider: number;\n\n  tooltipPosition: any = {top: '-10000px', left: '-1000px'};\n  loading = true;\n  noData = false;\n  layout: Partial<any> = {\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 10\n    }\n  };\n  plotlyConfig: Partial<Config> = {\n    responsive: true,\n    showAxisDragHandles: true,\n    scrollZoom: true,\n    doubleClick: 'reset+autosize',\n    showTips: true,\n    plotGlPixelRatio: 1,\n    staticPlot: false,\n    displaylogo: false,\n    modeBarButtonsToRemove: [\n      'lasso2d', 'select2d', 'toggleSpikelines', 'toggleHover', 'hoverClosest3d', 'autoScale2d',\n      'hoverClosestGeo', 'hoverClosestGl2d', 'hoverClosestPie', 'toggleHover',\n      'hoverClosestCartesian', 'hoverCompareCartesian'\n    ]\n  };\n  plotlyData: Partial<any>[];\n  private hideTooltipTimer: number;\n  private rect: any;\n\n  protected constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    this.sizeService.sizeChanged$.subscribe((size: Size) => {\n      if ((el.nativeElement as HTMLElement).parentElement) {\n        const parentSize = (el.nativeElement as HTMLElement).parentElement.getBoundingClientRect();\n        if (this._responsive) {\n          this.height = parentSize.height;\n          this.width = parentSize.width;\n        }\n        if (!!this.graph && this._responsive && parentSize.height > 0) {\n          const layout = {\n            width: parentSize.width,\n            height: this._autoResize ? parentSize.height : this.layout.height\n          };\n          if (this.layout.width !== layout.width || this.layout.height !== layout.height) {\n            setTimeout(() => this.layout = {...this.layout, ...layout});\n            this.LOG.debug(['sizeChanged$'], this.layout.width, this.layout.height);\n            this.graph.updatePlot();\n          }\n        }\n      }\n    });\n  }\n\n  protected abstract update(options: Param, refresh: boolean): void;\n\n  protected abstract convert(data: DataModel): Partial<any>[];\n\n  protected legendFormatter(x, series, highlighted = -1): string {\n    const displayedCurves = [];\n    if (x === null) {\n      // This happens when there's no selection and {legend: 'always'} is set.\n      return `<br>\n      ${series.map(s => {\n        // FIXME :  if (!s.isVisible) return;\n        let labeledData = GTSLib.formatLabel(s.data.text || '') + ': ' + ((this._options.horizontal ? s.x : s.y) || s.r || '');\n        let color = s.data.line.color;\n        if (!!s.data.marker) {\n          if (GTSLib.isArray(s.data.marker.color)) {\n            color = s.data.marker.color[0];\n          } else {\n            color = s.data.marker.color;\n          }\n        }\n        if (s.curveNumber === highlighted) {\n          labeledData = `<i class=\"chip\"\n    style=\"background-color: ${color};border: 2px solid ${color};\"></i> ${labeledData}`;\n        }\n        return labeledData;\n      }).join('<br>')}`;\n    }\n\n    let html = '';\n    if (!!series[0]) {\n      x = series[0].x || series[0].theta;\n    }\n    html += `<b>${x}</b><br />`;\n    // put the highlighted one(s?) first, keep only visibles, keep only 50 first ones.\n    series = series.sort((sa, sb) => (sa.curveNumber === highlighted) ? -1 : 1);\n    series\n      // .filter(s => s.isVisible && s.yHTML)\n      .slice(0, 50)\n      .forEach((s, i) => {\n        if (displayedCurves.indexOf(s.curveNumber) <= -1) {\n          displayedCurves.push(s.curveNumber);\n          let value = series[0].data.orientation === 'h' ? s.x : s.y;\n          if (!value && value !== 0) {\n            value = s.r;\n          }\n          let labeledData = GTSLib.formatLabel(s.data.text || '') + ': ' + value;\n          if (s.curveNumber === highlighted) {\n            labeledData = `<b>${labeledData}</b>`;\n          }\n          let color = s.data.line ? s.data.line.color : '';\n          if (!!s.data.marker) {\n            if (GTSLib.isArray(s.data.marker.color)) {\n              color = s.data.marker.color[0];\n            } else {\n              color = s.data.marker.color;\n            }\n          }\n          html += `<i class=\"chip\" style=\"background-color: ${color};border: 2px solid ${color};\"></i>&nbsp;${labeledData}`;\n          if (i < series.length) {\n            html += '<br>';\n          }\n        }\n      });\n    return html;\n  }\n\n  protected initChart(el: ElementRef): boolean {\n    this.noData = false;\n    const parentSize = (el.nativeElement as HTMLElement).parentElement.parentElement.getBoundingClientRect();\n    if (this._responsive) {\n      this.height = parentSize.height;\n      this.width = parentSize.width;\n    }\n    this.LOG.debug(['initiChart', 'this._data'], this._data, this._options);\n    if (!this._data || !this._data.data || this._data.data.length === 0 || !this._options) {\n      this.loading = false;\n      this.LOG.debug(['initiChart', 'nodata']);\n      this.noData = true;\n      this.chartDraw.emit();\n      return false;\n    }\n    moment.tz.setDefault(this._options.timeZone);\n    this.loading = true;\n    this._options = ChartLib.mergeDeep(this.defOptions, this._options || {}) as Param;\n    const dataModel = this._data;\n    this._options = ChartLib.mergeDeep(this._options || {}, this._data.globalParams) as Param;\n    this.LOG.debug(['initiChart', 'this._options'], this._options);\n    this._options.timeMode = this._options.timeMode || 'date';\n    this.divider = GTSLib.getDivider(this._options.timeUnit);\n    this.plotlyData = this.convert(dataModel);\n    this.plotlyConfig.responsive = this._responsive;\n    this.layout.paper_bgcolor = 'rgba(0,0,0,0)';\n    this.layout.plot_bgcolor = 'rgba(0,0,0,0)';\n    if (!this._responsive) {\n      this.layout.width = this.width || ChartLib.DEFAULT_WIDTH;\n      this.layout.height = this.height || ChartLib.DEFAULT_HEIGHT;\n    } else {\n      this.layout.width = parentSize.width;\n      this.layout.height = parentSize.height;\n    }\n    this.LOG.debug(['initChart', 'initSize'], this.layout.width, this.layout.height, this.width, this.height);\n    if (this._options.bounds && this._options.bounds.minDate && this._options.bounds.maxDate) {\n      dataModel.bounds = {\n        xmin: Math.floor(this._options.bounds.minDate),\n        xmax: Math.ceil(this._options.bounds.maxDate),\n        ymin: this._options.bounds.yRanges && this._options.bounds.yRanges.length > 0\n          ? Math.floor(this._options.bounds.yRanges[0])\n          : undefined,\n        ymax: this._options.bounds.yRanges && this._options.bounds.yRanges.length > 1\n          ? Math.ceil(this._options.bounds.yRanges[1])\n          : undefined\n      };\n      this.LOG.debug(['initChart', 'updateBounds'], dataModel.bounds.xmin, dataModel.bounds.xmax);\n      if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n        this.layout.xaxis.range = [dataModel.bounds.xmin, dataModel.bounds.xmax];\n      } else {\n        this.layout.xaxis.range = [\n          moment.tz(dataModel.bounds.xmin / this.divider, this._options.timeZone).toISOString(true),\n          moment.tz(dataModel.bounds.xmax / this.divider, this._options.timeZone).toISOString(true)];\n      }\n    }\n    this.LOG.debug(['initiChart', 'plotlyData'], this.plotlyData);\n    if (!this.plotlyData || this.plotlyData.length === 0) {\n      this.loading = false;\n      this.chartDraw.emit();\n      return false;\n    }\n    return !(!this.plotlyData || this.plotlyData.length === 0);\n  }\n\n  afterPlot(plotlyInstance?: any) {\n    this.LOG.debug(['afterPlot', 'plotlyInstance'], plotlyInstance);\n    this.chartDraw.emit();\n    this.loading = false;\n    this.rect = this.graph.getBoundingClientRect();\n  }\n\n  hideTooltip() {\n    if (!!this.hideTooltipTimer) {\n      clearTimeout(this.hideTooltipTimer);\n    }\n    this.hideTooltipTimer = setTimeout(() => {\n      this.toolTip.nativeElement.style.display = 'none';\n    }, 1000);\n  }\n\n  unhover(data?: any, point?: any) {\n    this.LOG.debug(['unhover'], data);\n    if (!!this.hideTooltipTimer) {\n      clearTimeout(this.hideTooltipTimer);\n    }\n  }\n\n  hover(data: any, point?: any) {\n    this.LOG.debug(['hover'], data);\n    this.toolTip.nativeElement.style.display = 'block';\n    if (!!this.hideTooltipTimer) {\n      clearTimeout(this.hideTooltipTimer);\n    }\n    let delta = Number.MAX_VALUE;\n    const curves = [];\n    if (!point) {\n      if (data.points[0] && data.points[0].data.orientation !== 'h') {\n        const y = (data.yvals || [''])[0];\n        data.points.forEach(p => {\n          curves.push(p.curveNumber);\n          const d = Math.abs((p.y || p.r) - y);\n          if (d < delta) {\n            delta = d;\n            point = p;\n          }\n        });\n      } else {\n        const x: number = (data.xvals || [''])[0];\n        data.points.forEach(p => {\n          curves.push(p.curveNumber);\n          const d = Math.abs((p.x || p.r) - x);\n          if (d < delta) {\n            delta = d;\n            point = p;\n          }\n        });\n      }\n    }\n    if (point) {\n      const content = this.legendFormatter(\n        this._options.horizontal ?\n          (data.yvals || [''])[0] :\n          (data.xvals || [''])[0]\n        , data.points, point.curveNumber);\n      let left = (data.event.offsetX + 20) + 'px';\n      if (data.event.offsetX > this.chartContainer.nativeElement.clientWidth / 2) {\n        left = Math.max(0, data.event.offsetX - this.toolTip.nativeElement.clientWidth - 20) + 'px';\n      }\n      const top = Math.min(\n        this.el.nativeElement.getBoundingClientRect().height - this.toolTip.nativeElement.getBoundingClientRect().height - 20,\n        data.event.y - 20 - this.rect.top) + 'px';\n      this.moveTooltip(top, left, content);\n    }\n  }\n\n  getTooltipPosition() {\n    return {\n      top: this.tooltipPosition.top,\n      left: this.tooltipPosition.left,\n    };\n  }\n\n  private moveTooltip(top, left, content) {\n    this.tooltipPosition = {top, left};\n    this.renderer.setProperty(this.toolTip.nativeElement, 'innerHTML', content);\n  }\n\n  relayout($event: any) {\n\n  }\n\n  protected getLabelColor(el: HTMLElement) {\n    return this.getCSSColor(el, '--warp-view-chart-label-color', '#8e8e8e').trim();\n  }\n\n  protected getGridColor(el: HTMLElement) {\n    return this.getCSSColor(el, '--warp-view-chart-grid-color', '#8e8e8e').trim();\n  }\n\n  protected getCSSColor(el: HTMLElement, property: string, defColor: string) {\n    const color = getComputedStyle(el).getPropertyValue(property).trim();\n    return color === '' ? defColor : color;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {EventEmitter} from '@angular/core';\n\nexport class Size {\n  constructor(public width: number, public height: number) {\n  }\n}\n\n\nexport class SizeService {\n  public sizeChanged$: EventEmitter<Size>;\n\n  constructor() {\n    this.sizeChanged$ = new EventEmitter();\n  }\n\n  public change(size: Size): void {\n    this.sizeChanged$.emit(size);\n  }\n}\n","/* tslint:disable:no-bitwise */\n\n/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nexport class Timsort {\n\n  /**\n   * Default minimum size of a run.\n   */\n  private static DEFAULT_MIN_MERGE = 32;\n\n  /**\n   * Minimum ordered subsequece required to do galloping.\n   */\n  private static DEFAULT_MIN_GALLOPING = 7;\n\n  /**\n   * Default tmp storage length. Can increase depending on the size of the\n   * smallest run to merge.\n   */\n  private static DEFAULT_TMP_STORAGE_LENGTH = 256;\n\n  /**\n   * Pre-computed powers of 10 for efficient lexicographic comparison of\n   * small integers.\n   */\n  private static POWERS_OF_TEN = [1e0, 1e1, 1e2, 1e3, 1e4, 1e5, 1e6, 1e7, 1e8, 1e9];\n\n  private readonly array = null;\n  private readonly compare = null;\n  private minGallop = Timsort.DEFAULT_MIN_GALLOPING;\n  private readonly length = 0;\n  private readonly tmpStorageLength = Timsort.DEFAULT_TMP_STORAGE_LENGTH;\n  private readonly stackLength: number = 0;\n  private readonly runStart = null;\n  private readonly runLength = null;\n  private stackSize = 0;\n  private readonly tmp: any;\n\n  constructor(array, compare) {\n    this.array = array;\n    this.compare = compare;\n    this.length = array.length;\n    if (this.length < 2 * Timsort.DEFAULT_TMP_STORAGE_LENGTH) {\n      this.tmpStorageLength = this.length >>> 1;\n    }\n    this.tmp = new Array(this.tmpStorageLength);\n    this.stackLength = (this.length < 120 ? 5 : this.length < 1542 ? 10 : this.length < 119151 ? 19 : 40);\n    this.runStart = new Array(this.stackLength);\n    this.runLength = new Array(this.stackLength);\n  }\n\n  private static log10(x) {\n    if (x < 1e5) {\n      if (x < 1e2) {\n        return x < 1e1 ? 0 : 1;\n      }\n      if (x < 1e4) {\n        return x < 1e3 ? 2 : 3;\n      }\n      return 4;\n    }\n    if (x < 1e7) {\n      return x < 1e6 ? 5 : 6;\n    }\n    if (x < 1e9) {\n      return x < 1e8 ? 7 : 8;\n    }\n    return 9;\n  }\n\n  private static minRunLength(n) {\n    let r = 0;\n    while (n >= Timsort.DEFAULT_MIN_MERGE) {\n      r |= (n & 1);\n      n >>= 1;\n    }\n    return n + r;\n  }\n\n  private static makeAscendingRun(array, lo, hi, compare) {\n    let runHi = lo + 1;\n    if (runHi === hi) {\n      return 1;\n    }\n    // Descending\n    if (compare(array[runHi++], array[lo]) < 0) {\n      while (runHi < hi && compare(array[runHi], array[runHi - 1]) < 0) {\n        runHi++;\n      }\n      Timsort.reverseRun(array, lo, runHi);\n      // Ascending\n    } else {\n      while (runHi < hi && compare(array[runHi], array[runHi - 1]) >= 0) {\n        runHi++;\n      }\n    }\n    return runHi - lo;\n  }\n\n  private static reverseRun(array, lo, hi) {\n    hi--;\n    while (lo < hi) {\n      const t = array[lo];\n      array[lo++] = array[hi];\n      array[hi--] = t;\n    }\n  }\n\n  private static binaryInsertionSort(array, lo, hi, start, compare) {\n    if (start === lo) {\n      start++;\n    }\n    for (; start < hi; start++) {\n      const pivot = array[start];\n      // Ranges of the array where pivot belongs\n      let left = lo;\n      let right = start;\n      while (left < right) {\n        const mid = (left + right) >>> 1;\n        if (compare(pivot, array[mid]) < 0) {\n          right = mid;\n        } else {\n          left = mid + 1;\n        }\n      }\n      let n = start - left;\n      // Switch is just an optimization for small arrays\n      switch (n) {\n        case 3:\n          array[left + 3] = array[left + 2];\n        /* falls through */\n        case 2:\n          array[left + 2] = array[left + 1];\n        /* falls through */\n        case 1:\n          array[left + 1] = array[left];\n          break;\n        default:\n          while (n > 0) {\n            array[left + n] = array[left + n - 1];\n            n--;\n          }\n      }\n      array[left] = pivot;\n    }\n  }\n\n  private static gallopLeft(value, array, start, length, hint, compare) {\n    let lastOffset = 0;\n    let maxOffset;\n    let offset = 1;\n    if (compare(value, array[start + hint]) > 0) {\n      maxOffset = length - hint;\n      while (offset < maxOffset && compare(value, array[start + hint + offset]) > 0) {\n        lastOffset = offset;\n        offset = (offset << 1) + 1;\n        if (offset <= 0) {\n          offset = maxOffset;\n        }\n      }\n      if (offset > maxOffset) {\n        offset = maxOffset;\n      }\n      // Make offsets relative to start\n      lastOffset += hint;\n      offset += hint;\n      // value <= array[start + hint]\n    } else {\n      maxOffset = hint + 1;\n      while (offset < maxOffset && compare(value, array[start + hint - offset]) <= 0) {\n        lastOffset = offset;\n        offset = (offset << 1) + 1;\n        if (offset <= 0) {\n          offset = maxOffset;\n        }\n      }\n      if (offset > maxOffset) {\n        offset = maxOffset;\n      }\n      // Make offsets relative to start\n      const tmp = lastOffset;\n      lastOffset = hint - offset;\n      offset = hint - tmp;\n    }\n    lastOffset++;\n    while (lastOffset < offset) {\n      const m = lastOffset + ((offset - lastOffset) >>> 1);\n      if (compare(value, array[start + m]) > 0) {\n        lastOffset = m + 1;\n      } else {\n        offset = m;\n      }\n    }\n    return offset;\n  }\n\n  private static gallopRight(value, array, start, length, hint, compare) {\n    let lastOffset = 0;\n    let maxOffset;\n    let offset = 1;\n    if (compare(value, array[start + hint]) < 0) {\n      maxOffset = hint + 1;\n      while (offset < maxOffset && compare(value, array[start + hint - offset]) < 0) {\n        lastOffset = offset;\n        offset = (offset << 1) + 1;\n        if (offset <= 0) {\n          offset = maxOffset;\n        }\n      }\n      if (offset > maxOffset) {\n        offset = maxOffset;\n      }\n      // Make offsets relative to start\n      const tmp = lastOffset;\n      lastOffset = hint - offset;\n      offset = hint - tmp;\n      // value >= array[start + hint]\n    } else {\n      maxOffset = length - hint;\n      while (offset < maxOffset && compare(value, array[start + hint + offset]) >= 0) {\n        lastOffset = offset;\n        offset = (offset << 1) + 1;\n        if (offset <= 0) {\n          offset = maxOffset;\n        }\n      }\n      if (offset > maxOffset) {\n        offset = maxOffset;\n      }\n      // Make offsets relative to start\n      lastOffset += hint;\n      offset += hint;\n    }\n    lastOffset++;\n    while (lastOffset < offset) {\n      const m = lastOffset + ((offset - lastOffset) >>> 1);\n      if (compare(value, array[start + m]) < 0) {\n        offset = m;\n      } else {\n        lastOffset = m + 1;\n      }\n    }\n    return offset;\n  }\n\n  private static alphabeticalCompare(a, b) {\n    if (a === b) {\n      return 0;\n    }\n    if (~~a === a && ~~b === b) {\n      if (a === 0 || b === 0) {\n        return a < b ? -1 : 1;\n      }\n      if (a < 0 || b < 0) {\n        if (b >= 0) {\n          return -1;\n        }\n        if (a >= 0) {\n          return 1;\n        }\n        a = -a;\n        b = -b;\n      }\n      const al = Timsort.log10(a);\n      const bl = Timsort.log10(b);\n      let t = 0;\n      if (al < bl) {\n        a *= Timsort.POWERS_OF_TEN[bl - al - 1];\n        b /= 10;\n        t = -1;\n      } else if (al > bl) {\n        b *= Timsort.POWERS_OF_TEN[al - bl - 1];\n        a /= 10;\n        t = 1;\n      }\n      if (a === b) {\n        return t;\n      }\n      return a < b ? -1 : 1;\n    }\n    const aStr = String(a);\n    const bStr = String(b);\n    if (aStr === bStr) {\n      return 0;\n    }\n    return aStr < bStr ? -1 : 1;\n  }\n\n  public static sort(array: any[], compare?: (a: any, b: any) => number, lo?: number, hi?: number) {\n    if (!Array.isArray(array)) {\n      throw new TypeError('Can only sort arrays');\n    }\n    if (!compare) {\n      compare = Timsort.alphabeticalCompare;\n    } else if (typeof compare !== 'function') {\n      hi = lo;\n      lo = compare;\n      compare = Timsort.alphabeticalCompare;\n    }\n    if (!lo) {\n      lo = 0;\n    }\n    if (!hi) {\n      hi = array.length;\n    }\n    let remaining = hi - lo;\n    // The array is already sorted\n    if (remaining < 2) {\n      return;\n    }\n    let runLength = 0;\n    // On small arrays binary sort can be used directly\n    if (remaining < Timsort.DEFAULT_MIN_MERGE) {\n      runLength = Timsort.makeAscendingRun(array, lo, hi, compare);\n      Timsort.binaryInsertionSort(array, lo, hi, lo + runLength, compare);\n      return;\n    }\n    const ts = new Timsort(array, compare);\n    const minRun = Timsort.minRunLength(remaining);\n    do {\n      runLength = Timsort.makeAscendingRun(array, lo, hi, compare);\n      if (runLength < minRun) {\n        let force = remaining;\n        if (force > minRun) {\n          force = minRun;\n        }\n        Timsort.binaryInsertionSort(array, lo, lo + force, lo + runLength, compare);\n        runLength = force;\n      }\n      // Push new run and merge if necessary\n      ts.pushRun(lo, runLength);\n      ts.mergeRuns();\n      // Go find next run\n      remaining -= runLength;\n      lo += runLength;\n    } while (remaining !== 0);\n    // Force merging of remaining runs\n    ts.forceMergeRuns();\n  }\n\n  pushRun(runStart, runLength) {\n    this.runStart[this.stackSize] = runStart;\n    this.runLength[this.stackSize] = runLength;\n    this.stackSize += 1;\n  }\n\n  mergeRuns() {\n    while (this.stackSize > 1) {\n      let n = this.stackSize - 2;\n      if ((n >= 1 && this.runLength[n - 1] <= this.runLength[n] + this.runLength[n + 1])\n        || (n >= 2 && this.runLength[n - 2] <= this.runLength[n] + this.runLength[n - 1])) {\n        if (this.runLength[n - 1] < this.runLength[n + 1]) {\n          n--;\n        }\n      } else if (this.runLength[n] > this.runLength[n + 1]) {\n        break;\n      }\n      this.mergeAt(n);\n    }\n  }\n\n  forceMergeRuns() {\n    while (this.stackSize > 1) {\n      let n = this.stackSize - 2;\n      if (n > 0 && this.runLength[n - 1] < this.runLength[n + 1]) {\n        n--;\n      }\n      this.mergeAt(n);\n    }\n  }\n\n  mergeAt(i) {\n    const compare = this.compare;\n    const array = this.array;\n    let start1 = this.runStart[i];\n    let length1 = this.runLength[i];\n    const start2 = this.runStart[i + 1];\n    let length2 = this.runLength[i + 1];\n    this.runLength[i] = length1 + length2;\n    if (i === this.stackSize - 3) {\n      this.runStart[i + 1] = this.runStart[i + 2];\n      this.runLength[i + 1] = this.runLength[i + 2];\n    }\n    this.stackSize--;\n    const k = Timsort.gallopRight(array[start2], array, start1, length1, 0, compare);\n    start1 += k;\n    length1 -= k;\n    if (length1 === 0) {\n      return;\n    }\n    length2 = Timsort.gallopLeft(array[start1 + length1 - 1], array, start2, length2, length2 - 1, compare);\n    if (length2 === 0) {\n      return;\n    }\n    if (length1 <= length2) {\n      this.mergeLow(start1, length1, start2, length2);\n\n    } else {\n      this.mergeHigh(start1, length1, start2, length2);\n    }\n  }\n\n  mergeLow(start1, length1, start2, length2) {\n    const compare = this.compare;\n    const array = this.array;\n    const tmp = this.tmp;\n    let i;\n    for (i = 0; i < length1; i++) {\n      tmp[i] = array[start1 + i];\n    }\n    let cursor1 = 0;\n    let cursor2 = start2;\n    let dest = start1;\n    array[dest++] = array[cursor2++];\n    if (--length2 === 0) {\n      for (i = 0; i < length1; i++) {\n        array[dest + i] = tmp[cursor1 + i];\n      }\n      return;\n    }\n    if (length1 === 1) {\n      for (i = 0; i < length2; i++) {\n        array[dest + i] = array[cursor2 + i];\n      }\n      array[dest + length2] = tmp[cursor1];\n      return;\n    }\n    let minGallop = this.minGallop;\n    while (true) {\n      let count1 = 0;\n      let count2 = 0;\n      let exit = false;\n      do {\n        if (compare(array[cursor2], tmp[cursor1]) < 0) {\n          array[dest++] = array[cursor2++];\n          count2++;\n          count1 = 0;\n          if (--length2 === 0) {\n            exit = true;\n            break;\n          }\n        } else {\n          array[dest++] = tmp[cursor1++];\n          count1++;\n          count2 = 0;\n          if (--length1 === 1) {\n            exit = true;\n            break;\n          }\n        }\n      } while ((count1 | count2) < minGallop);\n      if (exit) {\n        break;\n      }\n      do {\n        count1 = Timsort.gallopRight(array[cursor2], tmp, cursor1, length1, 0, compare);\n        if (count1 !== 0) {\n          for (i = 0; i < count1; i++) {\n            array[dest + i] = tmp[cursor1 + i];\n          }\n          dest += count1;\n          cursor1 += count1;\n          length1 -= count1;\n          if (length1 <= 1) {\n            exit = true;\n            break;\n          }\n        }\n        array[dest++] = array[cursor2++];\n        if (--length2 === 0) {\n          exit = true;\n          break;\n        }\n        count2 = Timsort.gallopLeft(tmp[cursor1], array, cursor2, length2, 0, compare);\n        if (count2 !== 0) {\n          for (i = 0; i < count2; i++) {\n            array[dest + i] = array[cursor2 + i];\n          }\n          dest += count2;\n          cursor2 += count2;\n          length2 -= count2;\n          if (length2 === 0) {\n            exit = true;\n            break;\n          }\n        }\n        array[dest++] = tmp[cursor1++];\n        if (--length1 === 1) {\n          exit = true;\n          break;\n        }\n        minGallop--;\n      } while (count1 >= Timsort.DEFAULT_MIN_GALLOPING || count2 >= Timsort.DEFAULT_MIN_GALLOPING);\n      if (exit) {\n        break;\n      }\n      if (minGallop < 0) {\n        minGallop = 0;\n      }\n      minGallop += 2;\n    }\n    this.minGallop = minGallop;\n    if (minGallop < 1) {\n      this.minGallop = 1;\n    }\n    if (length1 === 1) {\n      for (i = 0; i < length2; i++) {\n        array[dest + i] = array[cursor2 + i];\n      }\n      array[dest + length2] = tmp[cursor1];\n    } else if (length1 === 0) {\n      throw new Error('mergeLow preconditions were not respected');\n    } else {\n      for (i = 0; i < length1; i++) {\n        array[dest + i] = tmp[cursor1 + i];\n      }\n    }\n  }\n\n  mergeHigh(start1, length1, start2, length2) {\n    const compare = this.compare;\n    const array = this.array;\n    const tmp = this.tmp;\n    let i;\n    for (i = 0; i < length2; i++) {\n      tmp[i] = array[start2 + i];\n    }\n    let cursor1 = start1 + length1 - 1;\n    let cursor2 = length2 - 1;\n    let dest = start2 + length2 - 1;\n    let customCursor = 0;\n    let customDest = 0;\n    array[dest--] = array[cursor1--];\n    if (--length1 === 0) {\n      customCursor = dest - (length2 - 1);\n      for (i = 0; i < length2; i++) {\n        array[customCursor + i] = tmp[i];\n      }\n      return;\n    }\n    if (length2 === 1) {\n      dest -= length1;\n      cursor1 -= length1;\n      customDest = dest + 1;\n      customCursor = cursor1 + 1;\n      for (i = length1 - 1; i >= 0; i--) {\n        array[customDest + i] = array[customCursor + i];\n      }\n      array[dest] = tmp[cursor2];\n      return;\n    }\n    let minGallop = this.minGallop;\n    while (true) {\n      let count1 = 0;\n      let count2 = 0;\n      let exit = false;\n      do {\n        if (compare(tmp[cursor2], array[cursor1]) < 0) {\n          array[dest--] = array[cursor1--];\n          count1++;\n          count2 = 0;\n          if (--length1 === 0) {\n            exit = true;\n            break;\n          }\n        } else {\n          array[dest--] = tmp[cursor2--];\n          count2++;\n          count1 = 0;\n          if (--length2 === 1) {\n            exit = true;\n            break;\n          }\n        }\n      } while ((count1 | count2) < minGallop);\n      if (exit) {\n        break;\n      }\n      do {\n        count1 = length1 - Timsort.gallopRight(tmp[cursor2], array, start1, length1, length1 - 1, compare);\n        if (count1 !== 0) {\n          dest -= count1;\n          cursor1 -= count1;\n          length1 -= count1;\n          customDest = dest + 1;\n          customCursor = cursor1 + 1;\n          for (i = count1 - 1; i >= 0; i--) {\n            array[customDest + i] = array[customCursor + i];\n          }\n          if (length1 === 0) {\n            exit = true;\n            break;\n          }\n        }\n        array[dest--] = tmp[cursor2--];\n        if (--length2 === 1) {\n          exit = true;\n          break;\n        }\n        count2 = length2 - Timsort.gallopLeft(array[cursor1], tmp, 0, length2, length2 - 1, compare);\n        if (count2 !== 0) {\n          dest -= count2;\n          cursor2 -= count2;\n          length2 -= count2;\n          customDest = dest + 1;\n          customCursor = cursor2 + 1;\n          for (i = 0; i < count2; i++) {\n            array[customDest + i] = tmp[customCursor + i];\n          }\n          if (length2 <= 1) {\n            exit = true;\n            break;\n          }\n        }\n        array[dest--] = array[cursor1--];\n        if (--length1 === 0) {\n          exit = true;\n          break;\n        }\n        minGallop--;\n      } while (count1 >= Timsort.DEFAULT_MIN_GALLOPING || count2 >= Timsort.DEFAULT_MIN_GALLOPING);\n      if (exit) {\n        break;\n      }\n      if (minGallop < 0) {\n        minGallop = 0;\n      }\n      minGallop += 2;\n    }\n    this.minGallop = minGallop;\n    if (minGallop < 1) {\n      this.minGallop = 1;\n    }\n    if (length2 === 1) {\n      dest -= length1;\n      cursor1 -= length1;\n      customDest = dest + 1;\n      customCursor = cursor1 + 1;\n      for (i = length1 - 1; i >= 0; i--) {\n        array[customDest + i] = array[customCursor + i];\n      }\n      array[dest] = tmp[cursor2];\n    } else if (length2 === 0) {\n      throw new Error('mergeHigh preconditions were not respected');\n    } else {\n      customCursor = dest - (length2 - 1);\n      for (i = 0; i < length2; i++) {\n        array[customCursor + i] = tmp[i];\n      }\n    }\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, EventEmitter, Input, NgZone, OnInit, Output, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {DataModel} from '../../model/dataModel';\nimport {GTS} from '../../model/GTS';\nimport {GTSLib} from '../../utils/gts.lib';\nimport moment from 'moment-timezone';\nimport {ChartBounds} from '../../model/chartBounds';\nimport {ColorLib} from '../../utils/color-lib';\nimport {VisibilityState, WarpViewComponent} from '../warp-view-component';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {Subject} from 'rxjs';\nimport {debounceTime} from 'rxjs/operators';\nimport {Timsort} from '../../utils/timsort';\n\n@Component({\n  selector: 'warpview-chart',\n  templateUrl: './warp-view-chart.component.html',\n  styleUrls: ['./warp-view-chart.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewChartComponent extends WarpViewComponent implements OnInit {\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    const previousVisibility = JSON.stringify(this.visibility);\n    this.LOG.debug(['hiddenData', 'previousVisibility'], previousVisibility);\n    this._hiddenData = hiddenData;\n    this.visibility = [];\n    this.visibleGtsId.forEach(id => this.visibility.push(hiddenData.indexOf(id) < 0 && (id !== -1)));\n    this.LOG.debug(['hiddenData', 'hiddendygraphfullv'], this.visibility);\n    const newVisibility = JSON.stringify(this.visibility);\n    this.LOG.debug(['hiddenData', 'json'], previousVisibility, newVisibility, this._hiddenData);\n    if (previousVisibility !== newVisibility) {\n      const visible = [];\n      const hidden = [];\n      (this.gtsId || []).forEach((id, i) => {\n        if (this._hiddenData.indexOf(id) > -1) {\n          hidden.push(i);\n        } else {\n          visible.push(i);\n        }\n      });\n      if (visible.length > 0) {\n        this.graph.restyleChart({visible: true}, visible);\n      }\n      if (hidden.length > 0) {\n        this.graph.restyleChart({visible: false}, hidden);\n      }\n      this.LOG.debug(['hiddendygraphtrig', 'destroy'], 'redraw by visibility change', visible, hidden);\n    }\n  }\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  @Input('standalone') standalone = true;\n  @Output('boundsDidChange') boundsDidChange = new EventEmitter<any>();\n  @Output('pointHover') pointHover = new EventEmitter<any>();\n  @Output('warpViewChartResize') warpViewChartResize = new EventEmitter<any>();\n\n  // tslint:disable-next-line:variable-name\n  private _type = 'line';\n  private visibility: boolean[] = [];\n  private maxTick = 0;\n  private minTick = 0;\n  private visibleGtsId = [];\n  private gtsId = [];\n  private dataHashset = {};\n  private chartBounds: ChartBounds = new ChartBounds();\n  private visibilityStatus: VisibilityState = 'unknown';\n  private afterBoundsUpdate = false;\n  private marginLeft: number;\n  private maxPlottable = 10000;\n  parsing = false;\n  unhighliteCurve = new Subject<number[]>();\n  highliteCurve = new Subject<{ on: number[], off: number[] }>();\n  layout: Partial<any> = {\n    showlegend: false,\n    autosize: true,\n    hovermode: 'x',\n    hoverdistance: 20,\n    xaxis: {\n      font: {}\n    },\n    yaxis: {\n      exponentformat: 'none',\n      fixedrange: true,\n      automargin: true,\n      showline: true,\n      font: {}\n    },\n    margin: {\n      t: 0,\n      b: 30,\n      r: 10,\n      l: 50\n    },\n  };\n  private highlighted: any;\n\n  update(options, refresh): void {\n    this.drawChart(refresh);\n  }\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewChartComponent, this._debug);\n  }\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  public async getTimeClip(): Promise<ChartBounds> {\n    return new Promise<ChartBounds>(resolve => {\n      this.LOG.debug(['getTimeClip'], this.chartBounds);\n      resolve(this.chartBounds);\n    });\n  }\n\n  public resize(newHeight: number) {\n    this.height = newHeight;\n    this.layout.height = this.height;\n    if (this._options.showRangeSelector) {\n      this.layout.xaxis.rangeslider = {\n        bgcolor: 'transparent',\n        thickness: 40 / this.height\n      };\n    }\n  }\n\n  drawChart(reparseNewData: boolean = false) {\n    this.LOG.debug(['drawChart', 'this.layout', 'this.options'], this.layout, this._options);\n    if (!this.initChart(this.el)) {\n      this.LOG.debug(['drawChart', 'initChart'], this._options);\n      return;\n    }\n    this.plotlyConfig.scrollZoom = true;\n    if (!!this._options.timeMode && this._options.timeMode === 'timestamp') {\n      this.layout.xaxis.type = 'linear';\n      this.layout.xaxis.tick0 = this.minTick / this.divider;\n    } else {\n      this.layout.xaxis.type = 'date';\n      this.layout.xaxis.tick0 = moment.tz(this.minTick / this.divider, this._options.timeZone).toISOString(true);\n    }\n    this.layout.yaxis.gridcolor = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.gridcolor = this.getGridColor(this.el.nativeElement);\n    this.layout.yaxis.zerolinecolor = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.zerolinecolor = this.getGridColor(this.el.nativeElement);\n    this.layout.margin.t = this.standalone ? 20 : 10;\n    this.layout.showlegend = this._showLegend;\n    if (!this._responsive) {\n      this.layout.width = this.width;\n      this.layout.height = this.height;\n    }\n    this.LOG.debug(['drawChart', 'this.options'], this.layout, this._options);\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    if (this._options.showRangeSelector) {\n      this.layout.xaxis.rangeslider = {\n        bgcolor: 'transparent',\n        thickness: 40 / this.height\n      };\n    } else {\n      this.layout.margin.b = 30;\n    }\n    const x: any = {\n      tick0: undefined,\n      range: [],\n    };\n    this.LOG.debug(['drawChart', 'updateBounds'], this.chartBounds);\n    const min = this.chartBounds.tsmin || this.minTick;\n    const max = this.chartBounds.tsmax || this.maxTick;\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      x.tick0 = min / this.divider;\n      x.range = [min, max];\n    } else {\n      x.tick0 = moment.tz(min / this.divider, this._options.timeZone).toISOString(true);\n      x.range = [\n        moment.tz(min / this.divider, this._options.timeZone).toISOString(true),\n        moment.tz(max / this.divider, this._options.timeZone).toISOString(true)\n      ];\n    }\n    this.layout.xaxis = x;\n    this.layout = {...this.layout};\n    this.loading = false;\n    this.highliteCurve.pipe(debounceTime(200)).subscribe(value => {\n      Promise.resolve().then(() => {\n        this.graph.restyleChart({opacity: 0.4}, value.off);\n        this.graph.restyleChart({opacity: 1}, value.on);\n      });\n    });\n    this.unhighliteCurve.pipe(debounceTime(200)).subscribe(value => {\n      Promise.resolve().then(() => {\n        this.graph.restyleChart({opacity: 1}, value);\n      });\n    });\n  }\n\n  private emitNewBounds(min, max, marginLeft) {\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      this.boundsDidChange.emit({bounds: {min, max, marginLeft}, source: 'chart'});\n    } else {\n      this.boundsDidChange.emit({\n        bounds: {\n          min: moment.tz(min, this._options.timeZone).valueOf(),\n          max: moment.tz(max, this._options.timeZone).valueOf(),\n          marginLeft\n        }, source: 'chart'\n      });\n    }\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    this.parsing = true;\n    const dataset: Partial<any>[] = [];\n    this.LOG.debug(['convert'], this._options.timeMode);\n    this.LOG.debug(['convert', 'this._hiddenData'], this._hiddenData);\n    if (GTSLib.isArray(data.data)) {\n      let gtsList = GTSLib.flatDeep(GTSLib.flattenGtsIdArray(data.data as any[], 0).res);\n      this.maxTick = Number.NEGATIVE_INFINITY;\n      this.minTick = Number.POSITIVE_INFINITY;\n      this.visibleGtsId = [];\n      this.gtsId = [];\n      const nonPlottable = gtsList.filter(g => {\n        this.LOG.debug(['convert'], GTSLib.isGtsToPlot(g));\n        return (g.v && !GTSLib.isGtsToPlot(g));\n      });\n      gtsList = gtsList.filter(g => {\n        return (g.v && GTSLib.isGtsToPlot(g));\n      });\n      // initialize visibility status\n      if (this.visibilityStatus === 'unknown') {\n        this.visibilityStatus = gtsList.length > 0 ? 'plottableShown' : 'nothingPlottable';\n      }\n\n      this.LOG.debug(['convert'], this._options.timeMode);\n      let timestampMode = true;\n      const tsLimit = 100 * GTSLib.getDivider(this._options.timeUnit);\n      this.LOG.debug(['convert'], 'forEach GTS');\n      gtsList.forEach((gts: GTS) => {\n        const ticks = gts.v.map(t => t[0]);\n        const size = gts.v.length;\n        timestampMode = timestampMode && (ticks[0] > -tsLimit && ticks[0] < tsLimit);\n        timestampMode = timestampMode && (ticks[size - 1] > -tsLimit && ticks[size - 1] < tsLimit);\n      });\n      if (timestampMode || this._options.timeMode === 'timestamp') {\n        this.layout.xaxis.type = 'linear';\n      } else {\n        this.layout.xaxis.type = 'date';\n      }\n      gtsList.forEach((gts: GTS, i) => {\n        if (gts.v && GTSLib.isGtsToPlot(gts)) {\n          Timsort.sort(gts.v, (a, b) => a[0] - b[0]);\n          const size = gts.v.length;\n          this.LOG.debug(['convert'], gts);\n          const label = GTSLib.serializeGtsMetadata(gts);\n          const c = ColorLib.getColor(gts.id, this._options.scheme);\n          const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n          const series: Partial<any> = {\n            type: this._type === 'spline' ? 'scatter' : 'scattergl',\n            mode: this._type === 'scatter' ? 'markers' : size > this.maxPlottable ? 'lines' : 'lines+markers',\n            // name: label,\n            text: label,\n            x: [],\n            y: [],\n            line: {color},\n            hoverinfo: 'none',\n            connectgaps: false,\n            visible: !(this._hiddenData.filter(h => h === gts.id).length > 0),\n          };\n          if (this._type === 'scatter' || size < this.maxPlottable) {\n            series.marker = {\n              size: 15,\n              color: new Array(size).fill(color),\n              line: {color, width: 3},\n              opacity: new Array(size).fill(this._type === 'scatter' || this._options.showDots ? 1 : 0)\n            };\n          }\n          switch (this._type) {\n            case 'spline':\n              series.line.shape = 'spline';\n              break;\n            case 'area':\n              series.fill = 'tozeroy';\n              series.fillcolor = ColorLib.transparentize(color, 0.3);\n              break;\n            case 'step':\n              series.line.shape = 'hvh';\n              break;\n            case 'step-before':\n              series.line.shape = 'vh';\n              break;\n            case 'step-after':\n              series.line.shape = 'hv';\n              break;\n          }\n          this.visibleGtsId.push(gts.id);\n          this.gtsId.push(gts.id);\n          this.LOG.debug(['convert'], 'forEach value');\n          const ticks = gts.v.map(t => t[0]);\n          const values = gts.v.map(t => t[t.length - 1]);\n\n          if (size > 0) {\n            this.minTick = this.minTick || ticks[0];\n            this.maxTick = this.maxTick || ticks[0];\n            for (let v = 1; v < size; v++) {\n              const val = ticks[v];\n              this.minTick = val <= this.minTick ? val : this.minTick;\n              this.maxTick = val >= this.maxTick ? val : this.maxTick;\n            }\n          }\n          if (timestampMode || this._options.timeMode === 'timestamp') {\n            series.x = ticks;\n          } else {\n            if (this._options.timeZone !== 'UTC') {\n              series.x = ticks.map(t => moment.utc(t / this.divider).tz(this._options.timeZone).toISOString());\n            } else {\n              series.x = ticks.map(t => moment.utc(t / this.divider).toISOString());\n            }\n          }\n          series.y = values;\n          this.LOG.debug(['convert'], 'forEach value end', this.minTick, this.maxTick);\n          dataset.push(series);\n        }\n      });\n      if (nonPlottable.length > 0 && gtsList.length === 0) {\n        nonPlottable.forEach(g => {\n          g.v.forEach(value => {\n            const ts = value[0];\n            if (ts < this.minTick) {\n              this.minTick = ts;\n            }\n            if (ts > this.maxTick) {\n              this.maxTick = ts;\n            }\n          });\n        });\n        // if there is not any plottable data, we must add a fake one with id -1. This one will always be hidden.\n        if (0 === gtsList.length) {\n          if (!this.dataHashset[this.minTick]) {\n            this.dataHashset[this.minTick] = [0];\n          }\n          if (!this.dataHashset[this.maxTick]) {\n            this.dataHashset[this.maxTick] = [0];\n          }\n          this.visibility.push(false);\n          this.visibleGtsId.push(-1);\n        }\n      }\n    }\n    this.parsing = false;\n    this.LOG.debug(['convert'], 'end', dataset);\n    this.noData = dataset.length === 0;\n    return dataset;\n  }\n\n  afterPlot(plotlyInstance) {\n    super.afterPlot(plotlyInstance);\n    this.marginLeft = parseInt((this.graph.plotEl.nativeElement as HTMLElement).querySelector('g.bglayer > rect').getAttribute('x'), 10);\n    this.LOG.debug(['plotly_afterPlot']);\n    if (this.chartBounds.tsmin !== this.minTick || this.chartBounds.tsmax !== this.maxTick) {\n      this.chartBounds.tsmin = this.minTick;\n      this.chartBounds.tsmax = this.maxTick;\n      this.chartBounds.marginLeft = this.marginLeft;\n      this.chartDraw.emit(this.chartBounds);\n      if (this.afterBoundsUpdate || this.standalone) {\n        this.LOG.debug(['afterPlot', 'updateBounds'], this.minTick, this.maxTick);\n        this.emitNewBounds(this.minTick, this.maxTick, this.marginLeft);\n        this.loading = false;\n        this.afterBoundsUpdate = false;\n      }\n    } else {\n      this.loading = false;\n    }\n  }\n\n  relayout(data: any) {\n    if (data['xaxis.range'] && data['xaxis.range'].length === 2) {\n      this.LOG.debug(['relayout', 'updateBounds', 'xaxis.range'], data['xaxis.range']);\n      this.chartBounds.msmin = data['xaxis.range'][0];\n      this.chartBounds.msmax = data['xaxis.range'][1];\n      this.chartBounds.tsmin = moment.tz(moment(this.chartBounds.msmin), this._options.timeZone).valueOf() * this.divider;\n      this.chartBounds.tsmax = moment.tz(moment(this.chartBounds.msmax), this._options.timeZone).valueOf() * this.divider;\n    } else if (data['xaxis.range[0]'] && data['xaxis.range[1]']) {\n      this.LOG.debug(['relayout', 'updateBounds', 'xaxis.range[x]'], data['xaxis.range[0]']);\n      this.chartBounds.msmin = data['xaxis.range[0]'];\n      this.chartBounds.msmax = data['xaxis.range[1]'];\n      this.chartBounds.tsmin = moment.tz(moment(this.chartBounds.msmin), this._options.timeZone).valueOf() * this.divider;\n      this.chartBounds.tsmax = moment.tz(moment(this.chartBounds.msmax), this._options.timeZone).valueOf() * this.divider;\n    } else if (data['xaxis.autorange']) {\n      this.LOG.debug(['relayout', 'updateBounds', 'autorange'], data, this.minTick, this.maxTick);\n      this.chartBounds.tsmin = this.minTick;\n      this.chartBounds.tsmax = this.maxTick;\n    }\n    this.LOG.debug(['relayout', 'updateBounds'], this.chartBounds);\n    this.emitNewBounds(this.chartBounds.tsmin, this.chartBounds.tsmax, this.marginLeft);\n    this.loading = false;\n    this.afterBoundsUpdate = false;\n\n  }\n\n  sliderChange($event: any) {\n    this.LOG.debug(['sliderChange'], $event);\n    console.log($event);\n  }\n\n  updateBounds(min, max) {\n    this.LOG.debug(['updateBounds'], min, max, this._options);\n    min = min || this.minTick / this.divider;\n    max = max || this.maxTick / this.divider;\n    this.layout.xaxis.autorange = false;\n    this.LOG.debug(['updateBounds'],\n      moment.tz(min, this._options.timeZone).toISOString(),\n      moment.tz(max, this._options.timeZone).toISOString());\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      this.layout.xaxis.range = [min, max];\n      this.layout.xaxis.tick0 = min;\n    } else {\n      this.layout.xaxis.range = [\n        moment.tz(min, this._options.timeZone).toISOString(),\n        moment.tz(max, this._options.timeZone).toISOString()\n      ];\n      this.layout.xaxis.tick0 = moment.tz(min, this._options.timeZone).toISOString();\n    }\n    this.layout = {...this.layout};\n    this.LOG.debug(['updateBounds'], this.layout);\n    this.afterBoundsUpdate = true;\n  }\n\n\n  setRealBounds(chartBounds: ChartBounds) {\n    this.afterBoundsUpdate = true;\n    this.minTick = chartBounds.tsmin;\n    this.maxTick = chartBounds.tsmax;\n    this._options.bounds = this._options.bounds || {};\n    this._options.bounds.minDate = this.minTick;\n    this._options.bounds.maxDate = this.maxTick;\n    const x: any = {\n      tick0: undefined,\n      range: [],\n    };\n    if (this._options.showRangeSelector) {\n      x.rangeslider = {\n        bgcolor: 'transparent',\n        thickness: 40 / this.height\n      };\n    }\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      x.tick0 = this.minTick / this.divider;\n      x.range = [this.minTick, this.maxTick];\n    } else {\n      x.tick0 = moment.tz(this.minTick / this.divider, this._options.timeZone).toISOString(true);\n      x.range = [\n        moment.tz(this.minTick / this.divider, this._options.timeZone).toISOString(true),\n        moment.tz(this.maxTick / this.divider, this._options.timeZone).toISOString(true)\n      ];\n    }\n    this.layout.xaxis = x;\n    this.layout = {...this.layout};\n  }\n\n  hover(data: any) {\n    this.LOG.debug(['hover'], data);\n    let delta = Number.MAX_VALUE;\n    // tslint:disable-next-line:no-shadowed-variable\n    let point;\n    const curves = [];\n    this.toolTip.nativeElement.style.display = 'block';\n    if (data.points[0] && data.points[0].data.orientation !== 'h') {\n      const y = (data.yvals || [''])[0];\n      data.points.forEach(p => {\n        curves.push(p.curveNumber);\n        const d = Math.abs(p.y - y);\n        if (d < delta) {\n          delta = d;\n          point = p;\n        }\n      });\n    } else {\n      const x: number = (data.xvals || [''])[0];\n      data.points.forEach(p => {\n        curves.push(p.curveNumber);\n        const d = Math.abs(p.x - x);\n        if (d < delta) {\n          delta = d;\n          point = p;\n        }\n      });\n    }\n    if (point && this.highlighted !== point.curveNumber) {\n      this.highliteCurve.next({on: [point.curveNumber], off: curves});\n      this.highlighted = point.curveNumber;\n    }\n    super.hover(data, point);\n    this.pointHover.emit(data.event);\n    /*setTimeout(() => {\n      let pn = -1;\n      let tn = -1;\n      let color = [];\n      let line = {};\n      let opacity = [];\n      data.points.forEach(p => {\n        if (!!p.data.marker) {\n          color = p.data.marker.color;\n          opacity = p.data.marker.opacity;\n          line = p.data.marker.line;\n          pn = p.pointNumber;\n          tn = p.curveNumber;\n          if (pn >= 0) {\n            color[pn] = 'transparent';\n            opacity[pn] = 1;\n            const update = {marker: {color, opacity, line, size: 15}};\n            this.graph.restyleChart(update, [tn]);\n            this.LOG.debug(['hover'], 'restyleChart inner', update, [tn]);\n          }\n        }\n      });\n    })*/\n  }\n\n  unhover(data: any) {\n    let delta = Number.MAX_VALUE;\n    // tslint:disable-next-line:no-shadowed-variable\n    let point;\n    if (data.points[0] && data.points[0].data.orientation !== 'h') {\n      const y = (data.yvals || [''])[0];\n      data.points.forEach(p => {\n        const d = Math.abs(p.y - y);\n        if (d < delta) {\n          delta = d;\n          point = p;\n        }\n      });\n    } else {\n      const x: number = (data.xvals || [''])[0];\n      data.points.forEach(p => {\n        const d = Math.abs(p.x - x);\n        if (d < delta) {\n          delta = d;\n          point = p;\n        }\n      });\n    }\n    if (!!point && this.highlighted !== point.curveNumber) {\n      this.unhighliteCurve.next([this.highlighted]);\n      this.highlighted = undefined;\n    }\n    super.unhover(data, point);\n    /*setTimeout(() => {\n      let pn = -1;\n      let tn = -1;\n      let color = [];\n      let line = {};\n      let opacity = [];\n      data.points.forEach(p => {\n        if (!!p.data.marker) {\n          pn = p.pointNumber;\n          tn = p.curveNumber;\n          color = p.data.marker.color;\n          opacity = p.data.marker.opacity;\n          line = p.data.marker.line;\n          if (pn >= 0) {\n            color[pn] = p.data.line.color;\n            opacity[pn] = this._options.showDots ? 1 : 0;\n            const update = {marker: {color, opacity, line, size: 15}};\n            this.graph.restyleChart(update, [tn]);\n          }\n        }\n      });\n    })*/\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Injectable} from '@angular/core';\nimport {HttpErrorResponse} from '@angular/common/http';\n\nimport {Observable} from 'rxjs/internal/Observable';\nimport {of} from 'rxjs/internal/observable/of';\nimport {Logger} from '../utils/logger';\n\n\n/** Type of the handleError function returned by HttpErrorHandler.createHandleError */\nexport type HandleError = (operation?: string) => (error: HttpErrorResponse) => Observable<string>;\n\n// noinspection UnterminatedStatementJS\n/** Handles HttpClient errors */\n@Injectable()\nexport class HttpErrorHandler {\n  private LOG: Logger;\n\n  /**\n   */\n  constructor() {\n    this.LOG = new Logger(HttpErrorHandler, true);\n  }\n\n  createHandleError = (serviceName = '') =>\n    // tslint:disable-next-line:semicolon\n    (operation = 'operation') => this.handleError(serviceName, operation);\n\n  handleError(serviceName = '', operation = 'operation') {\n    return (error: HttpErrorResponse): Observable<string> => {\n      this.LOG.error([serviceName], error);\n      this.LOG.error([serviceName], `${operation} failed: ${error.statusText}`);\n      const message = ((error.error || {}).message)\n        ? error.error.message\n        : error.status ? error.statusText : 'Server error';\n      this.LOG.error([serviceName], message);\n      return of(message);\n    };\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {HttpClient, HttpResponse} from '@angular/common/http';\nimport {Injectable} from '@angular/core';\nimport {catchError, tap} from 'rxjs/operators';\nimport {HandleError, HttpErrorHandler} from './http-error-handler.service';\nimport {Logger} from '../utils/logger';\nimport {Observable} from 'rxjs';\n\n@Injectable({providedIn: 'root'})\nexport class Warp10Service {\n\n  private LOG: Logger;\n  private readonly handleError: HandleError;\n\n  constructor(\n    private http: HttpClient,\n    private httpErrorHandler: HttpErrorHandler) {\n    this.LOG = new Logger(Warp10Service, true);\n    this.handleError = httpErrorHandler.createHandleError('Warp10Service');\n  }\n\n  exec(warpScript: string, url: string): Observable<HttpResponse<string>> {\n    this.LOG.debug(['exec', 'warpScript'], url, warpScript);\n    return this.http.post<string>(url, warpScript, {\n      // @ts-ignore\n      observe: 'response',\n      // @ts-ignore\n      responseType: 'text'\n    })\n      .pipe(\n        tap(r => this.LOG.debug(['exec', 'result'], r)),\n        catchError(this.handleError('exec'))\n      );\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {\n  AfterViewInit,\n  Component,\n  ElementRef,\n  EventEmitter,\n  HostListener,\n  Input,\n  NgZone,\n  OnInit,\n  Output,\n  Renderer2,\n  ViewChild\n} from '@angular/core';\nimport {Param} from '../../model/param';\nimport {DataModel} from '../../model/dataModel';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {HttpErrorHandler} from '../../services/http-error-handler.service';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {SizeService} from '../../services/resize.service';\nimport {Warp10Service} from '../../services/warp10.service';\nimport {Logger} from '../../utils/logger';\nimport {HttpResponse} from '@angular/common/http';\n\n@Component({\n  selector: 'warpview-tile',\n  templateUrl: './warp-view-tile.component.html',\n  styleUrls: ['./warp-view-tile.component.scss'],\n  providers: [HttpErrorHandler],\n  // encapsulation: ViewEncapsulation.None\n})\nexport class WarpViewTileComponent extends WarpViewComponent implements OnInit, AfterViewInit {\n  @ViewChild('warpRef', {static: true}) warpRef: ElementRef;\n  @Output('warpscriptResult') warpscriptResult = new EventEmitter<any>();\n  @Output('execStatus') execStatus = new EventEmitter<any>();\n  @Output('execError') execError = new EventEmitter<any>();\n\n  @Input('type') type = 'line';\n  @Input('chartTitle') chartTitle;\n  @Input('url') url = '';\n  @Input('isAlone') isAlone = false; // used by plot to manage its keyboard events\n  @Input('gtsFilter') set gtsFilter(gtsFilter: string) {\n    this._gtsFilter = gtsFilter;\n  }\n\n  @Input()\n  set warpscript(warpScript: string) {\n    if (!!warpScript && this._warpScript !== warpScript) {\n      this._warpScript = warpScript;\n      this.execute(true);\n    }\n  }\n\n  get warpscript(): string {\n    return this._warpScript;\n  }\n\n  loaderMessage = '';\n  error: any;\n  status: string;\n  loading = false;\n  execResult: string;\n\n  private timer: any;\n  private _autoRefresh;\n  private _gtsFilter = '';\n  private _warpScript = '';\n  private execUrl = '';\n  private timeUnit = 'us';\n\n  constructor(\n    public el: ElementRef,\n    public sizeService: SizeService,\n    public renderer: Renderer2,\n    public ngZone: NgZone,\n    private warp10Service: Warp10Service,\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewTileComponent, this._debug);\n  }\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  ngAfterViewInit() {\n    this._warpScript = this._warpScript || this.warpRef.nativeElement.textContent.trim();\n    this.LOG.debug(['ngAfterViewInit', 'warpScript'], this._warpScript);\n    this.el.nativeElement.style.opacity = '1';\n    if (this.warpRef.nativeElement.textContent.trim() !== '') {\n      this.execute(false);\n    }\n  }\n\n  update(options: Param): void {\n    this.LOG.debug(['update', 'options'], options);\n  }\n\n  /* Listeners */\n  @HostListener('document:keyup', ['$event'])\n  // @HostListener('keydown', ['$event'])\n  handleKeyDown(event: KeyboardEvent) {\n    if (event.key === 'r') {\n      this.execute(false);\n    }\n  }\n\n  /** detect some VSCode special modifiers in the beginnig of the code:\n   * @endpoint xxxURLxxx\n   * @timeUnit ns\n   * warning : the first line is empty (to confirm with other browsers)\n   */\n  private detectWarpScriptSpecialComments() {\n    // analyse the first warpScript lines starting with //\n    const extraParamsPattern = /\\s*\\/\\/\\s*@(\\w*)\\s*(.*)$/g;\n    const warpscriptLines = this._warpScript.split('\\n');\n    for (let l = 1; l < warpscriptLines.length; l++) {\n      const currentLine = warpscriptLines[l];\n      if (currentLine === '' || currentLine.search('//') >= 0) {\n        // find and extract // @paramname parameters\n        let lineOnMatch: RegExpMatchArray | null;\n        const re = RegExp(extraParamsPattern);\n        // noinspection JSAssignmentUsedAsCondition\n        // tslint:disable-next-line:no-conditional-assignment JSAssignmentUsedAsCondition\n        // noinspection JSAssignmentUsedAsCondition\n        while (lineOnMatch = re.exec(currentLine)) {\n          const parameterName = lineOnMatch[1];\n          const parameterValue = lineOnMatch[2];\n          switch (parameterName) {\n            case 'endpoint':        //        // @endpoint http://mywarp10server/api/v0/exec\n              this.execUrl = parameterValue;\n              break;\n            case 'timeUnit':\n              this.timeUnit = parameterValue.toLowerCase();   // set the time unit for graphs\n              break;\n            default:\n              break;\n          }\n        }\n      } else {\n        break; // no more comments at the beginning of the file\n      }\n    }\n  }\n\n  private execute(isRefresh: boolean) {\n    if (!!this._warpScript && this._warpScript.trim() !== '') {\n      this.LOG.debug(['execute'], isRefresh);\n      this.error = undefined;\n      this.loading = !isRefresh;\n      this.execResult = undefined;\n      this.loaderMessage = 'Requesting data';\n      this.execUrl = this.url;\n      //  this.execResult = undefined;\n      this.detectWarpScriptSpecialComments();\n      this.LOG.debug(['execute', 'warpScript'], this._warpScript);\n      this.warp10Service.exec(this._warpScript, this.execUrl).subscribe((response: HttpResponse<string> | string) => {\n        this.loading = false;\n        this.LOG.debug(['execute'], response);\n        if ((response as HttpResponse<string>).body) {\n          try {\n            const body = (response as HttpResponse<string>).body;\n            this.warpscriptResult.emit(body);\n            const headers = (response as HttpResponse<string>).headers;\n            this.status = `Your script execution took\n ${GTSLib.formatElapsedTime(parseInt(headers.get('x-warp10-elapsed'), 10))}\n serverside, fetched\n ${headers.get('x-warp10-fetched')} datapoints and performed\n ${headers.get('x-warp10-ops')}  WarpScript operations.`;\n            this.execStatus.emit({\n              message: this.status,\n              ops: parseInt(headers.get('x-warp10-ops'), 10),\n              elapsed: parseInt(headers.get('x-warp10-elapsed'), 10),\n              fetched: parseInt(headers.get('x-warp10-fetched'), 10),\n            });\n            if (this._autoRefresh !== this._options.autoRefresh) {\n              this._autoRefresh = this._options.autoRefresh;\n              if (this.timer) {\n                window.clearInterval(this.timer);\n              }\n              if (this._autoRefresh && this._autoRefresh > 0) {\n                this.timer = window.setInterval(() => this.execute(true), this._autoRefresh * 1000);\n              }\n            }\n            setTimeout(() => {\n              this.execResult = body;\n              this.loading = false;\n            });\n          } catch (e) {\n            this.LOG.error(['execute'], e);\n            this.loading = false;\n          }\n        } else {\n          this.LOG.error(['execute'], response);\n          this.error = response;\n          this.loading = false;\n          this.execError.emit(response);\n        }\n      }, e => {\n        this.loading = false;\n        this.execError.emit(e);\n        this.LOG.error(['execute'], e);\n      });\n    }\n  }\n\n  protected convert(data: DataModel): any[] {\n    return [];\n  }\n  chartDrawn(event) {\n    this.chartDraw.emit(event);\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, Input, ViewEncapsulation} from '@angular/core';\n\n@Component({\n  selector: 'warpview-spinner',\n  templateUrl: './warp-view-spinner.component.html',\n  styleUrls: ['./warp-view-spinner.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewSpinnerComponent {\n  @Input('message') message = 'Loading and parsing data...';\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, EventEmitter, Input, OnInit, Output} from '@angular/core';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-toggle',\n  templateUrl: './warp-view-toggle.component.html',\n  styleUrls: ['./warp-view-toggle.component.scss']\n})\nexport class WarpViewToggleComponent implements OnInit {\n  @Input('checked') set checked(state: boolean) {\n    this.state = state;\n  }\n\n  get checked(): boolean {\n    return this.state;\n  }\n\n  @Input('text1') text1 = '';\n  @Input('text2') text2 = '';\n\n  @Output('stateChange') stateChange = new EventEmitter<any>();\n\n  state = false;\n\n  constructor(public el: ElementRef) {\n  }\n\n  ngOnInit() {\n    this.state = this.checked;\n  }\n\n  switched() {\n    this.state = !this.state;\n    this.stateChange.emit({state: this.state, id: this.el.nativeElement.id});\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport {DataModel} from '../../model/dataModel';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {ColorLib} from '../../utils/color-lib';\nimport moment from 'moment-timezone';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {Timsort} from '../../utils/timsort';\n\n@Component({\n  selector: 'warpview-bar',\n  templateUrl: './warp-view-bar.component.html',\n  styleUrls: ['./warp-view-bar.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewBarComponent extends WarpViewComponent implements OnInit {\n\n  layout: Partial<any> = {\n    showlegend: false,\n    xaxis: {},\n    yaxis: {\n      exponentformat: 'none',\n      fixedrange: true,\n      showline: true\n    },\n    margin: {\n      t: 10,\n      b: 40,\n      r: 10,\n      l: 50\n    }\n  };\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewBarComponent, this._debug);\n  }\n\n  ngOnInit() {\n    this.drawChart();\n  }\n\n  update(options: Param): void {\n    this.drawChart();\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.plotlyConfig.scrollZoom = true;\n    this.buildGraph();\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    let gtsList = [];\n    if (GTSLib.isArray(data.data)) {\n      data.data = GTSLib.flatDeep(data.data as any[]);\n      this.LOG.debug(['convert', 'isArray']);\n      if (data.data.length > 0 && GTSLib.isGts(data.data[0])) {\n        this.LOG.debug(['convert', 'isArray 2']);\n        gtsList = GTSLib.flattenGtsIdArray(data.data as any[], 0).res;\n      } else {\n        this.LOG.debug(['convert', 'isArray 3']);\n        gtsList = data.data as any[];\n      }\n    } else {\n      this.LOG.debug(['convert', 'not array']);\n      gtsList = [data.data];\n    }\n    this.LOG.debug(['convert', 'gtsList'], gtsList);\n    const dataset = [];\n    gtsList.forEach((gts, i) => {\n      this.LOG.debug(['convert', 'gts item'], gts);\n      if (gts.v) {\n        Timsort.sort(gts.v, (a, b) => a[0] - b[0]);\n        const label = GTSLib.serializeGtsMetadata(gts);\n        const c = ColorLib.getColor(gts.id || i, this._options.scheme);\n        const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n        const series: Partial<any> = {\n          type: 'bar',\n          mode: 'lines+markers',\n          name: label,\n          text: label,\n          orientation: this._options.horizontal ? 'h' : 'v',\n          x: [],\n          y: [],\n          hoverinfo: 'none',\n          marker: {\n            color: ColorLib.transparentize(color),\n            line: {\n              color,\n              width: 1\n            }\n          }\n        };\n        gts.v.forEach(value => {\n          const ts = value[0];\n          if (!this._options.horizontal) {\n            series.y.push(value[value.length - 1]);\n            if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n              series.x.push(ts);\n            } else {\n              series.x.push(moment.tz(moment.utc(ts / this.divider), this._options.timeZone).toISOString());\n            }\n          } else {\n            series.x.push(value[value.length - 1]);\n            if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n              series.y.push(ts);\n            } else {\n              series.y.push(moment.tz(moment.utc(ts / this.divider), this._options.timeZone).toISOString());\n            }\n          }\n        });\n        dataset.push(series);\n      } else {\n        this._options.timeMode = 'custom';\n        this.LOG.debug(['convert', 'gts'], gts);\n        (gts.columns || []).forEach((label, index) => {\n          const c = ColorLib.getColor(gts.id || index, this._options.scheme);\n          const color = ((data.params || [])[index] || {datasetColor: c}).datasetColor || c;\n          const series: Partial<any> = {\n            type: 'bar',\n            mode: 'lines+markers',\n            name: label,\n            text: label,\n            orientation: this._options.horizontal ? 'h' : 'v',\n            x: [],\n            y: [],\n            hoverinfo: 'none',\n            marker: {\n              color: ColorLib.transparentize(color),\n              line: {\n                color,\n                width: 1\n              }\n            }\n          };\n          if (this._options.horizontal) {\n            (gts.rows || []).forEach(r => {\n              series.y.unshift(r[0]);\n              series.x.push(r[index + 1]);\n            });\n          } else {\n            (gts.rows || []).forEach(r => {\n              series.x.push(r[0]);\n              series.y.push(r[index + 1]);\n            });\n          }\n          dataset.push(series);\n        });\n      }\n    });\n    this.LOG.debug(['convert', 'dataset'], dataset, this._options.horizontal);\n    return dataset;\n  }\n\n  private buildGraph() {\n    this.LOG.debug(['buildGraph', 'this.layout'], this.responsive);\n    this.LOG.debug(['buildGraph', 'this.layout'], this.layout);\n    this.LOG.debug(['buildGraph', 'this.plotlyConfig'], this.plotlyConfig);\n    this.layout.showlegend = this._showLegend;\n    this.layout.barmode = this._options.stacked ? 'stack' : 'group';\n    this.layout.yaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.color = this.getGridColor(this.el.nativeElement);\n    this.loading = false;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport {DataModel} from '../../model/dataModel';\nimport {ColorLib} from '../../utils/color-lib';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {GTSLib} from '../../utils/gts.lib';\nimport moment from 'moment-timezone';\n\n@Component({\n  selector: 'warpview-bubble',\n  templateUrl: './warp-view-bubble.component.html',\n  styleUrls: ['./warp-view-bubble.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewBubbleComponent extends WarpViewComponent implements OnInit {\n\n  layout: Partial<any> = {\n    showlegend: false,\n    xaxis: {},\n    hovermode: 'closest',\n    hoverdistance: 20,\n    yaxis: {},\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 50\n    }\n  };\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewBubbleComponent, this._debug);\n  }\n\n  ngOnInit() {\n    this.drawChart();\n  }\n\n  update(options: Param): void {\n    this.drawChart();\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.plotlyConfig.scrollZoom = true;\n    this.buildGraph();\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const dataset = [];\n    GTSLib.flatDeep(data.data as any []).forEach((gts, i) => {\n      const label = Object.keys(gts)[0];\n      const c = ColorLib.getColor(gts.id || i, this._options.scheme);\n      const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n      const series: Partial<any> = {\n        type: 'scattergl',\n        mode: 'markers',\n        name: label,\n        text: label,\n        x: [],\n        y: [],\n        hoverinfo: 'none',\n        marker: {\n          color: ColorLib.transparentize(color),\n          line: {\n            color\n          },\n          size: []\n        }\n      };\n      if (GTSLib.isGts(gts)) {\n        const ticks = gts.v.map(t => t[0]);\n        const values = gts.v.map(t => t[t.length - 1]);\n        const sizes = new Array(gts.v.length).fill(10);\n        if (this._options.timeMode === 'timestamp') {\n          series.x = ticks;\n        } else {\n          if (this._options.timeZone !== 'UTC') {\n            series.x = ticks.map(t => moment.utc(t / this.divider).tz(this._options.timeZone).toISOString());\n          } else {\n            series.x = ticks.map(t => moment.utc(t / this.divider).toISOString());\n          }\n        }\n        series.y = values;\n        series.marker.size = sizes;\n      } else {\n        gts[label].forEach(value => {\n          series.y.push(value[0]);\n          series.x.push(value[1]);\n          series.marker.size.push(value[2]);\n        });\n      }\n      dataset.push(series);\n    });\n    this.noData = dataset.length === 0;\n    this.LOG.debug(['convert', 'dataset'], dataset);\n    return dataset;\n  }\n\n  private buildGraph() {\n    this.LOG.debug(['drawChart', 'this.responsive'], this._responsive);\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.layout.showlegend = this.showLegend;\n    this.layout.yaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.color = this.getGridColor(this.el.nativeElement);\n    this.loading = false;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, Input, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {DataModel} from '../../model/dataModel';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport moment from 'moment-timezone';\n\n@Component({\n  selector: 'warpview-datagrid',\n  templateUrl: './warp-view-datagrid.component.html',\n  styleUrls: ['./warp-view-datagrid.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewDatagridComponent extends WarpViewComponent implements OnInit {\n\n\n  @Input('elemsCount') elemsCount = 15;\n\n  // tslint:disable-next-line:variable-name\n  _tabularData: { name: string, values: any[], headers: string[] }[] = [];\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewDatagridComponent, this._debug);\n  }\n\n  ngOnInit() {\n    this.drawChart();\n  }\n\n  update(options: Param): void {\n    this.drawChart();\n  }\n\n  private drawChart() {\n    this.loading = false;\n    this.chartDraw.emit();\n    if (!this.initChart(this.el)) {\n      return;\n    }\n  }\n\n  private getHeaderParam(i: number, j: number, key: string, def: string): string {\n    return this._data.params && this._data.params[i] && this._data.params[i][key] && this._data.params[i][key][j]\n      ? this._data.params[i][key][j]\n      : this._data.globalParams && this._data.globalParams[key] && this._data.globalParams[key][j]\n        ? this._data.globalParams[key][j]\n        : def;\n  }\n\n  protected convert(data: DataModel): any[] {\n    if (GTSLib.isArray(data.data)) {\n      const dataList = GTSLib.flatDeep(this._data.data as any[]);\n      this.LOG.debug(['convert', 'isArray'], dataList);\n      if (data.data.length > 0 && GTSLib.isGts(dataList[0])) {\n        this._tabularData = this.parseData(dataList);\n      } else {\n        this._tabularData = this.parseCustomData(dataList);\n      }\n    } else {\n      this._tabularData = this.parseCustomData([data.data as any]);\n    }\n    return [];\n  }\n\n  private parseCustomData(data: any[]): { name: string, values: any[], headers: string[] }[] {\n    const flatData: { name: string, values: any[], headers: string[] }[] = [];\n    data.forEach(d => {\n      const dataSet: { name: string, values: any[], headers: string[] } = {\n        name: d.title || '',\n        values: d.rows,\n        headers: d.columns,\n      };\n      flatData.push(dataSet);\n    });\n    this.LOG.debug(['parseCustomData', 'flatData'], flatData);\n    return flatData;\n  }\n\n  protected parseData(data: any[]): { name: string, values: any[], headers: string[] }[] {\n    const flatData: { name: string, values: any[], headers: string[] }[] = [];\n    this.LOG.debug(['parseData'], data);\n    data.forEach((d, i) => {\n      const dataSet: { name: string, values: any[], headers: string[] } = {\n        name: '',\n        values: [],\n        headers: []\n      };\n      if (GTSLib.isGts(d)) {\n        this.LOG.debug(['parseData', 'isGts'], d);\n        dataSet.name = GTSLib.serializeGtsMetadata(d);\n        dataSet.values = d.v.map(v => [this.formatDate(v[0])].concat(v.slice(1, v.length)));\n      } else {\n        this.LOG.debug(['parseData', 'is not a Gts'], d);\n        dataSet.values = GTSLib.isArray(d) ? d : [d];\n      }\n      dataSet.headers = [this.getHeaderParam(i, 0, 'headers', 'Date')];\n      if (d.v && d.v.length > 0 && d.v[0].length > 2) {\n        dataSet.headers.push(this.getHeaderParam(i, 1, 'headers', 'Latitude'));\n      }\n      if (d.v && d.v.length > 0 && d.v[0].length > 3) {\n        dataSet.headers.push(this.getHeaderParam(i, 2, 'headers', 'Longitude'));\n      }\n      if (d.v && d.v.length > 0 && d.v[0].length > 4) {\n        dataSet.headers.push(this.getHeaderParam(i, 3, 'headers', 'Elevation'));\n      }\n      if (d.v && d.v.length > 0) {\n        dataSet.headers.push(this.getHeaderParam(i, d.v[0].length - 1, 'headers', 'Value'));\n      }\n      if (dataSet.values.length > 0) {\n        flatData.push(dataSet);\n      }\n    });\n    this.LOG.debug(['parseData', 'flatData'], flatData, this._options.timeMode);\n    return flatData;\n  }\n\n  formatDate(date: number): string {\n    return this._options.timeMode === 'date' ? moment.tz(date / this.divider, this._options.timeZone).toISOString() : date.toString();\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, Input, OnInit, ViewEncapsulation} from '@angular/core';\nimport {Logger} from '../../../utils/logger';\nimport {Param} from '../../../model/param';\nimport {ChartLib} from '../../../utils/chart-lib';\nimport deepEqual from 'deep-equal';\nimport {GTSLib} from '../../../utils/gts.lib';\n\n@Component({\n  selector: 'warpview-paginable',\n  templateUrl: './warp-view-paginable.component.html',\n  styleUrls: ['./warp-view-paginable.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewPaginableComponent implements OnInit {\n  constructor() {\n    this.LOG = new Logger(WarpViewPaginableComponent, this.debug);\n  }\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Input('options') set options(options: Param) {\n    if (!deepEqual(options, this._options)) {\n      this.drawGridData();\n    }\n  }\n\n  @Input('data') set data(data: { name: string, values: any[], headers: string[] }) {\n    if (data) {\n      this._data = data;\n      this.drawGridData();\n    }\n  }\n\n  @Input('elemsCount') elemsCount = 15;\n  @Input('windowed') windowed = 5;\n\n  page = 0;\n  pages: number[] = [];\n  // tslint:disable-next-line:variable-name\n  _data: { name: string, values: any[], headers: string[] };\n  displayedValues: any[] = [];\n  private LOG: Logger;\n  // tslint:disable-next-line:variable-name\n  private _debug = false;\n  // tslint:disable-next-line:variable-name\n  private _options: Param = {\n    ...new Param(), ...{\n      timeMode: 'date',\n      timeZone: 'UTC',\n      timeUnit: 'us',\n      bounds: {}\n    }\n  };\n\n  goto(page: number) {\n    this.page = page;\n    this.drawGridData();\n  }\n\n  next() {\n    this.page = Math.min(this.page + 1, this._data.values.length - 1);\n    this.drawGridData();\n  }\n\n  prev() {\n    this.page = Math.max(this.page - 1, 0);\n    this.drawGridData();\n  }\n\n  private drawGridData() {\n    this._options = ChartLib.mergeDeep(this._options, this.options) as Param;\n    this.LOG.debug(['drawGridData', '_options'], this._options);\n    if (!this._data) {\n      return;\n    }\n    this.pages = [];\n    for (let i = 0; i < (this._data.values ||[] ).length / this.elemsCount; i++) {\n      this.pages.push(i);\n    }\n    this.displayedValues = (this._data.values ||[] ).slice(\n      Math.max(0, this.elemsCount * this.page),\n      Math.min(this.elemsCount * (this.page + 1), (this._data.values ||[] ).length)\n    );\n    this.LOG.debug(['drawGridData', '_data'], this._data);\n  }\n\n  decodeURIComponent(str: string): string {\n    return decodeURIComponent(str);\n  }\n\n  ngOnInit() {\n    this.drawGridData();\n  }\n\n  formatLabel(name: string) {\n    return GTSLib.formatLabel(name);\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, NgZone, OnDestroy, OnInit, Renderer2, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {DataModel} from '../../model/dataModel';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport fitty, {FittyInstance} from 'fitty';\nimport moment from 'moment-timezone';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-display',\n  templateUrl: './warp-view-display.component.html',\n  styleUrls: ['./warp-view-display.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewDisplayComponent extends WarpViewComponent implements OnInit, OnDestroy {\n  @ViewChild('wrapper', {static: true}) wrapper: ElementRef;\n  toDisplay = '';\n  defOptions = {\n    timeMode: 'custom'\n  } as Param;\n\n  private fitties: FittyInstance;\n  private timer;\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewDisplayComponent, this._debug);\n  }\n\n  ngOnInit() {\n    this.drawChart();\n  }\n\n  ngOnDestroy(): void {\n    if (this.timer) {\n      clearInterval(this.timer);\n    }\n  }\n\n  update(options: Param, refresh: boolean): void {\n    this.drawChart();\n    this.flexFont();\n  }\n\n  private drawChart() {\n    this.LOG.debug(['drawChart'], this._options, this.defOptions);\n    this.initChart(this.el);\n    this._options = ChartLib.mergeDeep(this.defOptions, this._options);\n    this.LOG.debug(['drawChart', 'afterInit'], this._options, this.defOptions, this.height);\n    this.LOG.debug(['drawChart'], this._data, this.toDisplay);\n    this.flexFont();\n    this.chartDraw.emit();\n  }\n\n  protected convert(data: DataModel): any[] {\n    this._options = ChartLib.mergeDeep(this.defOptions, this._options);\n    this.LOG.debug(['convert'], this._options.timeMode);\n    let display: string;\n    if (this._data.data) {\n      display = GTSLib.isArray(this._data.data) ? this._data.data[0] : this._data.data;\n    } else {\n      display = GTSLib.isArray(this._data) ? this._data[0] : this._data;\n    }\n    switch (this._options.timeMode) {\n      case 'date':\n        this.toDisplay = moment.tz(parseInt(display, 10) / this.divider, this._options.timeZone).toISOString(true);\n        break;\n      case 'duration':\n        const start = moment.tz(parseInt(display, 10) / this.divider, this._options.timeZone);\n        this.displayDuration(start);\n        break;\n      case 'custom':\n      case 'timestamp':\n        this.toDisplay = display;\n    }\n    return [];\n  }\n\n  getStyle() {\n    if (!this._options) {\n      return {};\n    } else {\n      const style: any = {'background-color': this._options.bgColor || 'transparent'};\n      if (this._options.fontColor) {\n        style.color = this._options.fontColor;\n      }\n      return style;\n    }\n  }\n\n  flexFont() {\n    if (!!this.wrapper) {\n      this.LOG.debug(['flexFont'], this.height);\n      if (this.fitties) {\n        this.fitties.unsubscribe();\n      }\n      this.fitties = fitty(this.wrapper.nativeElement, {\n        maxSize: (this.el.nativeElement as HTMLElement).parentElement.clientHeight * 0.80,\n        minSize: 14\n      });\n      this.LOG.debug(['flexFont'], 'ok', (this.el.nativeElement as HTMLElement).parentElement.clientHeight);\n      this.fitties.fit();\n      this.loading = false;\n    }\n  }\n\n  private displayDuration(start: any) {\n    this.timer = setInterval(() => {\n      const now = moment();\n      this.toDisplay = moment.duration(start.diff(now)).humanize(true);\n    }, 1000);\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {AfterViewInit, Component, ElementRef, HostListener, NgZone, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport moment from 'moment';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {ColorLib} from '../../utils/color-lib';\nimport {DataModel} from '../../model/dataModel';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-drill-down',\n  templateUrl: './warp-view-drill-down.component.html',\n  styleUrls: ['./warp-view-drill-down.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewDrillDownComponent extends WarpViewComponent implements AfterViewInit {\n\n  heatMapData: any;\n  private parentWidth = -1;\n  private resizeTimer;\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewDrillDownComponent, this._debug);\n  }\n\n  ngAfterViewInit() {\n    this.drawChart();\n  }\n\n  update(options: Param, refresh: boolean): void {\n    this.drawChart();\n  }\n\n  @HostListener('window:resize')\n  onResize() {\n    if (this.el.nativeElement.parentElement.clientWidth !== this.parentWidth || this.parentWidth <= 0) {\n      this.parentWidth = this.el.nativeElement.parentElement.clientWidth;\n      clearTimeout(this.resizeTimer);\n      this.resizeTimer = setTimeout(() => {\n        if (this.el.nativeElement.parentElement.clientWidth > 0) {\n          this.LOG.debug(['onResize'], this.el.nativeElement.parentElement.clientWidth);\n          this.drawChart();\n        } else {\n          this.onResize();\n        }\n      }, 150);\n    }\n  }\n\n  private drawChart() {\n    this.loading = false;\n    this.chartDraw.emit();\n    if (!this.initChart(this.el)) {\n      return;\n    }\n  }\n\n  protected convert(data: DataModel): any[] {\n    const dataList = this._data.data as any[];\n    this.heatMapData = this.parseData(GTSLib.flatDeep(dataList));\n    return [];\n  }\n\n  private parseData(dataList: any[]) {\n    const details = [];\n    const values = [];\n    const dates = [];\n    const data = {};\n    const reducer = (accumulator, currentValue) => accumulator + parseInt(currentValue, 10);\n    this.LOG.debug(['parseData'], dataList);\n    dataList.forEach((gts, i) => {\n      const name = GTSLib.serializeGtsMetadata(gts);\n      gts.v.forEach(v => {\n        const refDate = moment.utc(v[0] / 1000).startOf('day').toISOString();\n        if (!data[refDate]) {\n          data[refDate] = [];\n        }\n        if (!values[refDate]) {\n          values[refDate] = [];\n        }\n        dates.push(v[0] / 1000);\n        values[refDate].push(v[v.length - 1]);\n        data[refDate].push({\n          name,\n          date: v[0] / 1000,\n          value: v[v.length - 1],\n          color: ColorLib.getColor(i, this._options.scheme),\n          id: i\n        });\n      });\n    });\n    Object.keys(data).forEach((d: string) => {\n      details.push({\n        date: moment.utc(d),\n        total: values[d].reduce(reducer),\n        details: data[d],\n        summary: []\n      });\n    });\n    return details;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Moment} from 'moment';\n\n/**\n *\n */\nexport class Datum {\n  date: Moment;\n  summary?: Summary[];\n  total?: number;\n  details?: Detail[];\n}\n\n/**\n *\n */\nexport class Summary {\n  color?: string;\n  id?: number;\n  name: string;\n  total: number;\n  date?: Moment;\n}\n\n/**\n *\n */\nexport class Detail {\n  color?: string;\n  date: number;\n  id: number;\n  name: string;\n  value: number;\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\nimport {AfterViewInit, Component, ElementRef, EventEmitter, HostListener, Input, Output, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {Logger} from '../../../utils/logger';\nimport {Datum, Detail, Summary} from '../model/datum';\nimport {ChartLib} from '../../../utils/chart-lib';\nimport {easeLinear, max, range, scaleBand, scaleLinear, Selection, sum, timeDays} from 'd3';\nimport {event, select} from 'd3-selection';\nimport {ColorLib} from '../../../utils/color-lib';\nimport {GTSLib} from '../../../utils/gts.lib';\nimport moment, {Moment} from 'moment';\n\n@Component({\n  selector: 'calendar-heatmap',\n  templateUrl: './calendar-heatmap.component.html',\n  styleUrls: ['./calendar-heatmap.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class CalendarHeatmapComponent implements AfterViewInit {\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Input('data') set data(data: Datum[]) {\n    this.LOG.debug(['data'], data);\n    if (data) {\n      this._data = data;\n      this.calculateDimensions();\n    }\n  }\n\n  get data(): Datum[] {\n    return this._data;\n  }\n\n  @Input('minColor') set minColor(minColor: string) {\n    this._minColor = minColor;\n    this.calculateDimensions();\n  }\n\n  get minColor() {\n    return this._minColor;\n  }\n\n  @Input('maxColor') set maxColor(maxColor: string) {\n    this._maxColor = maxColor;\n    this.calculateDimensions();\n  }\n\n  get maxColor() {\n    return this._maxColor;\n  }\n\n  private static DEF_MIN_COLOR = '#ffffff';\n  private static DEF_MAX_COLOR = '#333333';\n\n  constructor(private el: ElementRef) {\n    this.LOG = new Logger(CalendarHeatmapComponent, this.debug);\n  }\n\n\n  @ViewChild('chart', {static: true}) div: ElementRef;\n\n  @Input('width') width = ChartLib.DEFAULT_WIDTH;\n  @Input('height') height = ChartLib.DEFAULT_HEIGHT;\n  @Input('overview') overview = 'global';\n\n  @Output('handler') handler = new EventEmitter<any>();\n  @Output('change') change = new EventEmitter<any>();\n\n  private LOG: Logger;\n  // tslint:disable-next-line:variable-name\n  private _data: Datum[];\n  // tslint:disable-next-line:variable-name\n  private _debug = false;\n  // tslint:disable-next-line:variable-name\n  private _minColor: string = CalendarHeatmapComponent.DEF_MIN_COLOR;\n  // tslint:disable-next-line:variable-name\n  private _maxColor: string = CalendarHeatmapComponent.DEF_MAX_COLOR;\n// Defaults\n  private gutter = 5;\n  private gWidth = 1000;\n  private gHeight = 200;\n  private itemSize = 10;\n  private labelPadding = 40;\n  private transitionDuration = 250;\n  private inTransition = false;\n  // Tooltip defaults\n  private tooltipWidth = 450;\n  private tooltipPadding = 15;\n  // Overview defaults\n  private history = ['global'];\n  private selected: Datum = new Datum();\n  // D3 related variables\n  private svg: Selection<SVGElement, {}, null, undefined>;\n  private items: Selection<SVGElement, {}, null, undefined>;\n  private labels: Selection<SVGElement, {}, null, undefined>;\n  private buttons: Selection<SVGElement, {}, null, undefined>;\n  private tooltip: Selection<HTMLDivElement, {}, null, undefined>;\n  private parentWidth = -1;\n  private chart: HTMLElement;\n  private resizeTimer;\n\n  static getNumberOfWeeks(): number {\n    const dayIndex = Math.round((+moment.utc() - +moment.utc().subtract(1, 'year').startOf('week')) / 86400000);\n    return Math.trunc(dayIndex / 7) + 1;\n  }\n\n  @HostListener('window:resize')\n  onResize() {\n    if (this.el.nativeElement.parentElement.clientWidth !== this.parentWidth) {\n      this.calculateDimensions();\n    }\n  }\n\n  ngAfterViewInit() {\n    this.chart = this.div.nativeElement as HTMLElement;\n    // Initialize svg element\n    this.svg = select(this.chart).append('svg').attr('class', 'svg');\n    // Initialize main svg elements\n    this.items = this.svg.append('g');\n    this.labels = this.svg.append('g');\n    this.buttons = this.svg.append('g');\n    // Add tooltip to the same element as main svg\n    this.tooltip = select(this.chart)\n      .append('div')\n      .attr('class', 'heatmap-tooltip')\n      .style('opacity', 0);\n    // Calculate chart dimensions\n    this.calculateDimensions();\n    //  this.drawChart();\n  }\n\n  calculateDimensions() {\n    clearTimeout(this.resizeTimer);\n    this.resizeTimer = setTimeout(() => {\n      if (this.el.nativeElement.parentElement.clientWidth !== 0) {\n        this.gWidth = this.chart.clientWidth < 1000 ? 1000 : this.chart.clientWidth;\n        this.itemSize = ((this.gWidth - this.labelPadding) / CalendarHeatmapComponent.getNumberOfWeeks() - this.gutter);\n        this.gHeight = this.labelPadding + 7 * (this.itemSize + this.gutter);\n        this.svg.attr('width', this.gWidth).attr('height', this.gHeight);\n        this.LOG.debug(['calculateDimensions'], this._data);\n        if (!!this._data && !!this._data[0] && !!this._data[0].summary) {\n          this.drawChart();\n        }\n      } else {\n        this.calculateDimensions();\n      }\n    }, 250);\n  }\n\n\n  private groupBy(xs, key) {\n    return xs.reduce((rv, x) => {\n      (rv[x[key]] = rv[x[key]] || []).push(x);\n      return rv;\n    }, {});\n  }\n\n  updateDataSummary() {\n    // Get daily summary if that was not provided\n    if (!this._data[0].summary) {\n      this._data.map((d: Datum) => {\n        const summary = d.details.reduce((uniques: any, project: any) => {\n          if (!uniques[project.name]) {\n            uniques[project.name] = {value: project.value};\n          } else {\n            uniques[project.name].value += project.value;\n          }\n          return uniques;\n        }, {});\n        const unsortedSummary = Object.keys(summary).map((key) => {\n          return {\n            name: key,\n            total: summary[key].value\n          };\n        });\n        d.summary = unsortedSummary.sort((a, b) => {\n          return b.total - a.total;\n        });\n        return d;\n      });\n    }\n  }\n\n  drawChart() {\n    if (!this.svg || !this._data) {\n      return;\n    }\n    this.LOG.debug(['drawChart'], [this.overview, this.selected]);\n    switch (this.overview) {\n      case 'global':\n        this.drawGlobalOverview();\n        this.change.emit({\n          overview: this.overview,\n          start: moment(this._data[0].date),\n          end: moment(this._data[this._data.length - 1].date),\n        });\n        break;\n      case 'year':\n        this.drawYearOverview();\n        this.change.emit({\n          overview: this.overview,\n          start: moment(this.selected.date).startOf('year'),\n          end: moment(this.selected.date).endOf('year'),\n        });\n        break;\n      case 'month':\n        this.drawMonthOverview();\n        this.change.emit({\n          overview: this.overview,\n          start: moment(this.selected.date).startOf('month'),\n          end: moment(this.selected.date).endOf('month'),\n        });\n        break;\n      case 'week':\n        this.drawWeekOverview();\n        this.change.emit({\n          overview: this.overview,\n          start: moment(this.selected.date).startOf('week'),\n          end: moment(this.selected.date).endOf('week'),\n        });\n        break;\n      case 'day':\n        this.drawDayOverview();\n        this.change.emit({\n          overview: this.overview,\n          start: moment(this.selected.date).startOf('day'),\n          end: moment(this.selected.date).endOf('day'),\n        });\n        break;\n      default:\n        break;\n    }\n  }\n\n  drawGlobalOverview() {\n    // Add current overview to the history\n    if (this.history[this.history.length - 1] !== this.overview) {\n      this.history.push(this.overview);\n    }\n    // Define start and end of the dataset\n    const startPeriod: Moment = moment.utc(this._data[0].date.startOf('y'));\n    const endPeriod: Moment = moment.utc(this._data[this._data.length - 1].date.endOf('y'));\n    // Define array of years and total values\n    const yData: Datum[] = this._data.filter((d: Datum) => d.date.isBetween(startPeriod, endPeriod, null, '[]'));\n    yData.forEach((d: Datum) => {\n      const summary: Summary[] = [];\n      const group = this.groupBy(d.details, 'name');\n      Object.keys(group).forEach(k => {\n        summary.push({\n          name: k,\n          total: group[k].reduce((acc, o) => {\n            return acc + o.value;\n          }, 0),\n          color: group[k][0].color,\n          id: group[k][0].id,\n        });\n      });\n      d.summary = summary;\n    });\n    const duration = Math.ceil(moment.duration(endPeriod.diff(startPeriod)).asYears());\n    const scale = [];\n    for (let i = 0; i < duration; i++) {\n      const d = moment.utc().year(startPeriod.year() + i).month(0).date(1).startOf('y');\n      scale.push(d);\n    }\n    let yearData: Datum[] = yData.map((d: Datum) => {\n      const date: Moment = d.date;\n      return {\n        date,\n        total: yData.reduce((prev: number, current: any) => {\n          if ((current.date as Moment).year() === date.year()) {\n            prev += current.total;\n          }\n          return prev;\n        }, 0),\n        summary: (() => {\n          const summary: Summary = yData.reduce((s: any, data: any) => {\n            if ((data.date as Moment).year() === date.year()) {\n              data.summary.forEach(_summary => {\n                if (!s[_summary.name]) {\n                  s[_summary.name] = {\n                    total: _summary.total,\n                    color: _summary.color,\n                  };\n                } else {\n                  s[_summary.name].total += _summary.total;\n                }\n              });\n            }\n            return s;\n          }, {});\n          const unsortedSummary: Summary[] = Object.keys(summary).map((key) => {\n            return {\n              name: key,\n              total: summary[key].total,\n              color: summary[key].color,\n            };\n          });\n          return unsortedSummary.sort((a, b) => b.total - a.total);\n        })(),\n      };\n    });\n    // Calculate max value of all the years in the dataset\n    yearData = GTSLib.cleanArray(yearData);\n    const maxValue = max(yearData, (d: Datum) => d.total);\n    // Define year labels and axis\n    const yearLabels = scale.map((d: Moment) => d);\n    const yearScale = scaleBand()\n      .rangeRound([0, this.gWidth])\n      .padding(0.05)\n      .domain(yearLabels.map((d: Moment) => d.year().toString()));\n\n    const color = scaleLinear<string>()\n      .range([this.minColor || CalendarHeatmapComponent.DEF_MIN_COLOR, this.maxColor || CalendarHeatmapComponent.DEF_MAX_COLOR])\n      .domain([-0.15 * maxValue, maxValue]);\n    // Add global data items to the overview\n    this.items.selectAll('.item-block-year').remove();\n    this.items.selectAll('.item-block-year')\n      .data(yearData)\n      .enter()\n      .append('rect')\n      .attr('class', 'item item-block-year')\n      .attr('width', () => (this.gWidth - this.labelPadding) / yearLabels.length - this.gutter * 5)\n      .attr('height', () => this.gHeight - this.labelPadding)\n      .attr('transform', (d: Datum) => 'translate(' + yearScale((d.date as Moment).year().toString()) + ',' + this.tooltipPadding * 2 + ')')\n      .attr('fill', (d: Datum) => color(d.total) || CalendarHeatmapComponent.DEF_MAX_COLOR)\n      .on('click', (d: Datum) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Set in_transition flag\n        this.inTransition = true;\n        // Set selected date to the one clicked on\n        this.selected = d;\n        // Hide tooltip\n        this.hideTooltip();\n        // Remove all global overview related items and labels\n        this.removeGlobalOverview();\n        // Redraw the chart\n        this.overview = 'year';\n        this.drawChart();\n      })\n      .style('opacity', 0)\n      .on('mouseover', (d: Datum) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Calculate tooltip position\n        let x = yearScale(d.date.year().toString()) + this.tooltipPadding * 2;\n        while (this.gWidth - x < (this.tooltipWidth + this.tooltipPadding * 5)) {\n          x -= 10;\n        }\n        const y = this.tooltipPadding * 4;\n        // Show tooltip\n        this.tooltip.html(this.getTooltip(d))\n          .style('left', x + 'px')\n          .style('top', y + 'px')\n          .transition()\n          .duration(this.transitionDuration / 2)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.hideTooltip();\n      })\n      .transition()\n      .delay((d: any, i: number) => this.transitionDuration * (i + 1) / 10)\n      .duration(() => this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 1)\n      .call((transition: any, callback: any) => {\n        if (transition.empty()) {\n          callback();\n        }\n        let n = 0;\n        transition.each(() => ++n).on('end', function() {\n          if (!--n) {\n            callback.apply(this, arguments);\n          }\n        });\n      }, () => this.inTransition = false);\n    // Add year labels\n    this.labels.selectAll('.label-year').remove();\n    this.labels.selectAll('.label-year')\n      .data(yearLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-year')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: Moment) => d.year())\n      .attr('x', (d: Moment) => yearScale(d.year().toString()))\n      .attr('y', this.labelPadding / 2)\n      .on('mouseenter', (yearLabel: Moment) => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-year')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (d: Datum) => (d.date.year() === yearLabel.year()) ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-year')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      })\n      .on('click', () => {\n        if (this.inTransition) {\n          return;\n        }\n        // Set in_transition flag\n        this.inTransition = true;\n        // Set selected year to the one clicked on\n        this.selected = yearData[0];\n        // Hide tooltip\n        this.hideTooltip();\n        // Remove all global overview related items and labels\n        this.removeGlobalOverview();\n        // Redraw the chart\n        this.overview = 'year';\n        this.drawChart();\n      });\n  }\n\n\n  /**\n   * Draw year overview\n   */\n  drawYearOverview() {\n    // Add current overview to the history\n    if (this.history[this.history.length - 1] !== this.overview) {\n      this.history.push(this.overview);\n    }\n    // Define start and end date of the selected year\n    const startOfYear: Moment = moment(this.selected.date).startOf('year');\n    const endOfYear: Moment = moment(this.selected.date).endOf('year');\n    // Filter data down to the selected year\n    let yearData: Datum[] = this._data.filter((d: Datum) => d.date.isBetween(startOfYear, endOfYear, null, '[]'));\n    yearData.forEach((d: Datum) => {\n      const summary: Summary[] = [];\n      const group = this.groupBy(d.details, 'name');\n      Object.keys(group).forEach(k => {\n        summary.push({\n          name: k,\n          total: group[k].reduce((acc, o) => {\n            return acc + o.value;\n          }, 0),\n          color: group[k][0].color,\n          id: group[k][0].id,\n        });\n      });\n      d.summary = summary;\n    });\n    yearData = GTSLib.cleanArray(yearData);\n    // Calculate max value of the year data\n    const maxValue = max(yearData, (d: Datum) => d.total);\n    const color = scaleLinear<string>()\n      .range([this.minColor || CalendarHeatmapComponent.DEF_MIN_COLOR, this.maxColor || CalendarHeatmapComponent.DEF_MAX_COLOR])\n      .domain([-0.15 * maxValue, maxValue]);\n    this.items.selectAll('.item-circle').remove();\n    this.items.selectAll('.item-circle')\n      .data(yearData)\n      .enter()\n      .append('rect')\n      .attr('class', 'item item-circle').style('opacity', 0)\n      .attr('x', (d: Datum) => this.calcItemX(d, startOfYear) + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n      .attr('y', (d: Datum) => this.calcItemY(d) + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n      .attr('rx', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('ry', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('width', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('height', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('fill', (d: Datum) => (d.total > 0) ? color(d.total) : 'transparent')\n      .on('click', (d: Datum) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Don't transition if there is no data to show\n        if (d.total === 0) {\n          return;\n        }\n        this.inTransition = true;\n        // Set selected date to the one clicked on\n        this.selected = d;\n        // Hide tooltip\n        this.hideTooltip();\n        // Remove all year overview related items and labels\n        this.removeYearOverview();\n        // Redraw the chart\n        this.overview = 'day';\n        this.drawChart();\n      })\n      .on('mouseover', (d: Datum) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Pulsating animation\n        const circle = select(event.currentTarget);\n        const repeat = () => {\n          circle.transition()\n            .duration(this.transitionDuration)\n            .ease(easeLinear)\n            .attr('x', (data: Datum) => this.calcItemX(data, startOfYear) - (this.itemSize * 1.1 - this.itemSize) / 2)\n            .attr('y', (data: Datum) => this.calcItemY(data) - (this.itemSize * 1.1 - this.itemSize) / 2)\n            .attr('width', this.itemSize * 1.1)\n            .attr('height', this.itemSize * 1.1)\n            .transition()\n            .duration(this.transitionDuration)\n            .ease(easeLinear)\n            .attr('x', (data: Datum) => this.calcItemX(data, startOfYear) + (this.itemSize - this.calcItemSize(data, maxValue)) / 2)\n            .attr('y', (data: Datum) => this.calcItemY(data) + (this.itemSize - this.calcItemSize(data, maxValue)) / 2)\n            .attr('width', (data: Datum) => this.calcItemSize(data, maxValue))\n            .attr('height', (data: Datum) => this.calcItemSize(data, maxValue))\n            .on('end', repeat);\n        };\n        repeat();\n        // Construct tooltip\n        // Calculate tooltip position\n        let x = this.calcItemX(d, startOfYear) + this.itemSize / 2;\n        if (this.gWidth - x < (this.tooltipWidth + this.tooltipPadding * 3)) {\n          x -= this.tooltipWidth + this.tooltipPadding * 2;\n        }\n        const y = this.calcItemY(d) + this.itemSize / 2;\n        // Show tooltip\n        this.tooltip.html(this.getTooltip(d))\n          .style('left', x + 'px')\n          .style('top', y + 'px')\n          .transition()\n          .duration(this.transitionDuration / 2)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        // Set circle radius back to what it's supposed to be\n        select(event.currentTarget).transition()\n          .duration(this.transitionDuration / 2)\n          .ease(easeLinear)\n          .attr('x', (d: Datum) => this.calcItemX(d, startOfYear) + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n          .attr('y', (d: Datum) => this.calcItemY(d) + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n          .attr('width', (d: Datum) => this.calcItemSize(d, maxValue))\n          .attr('height', (d: Datum) => this.calcItemSize(d, maxValue));\n        // Hide tooltip\n        this.hideTooltip();\n      })\n      .transition()\n      .delay(() => (Math.cos(Math.PI * Math.random()) + 1) * this.transitionDuration)\n      .duration(() => this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 1)\n      .call((transition: any, callback: any) => {\n        if (transition.empty()) {\n          callback();\n        }\n        let n = 0;\n        transition.each(() => ++n).on('end', function() {\n          if (!--n) {\n            callback.apply(this, arguments);\n          }\n        });\n      }, () => this.inTransition = false);\n    // Add month labels\n    const duration = Math.ceil(moment.duration(endOfYear.diff(startOfYear)).asMonths());\n    const monthLabels: Moment[] = [];\n    for (let i = 1; i < duration; i++) {\n      monthLabels.push(moment(this.selected.date).month((startOfYear.month() + i) % 12).startOf('month'));\n    }\n    const monthScale = scaleLinear().range([0, this.gWidth]).domain([0, monthLabels.length]);\n    this.labels.selectAll('.label-month').remove();\n    this.labels.selectAll('.label-month')\n      .data(monthLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-month')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: Moment) => d.format('MMM'))\n      .attr('x', (d: Moment, i: number) => monthScale(i) + (monthScale(i) - monthScale(i - 1)) / 2)\n      .attr('y', this.labelPadding / 2)\n      .on('mouseenter', (d: Moment) => {\n        if (this.inTransition) {\n          return;\n        }\n        const selectedMonth = moment(d);\n        this.items.selectAll('.item-circle')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (data: Datum) => moment(data.date).isSame(selectedMonth, 'month') ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-circle')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      })\n      .on('click', (d: Moment) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Check month data\n        const monthData = this._data.filter((e: Datum) => e.date.isBetween(\n          moment(d).startOf('month'),\n          moment(d).endOf('month'),\n          null, '[]'\n        ));\n        // Don't transition if there is no data to show\n        if (!monthData.length) {\n          return;\n        }\n        // Set selected month to the one clicked on\n        this.selected = {date: d};\n        this.inTransition = true;\n        // Hide tooltip\n        this.hideTooltip();\n        // Remove all year overview related items and labels\n        this.removeYearOverview();\n        // Redraw the chart\n        this.overview = 'month';\n        this.drawChart();\n      });\n\n    // Add day labels\n    const dayLabels: Date[] = timeDays(\n      moment.utc().startOf('week').toDate(),\n      moment.utc().endOf('week').toDate()\n    );\n    const dayScale = scaleBand()\n      .rangeRound([this.labelPadding, this.gHeight])\n      .domain(dayLabels.map((d: Date) => moment.utc(d).weekday().toString()));\n    this.labels.selectAll('.label-day').remove();\n    this.labels.selectAll('.label-day')\n      .data(dayLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-day')\n      .attr('x', this.labelPadding / 3)\n      .attr('y', (d: Date, i: number) => dayScale(i.toString()) + dayScale.bandwidth() / 1.75)\n      .style('text-anchor', 'left')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: Date) => moment.utc(d).format('dddd')[0])\n      .on('mouseenter', (d: Date) => {\n        if (this.inTransition) {\n          return;\n        }\n        const selectedDay = moment.utc(d);\n        this.items.selectAll('.item-circle')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (data: Datum) => (moment(data.date).day() === selectedDay.day()) ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-circle')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      });\n    // Add button to switch back to previous overview\n    this.drawButton();\n  }\n\n  drawMonthOverview() {\n    // Add current overview to the history\n    if (this.history[this.history.length - 1] !== this.overview) {\n      this.history.push(this.overview);\n    }\n    // Define beginning and end of the month\n    const startOfMonth: Moment = moment(this.selected.date).startOf('month');\n    const endOfMonth: Moment = moment(this.selected.date).endOf('month');\n    // Filter data down to the selected month\n    let monthData: Datum[] = [];\n    this._data.filter((data: Datum) => data.date.isBetween(startOfMonth, endOfMonth, null, '[]'))\n      .map((d: Datum) => {\n        const scale: Datum[] = [];\n        d.details.forEach((det: Detail) => {\n          const date: Moment = moment.utc(det.date);\n          const i = Math.floor(date.hours() / 3);\n          if (!scale[i]) {\n            scale[i] = {\n              date: date.startOf('hour'),\n              total: 0,\n              details: [],\n              summary: []\n            };\n          }\n          scale[i].total += det.value;\n          scale[i].details.push(det);\n        });\n        scale.forEach((s: Datum) => {\n          const group = this.groupBy(s.details, 'name');\n          Object.keys(group).forEach((k: string) => {\n            s.summary.push({\n              name: k,\n              total: sum(group[k], (data: any) => data.total),\n              color: group[k][0].color\n            });\n          });\n        });\n        monthData = monthData.concat(scale);\n      });\n    monthData = GTSLib.cleanArray(monthData);\n    this.LOG.debug(['drawMonthOverview'], [this.overview, this.selected, monthData]);\n    const maxValue: number = max(monthData, (d: any) => d.total);\n    // Define day labels and axis\n    const dayLabels: Date[] = timeDays(\n      moment(this.selected.date).startOf('week').toDate(),\n      moment(this.selected.date).endOf('week').toDate()\n    );\n    const dayScale = scaleBand()\n      .rangeRound([this.labelPadding, this.gHeight])\n      .domain(dayLabels.map((d: Date) => moment.utc(d).weekday().toString()));\n\n    // Define week labels and axis\n    const weekLabels: Moment[] = [startOfMonth];\n    const incWeek = moment(startOfMonth);\n    while (incWeek.week() !== endOfMonth.week()) {\n      weekLabels.push(moment(incWeek.add(1, 'week')));\n    }\n    monthData.forEach((d: Datum) => {\n      const summary = [];\n      const group = this.groupBy(d.details, 'name');\n      Object.keys(group).forEach((k: string) => {\n        summary.push({\n          name: k,\n          total: group[k].reduce((acc, o) => acc + o.value, 0),\n          color: group[k][0].color,\n          id: group[k][0].id,\n        });\n      });\n      d.summary = summary;\n    });\n    const weekScale = scaleBand()\n      .rangeRound([this.labelPadding, this.gWidth])\n      .padding(0.05)\n      .domain(weekLabels.map((weekday) => weekday.week() + ''));\n    const color = scaleLinear<string>()\n      .range([this.minColor || CalendarHeatmapComponent.DEF_MIN_COLOR, this.maxColor || CalendarHeatmapComponent.DEF_MAX_COLOR])\n      .domain([-0.15 * maxValue, maxValue]);\n    // Add month data items to the overview\n    this.items.selectAll('.item-block-month').remove();\n    this.items.selectAll('.item-block-month')\n      .data(monthData)\n      .enter().append('rect')\n      .style('opacity', 0)\n      .attr('class', 'item item-block-month')\n      .attr('y', (d: Datum) => this.calcItemY(d)\n        + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n      .attr('x', (d: Datum) => this.calcItemXMonth(d, startOfMonth, weekScale(d.date.week().toString()))\n        + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n      .attr('rx', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('ry', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('width', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('height', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('fill', (d: Datum) => (d.total > 0) ? color(d.total) : 'transparent')\n      .on('click', (d: Datum) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Don't transition if there is no data to show\n        if (d.total === 0) {\n          return;\n        }\n        this.inTransition = true;\n        // Set selected date to the one clicked on\n        this.selected = d;\n        // Hide tooltip\n        this.hideTooltip();\n        // Remove all month overview related items and labels\n        this.removeMonthOverview();\n        // Redraw the chart\n        this.overview = 'day';\n        this.drawChart();\n      })\n      .on('mouseover', (d: Datum) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Construct tooltip\n        // Calculate tooltip position\n        let x = weekScale(d.date.week().toString()) + this.tooltipPadding;\n        while (this.gWidth - x < (this.tooltipWidth + this.tooltipPadding * 3)) {\n          x -= 10;\n        }\n        const y = dayScale(d.date.weekday().toString()) + this.tooltipPadding;\n        // Show tooltip\n        this.tooltip.html(this.getTooltip(d))\n          .style('left', x + 'px')\n          .style('top', y + 'px')\n          .transition()\n          .duration(this.transitionDuration / 2)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.hideTooltip();\n      })\n      .transition()\n      .delay(() => (Math.cos(Math.PI * Math.random()) + 1) * this.transitionDuration)\n      .duration(() => this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 1)\n      .call((transition: any, callback: any) => {\n        if (transition.empty()) {\n          callback();\n        }\n        let n = 0;\n        transition.each(() => ++n).on('end', function() {\n          if (!--n) {\n            callback.apply(this, arguments);\n          }\n        });\n      }, () => this.inTransition = false);\n    // Add week labels\n    this.labels.selectAll('.label-week').remove();\n    this.labels.selectAll('.label-week')\n      .data(weekLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-week')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: Moment) => 'Week ' + d.week())\n      .attr('x', (d: Moment) => weekScale(d.week().toString()))\n      .attr('y', this.labelPadding / 2)\n      .on('mouseenter', (weekday: Moment) => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-month')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (d: Datum) => {\n            return (moment(d.date).week() === weekday.week()) ? 1 : 0.1;\n          });\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-month')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      })\n      .on('click', (d: Moment) => {\n        if (this.inTransition) {\n          return;\n        }\n        this.inTransition = true;\n        // Set selected month to the one clicked on\n        this.selected = {date: d};\n        // Hide tooltip\n        this.hideTooltip();\n        // Remove all year overview related items and labels\n        this.removeMonthOverview();\n        // Redraw the chart\n        this.overview = 'week';\n        this.drawChart();\n      });\n    // Add day labels\n    this.labels.selectAll('.label-day').remove();\n    this.labels.selectAll('.label-day')\n      .data(dayLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-day')\n      .attr('x', this.labelPadding / 3)\n      .attr('y', (d: Date, i: any) => dayScale(i) + dayScale.bandwidth() / 1.75)\n      .style('text-anchor', 'left')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: Date) => moment.utc(d).format('dddd')[0])\n      .on('mouseenter', (d: Date) => {\n        if (this.inTransition) {\n          return;\n        }\n        const selectedDay = moment.utc(d);\n        this.items.selectAll('.item-block-month')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (data: Datum) => (moment(data.date).day() === selectedDay.day()) ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-month')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      });\n    // Add button to switch back to previous overview\n    this.drawButton();\n  }\n\n  drawWeekOverview() {\n    // Add current overview to the history\n    if (this.history[this.history.length - 1] !== this.overview) {\n      this.history.push(this.overview);\n    }\n    // Define beginning and end of the week\n    const startOfWeek: Moment = moment(this.selected.date).startOf('week');\n    const endOfWeek: Moment = moment(this.selected.date).endOf('week');\n    // Filter data down to the selected week\n    let weekData: Datum[] = [];\n    this._data.filter((d: Datum) => {\n      return d.date.isBetween(startOfWeek, endOfWeek, null, '[]');\n    }).map((d: Datum) => {\n      const scale: Datum[] = [];\n      d.details.forEach((det: Detail) => {\n        const date: Moment = moment(det.date);\n        const i = date.hours();\n        if (!scale[i]) {\n          scale[i] = {\n            date: date.startOf('hour'),\n            total: 0,\n            details: [],\n            summary: []\n          };\n        }\n        scale[i].total += det.value;\n        scale[i].details.push(det);\n      });\n      scale.forEach(s => {\n        const group = this.groupBy(s.details, 'name');\n        Object.keys(group).forEach(k =>\n          s.summary.push({\n            name: k,\n            total: sum(group[k], (data: any) => data.value),\n            color: group[k][0].color\n          }));\n      });\n      weekData = weekData.concat(scale);\n    });\n    weekData = GTSLib.cleanArray(weekData);\n    const maxValue: number = max(weekData, (d: Datum) => d.total);\n    // Define day labels and axis\n    const dayLabels = timeDays(moment.utc().startOf('week').toDate(), moment.utc().endOf('week').toDate());\n    const dayScale = scaleBand()\n      .rangeRound([this.labelPadding, this.gHeight])\n      .domain(dayLabels.map((d: Date) => moment.utc(d).weekday().toString()));\n    // Define hours labels and axis\n    const hoursLabels: string[] = [];\n    range(0, 24).forEach(h => hoursLabels.push(moment.utc().hours(h).startOf('hour').format('HH:mm')));\n    const hourScale = scaleBand().rangeRound([this.labelPadding, this.gWidth]).padding(0.01).domain(hoursLabels);\n    const color = scaleLinear<string>()\n      .range([this.minColor || CalendarHeatmapComponent.DEF_MIN_COLOR, this.maxColor || CalendarHeatmapComponent.DEF_MAX_COLOR])\n      .domain([-0.15 * maxValue, maxValue]);\n    // Add week data items to the overview\n    this.items.selectAll('.item-block-week').remove();\n    this.items.selectAll('.item-block-week')\n      .data(weekData)\n      .enter()\n      .append('rect')\n      .style('opacity', 0)\n      .attr('class', 'item item-block-week')\n      .attr('y', (d: Datum) => this.calcItemY(d)\n        + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n      .attr('x', (d: Datum) => this.gutter\n        + hourScale(moment(d.date).startOf('hour').format('HH:mm'))\n        + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n      .attr('rx', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('ry', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('width', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('height', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('fill', (d: Datum) => (d.total > 0) ? color(d.total) : 'transparent')\n      .on('click', (d: Datum) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Don't transition if there is no data to show\n        if (d.total === 0) {\n          return;\n        }\n        this.inTransition = true;\n        // Set selected date to the one clicked on\n        this.selected = d;\n        // Hide tooltip\n        this.hideTooltip();\n        // Remove all week overview related items and labels\n        this.removeWeekOverview();\n        // Redraw the chart\n        this.overview = 'day';\n        this.drawChart();\n      }).on('mouseover', (d: Datum) => {\n      if (this.inTransition) {\n        return;\n      }\n      // Calculate tooltip position\n      let x = hourScale(moment(d.date).startOf('hour').format('HH:mm')) + this.tooltipPadding;\n      while (this.gWidth - x < (this.tooltipWidth + this.tooltipPadding * 3)) {\n        x -= 10;\n      }\n      const y = dayScale(d.date.weekday().toString()) + this.tooltipPadding;\n      // Show tooltip\n      this.tooltip.html(this.getTooltip(d))\n        .style('left', x + 'px')\n        .style('top', y + 'px')\n        .transition()\n        .duration(this.transitionDuration / 2)\n        .ease(easeLinear)\n        .style('opacity', 1);\n    })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.hideTooltip();\n      })\n      .transition()\n      .delay(() => (Math.cos(Math.PI * Math.random()) + 1) * this.transitionDuration)\n      .duration(() => this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 1)\n      .call((transition: any, callback: any) => {\n        if (transition.empty()) {\n          callback();\n        }\n        let n = 0;\n        transition.each(() => ++n).on('end', function() {\n          if (!--n) {\n            callback.apply(this, arguments);\n          }\n        });\n      }, () => this.inTransition = false);\n\n    // Add week labels\n    this.labels.selectAll('.label-week').remove();\n    this.labels.selectAll('.label-week')\n      .data(hoursLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-week')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: string) => d)\n      .attr('x', (d: string) => hourScale(d))\n      .attr('y', this.labelPadding / 2)\n      .on('mouseenter', (hour: string) => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-week')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (d: Datum) => (moment(d.date).startOf('hour').format('HH:mm') === hour) ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-week')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      });\n    // Add day labels\n    this.labels.selectAll('.label-day').remove();\n    this.labels.selectAll('.label-day')\n      .data(dayLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-day')\n      .attr('x', this.labelPadding / 3)\n      .attr('y', (d: Date, i: number) => dayScale(i.toString()) + dayScale.bandwidth() / 1.75)\n      .style('text-anchor', 'left')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: Date) => moment.utc(d).format('dddd')[0])\n      .on('mouseenter', (d: Date) => {\n        if (this.inTransition) {\n          return;\n        }\n        const selectedDay = moment.utc(d);\n        this.items.selectAll('.item-block-week')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (data: Datum) => (moment(data.date).day() === selectedDay.day()) ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-week')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      });\n\n    // Add button to switch back to previous overview\n    this.drawButton();\n  }\n\n  drawDayOverview() {\n    // Add current overview to the history\n    if (this.history[this.history.length - 1] !== this.overview) {\n      this.history.push(this.overview);\n    }\n    // Initialize selected date to today if it was not set\n    if (!Object.keys(this.selected).length) {\n      this.selected = this._data[this._data.length - 1];\n    }\n    const startOfDay: Moment = moment(this.selected.date).startOf('day');\n    const endOfDay: Moment = moment(this.selected.date).endOf('day');\n    // Filter data down to the selected month\n    let dayData: Datum[] = [];\n    this._data.filter((d: Datum) => {\n      return d.date.isBetween(startOfDay, endOfDay, null, '[]');\n    }).map((d: Datum) => {\n      const scale = [];\n      d.details.forEach((det: Detail) => {\n        const date: Moment = moment(det.date);\n        const i = date.hours();\n        if (!scale[i]) {\n          scale[i] = {\n            date: date.startOf('hour'),\n            total: 0,\n            details: [],\n            summary: []\n          };\n        }\n        scale[i].total += det.value;\n        scale[i].details.push(det);\n      });\n      scale.forEach(s => {\n        const group = this.groupBy(s.details, 'name');\n        Object.keys(group).forEach(k => {\n          s.summary.push({\n            name: k,\n            total: sum(group[k], (item: any) => item.value),\n            color: group[k][0].color\n          });\n        });\n      });\n      dayData = dayData.concat(scale);\n    });\n    const data: Summary[] = [];\n    dayData.forEach((d: Datum) => {\n      const date = d.date;\n      d.summary.forEach((s: Summary) => {\n        s.date = date;\n        data.push(s);\n      });\n    });\n    dayData = GTSLib.cleanArray(dayData);\n    const maxValue: number = max(data, (d: Summary) => d.total);\n    const gtsNames = this.selected.summary.map((summary: Summary) => summary.name);\n    const gtsNameScale = scaleBand().rangeRound([this.labelPadding, this.gHeight]).domain(gtsNames);\n    const hourLabels: string[] = [];\n    range(0, 24).forEach(h => hourLabels.push(moment.utc().hours(h).startOf('hour').format('HH:mm')));\n    const dayScale = scaleBand()\n      .rangeRound([this.labelPadding, this.gWidth])\n      .padding(0.01)\n      .domain(hourLabels);\n    this.items.selectAll('.item-block').remove();\n    this.items.selectAll('.item-block')\n      .data(data)\n      .enter()\n      .append('rect')\n      .attr('class', 'item item-block')\n      .attr('x', (d: Summary) => this.gutter\n        + dayScale(moment(d.date).startOf('hour').format('HH:mm'))\n        + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n      .attr('y', (d: Summary) => {\n        return (gtsNameScale(d.name) || 1) - (this.itemSize - this.calcItemSize(d, maxValue)) / 2;\n      })\n      .attr('rx', (d: Summary) => this.calcItemSize(d, maxValue))\n      .attr('ry', (d: Summary) => this.calcItemSize(d, maxValue))\n      .attr('width', (d: Summary) => this.calcItemSize(d, maxValue))\n      .attr('height', (d: Summary) => this.calcItemSize(d, maxValue))\n      .attr('fill', (d: Summary) => {\n        const color = scaleLinear<string>()\n          .range(['#ffffff', d.color || CalendarHeatmapComponent.DEF_MIN_COLOR])\n          .domain([-0.5 * maxValue, maxValue]);\n        return color(d.total);\n      })\n      .style('opacity', 0)\n      .on('mouseover', (d: Summary) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Calculate tooltip position\n        let x = dayScale(moment(d.date).startOf('hour').format('HH:mm')) + this.tooltipPadding;\n        while (this.gWidth - x < (this.tooltipWidth + this.tooltipPadding * 3)) {\n          x -= 10;\n        }\n        const y = gtsNameScale(d.name) + this.tooltipPadding;\n        // Show tooltip\n        this.tooltip.html(this.getTooltip(d))\n          .style('left', x + 'px')\n          .style('top', y + 'px')\n          .transition()\n          .duration(this.transitionDuration / 2)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.hideTooltip();\n      })\n      .on('click', (d: Summary) => {\n        if (this.handler) {\n          this.handler.emit(d);\n        }\n      })\n      .transition()\n      .delay(() => (Math.cos(Math.PI * Math.random()) + 1) * this.transitionDuration)\n      .duration(() => this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 1)\n      .call((transition: any, callback: any) => {\n        if (transition.empty()) {\n          callback();\n        }\n        let n = 0;\n        transition.each(() => ++n).on('end', function() {\n          if (!--n) {\n            callback.apply(this, arguments);\n          }\n        });\n      }, () => this.inTransition = false);\n\n    // Add time labels\n    this.labels.selectAll('.label-time').remove();\n    this.labels.selectAll('.label-time')\n      .data(hourLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-time')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: string) => d)\n      .attr('x', (d: string) => dayScale(d))\n      .attr('y', this.labelPadding / 2)\n      .on('mouseenter', (d: string) => {\n        if (this.inTransition) {\n          return;\n        }\n        const selected = d;\n        // const selected = itemScale(moment.utc(d));\n        this.items.selectAll('.item-block')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (item: any) => (item.date.format('HH:mm') === selected) ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      });\n    // Add project labels\n    const labelPadding = this.labelPadding;\n    this.labels.selectAll('.label-project').remove();\n    this.labels.selectAll('.label-project')\n      .data(gtsNames)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-project')\n      .attr('x', this.gutter)\n      .attr('y', (d: string) => gtsNameScale(d) + this.itemSize / 2)\n      .attr('min-height', () => gtsNameScale.bandwidth())\n      .style('text-anchor', 'left')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: string) => d)\n      .each(function() {\n        const obj = select(this);\n        let textLength = obj.node().getComputedTextLength();\n        let text = obj.text();\n        while (textLength > (labelPadding * 1.5) && text.length > 0) {\n          text = text.slice(0, -1);\n          obj.text(text + '...');\n          textLength = obj.node().getComputedTextLength();\n        }\n      })\n      .on('mouseenter', (gtsName: string) => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (d: Summary) => (d.name === gtsName) ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      });\n    // Add button to switch back to previous overview\n    this.drawButton();\n  }\n\n  private calcItemX(d: Datum, startOfYear: Moment) {\n    const dayIndex = Math.round((+moment(d.date) - +startOfYear.startOf('week')) / 86400000);\n    const colIndex = Math.trunc(dayIndex / 7);\n    return colIndex * (this.itemSize + this.gutter) + this.labelPadding;\n  }\n\n  private calcItemXMonth(d: Datum, start: Moment, offset: number) {\n    const hourIndex = moment(d.date).hours();\n    const colIndex = Math.trunc(hourIndex / 3);\n    return colIndex * (this.itemSize + this.gutter) + offset;\n  }\n\n  private calcItemY(d: Datum) {\n    return this.labelPadding + d.date.weekday() * (this.itemSize + this.gutter);\n  }\n\n  private calcItemSize(d: Datum | Summary, m: number) {\n    if (m <= 0) {\n      return this.itemSize;\n    }\n    return this.itemSize * 0.75 + (this.itemSize * d.total / m) * 0.25;\n  }\n\n  private drawButton() {\n    this.buttons.selectAll('.button').remove();\n    const button = this.buttons.append('g')\n      .attr('class', 'button button-back')\n      .style('opacity', 0)\n      .on('click', () => {\n        if (this.inTransition) {\n          return;\n        }\n        // Set transition boolean\n        this.inTransition = true;\n        // Clean the canvas from whichever overview type was on\n        if (this.overview === 'year') {\n          this.removeYearOverview();\n        } else if (this.overview === 'month') {\n          this.removeMonthOverview();\n        } else if (this.overview === 'week') {\n          this.removeWeekOverview();\n        } else if (this.overview === 'day') {\n          this.removeDayOverview();\n        }\n        // Redraw the chart\n        this.history.pop();\n        this.overview = this.history.pop();\n        this.drawChart();\n      });\n    button.append('circle')\n      .attr('cx', this.labelPadding / 2.25)\n      .attr('cy', this.labelPadding / 2.5)\n      .attr('r', this.itemSize / 2);\n    button.append('text')\n      .attr('x', this.labelPadding / 2.25)\n      .attr('y', this.labelPadding / 2.5)\n      .attr('dy', () => {\n        return Math.floor(this.gWidth / 100) / 3;\n      })\n      .attr('font-size', () => {\n        return Math.floor(this.labelPadding / 3) + 'px';\n      })\n      .html('&#x2190;');\n    button.transition()\n      .duration(this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 1);\n  }\n\n  private removeGlobalOverview() {\n    this.items.selectAll('.item-block-year')\n      .transition()\n      .duration(this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 0)\n      .remove();\n    this.labels.selectAll('.label-year').remove();\n  }\n\n  private removeYearOverview() {\n    this.items.selectAll('.item-circle')\n      .transition()\n      .duration(this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 0)\n      .remove();\n    this.labels.selectAll('.label-day').remove();\n    this.labels.selectAll('.label-month').remove();\n    this.hideBackButton();\n  }\n\n  private removeMonthOverview() {\n    this.items.selectAll('.item-block-month')\n      .transition()\n      .duration(this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 0)\n      .remove();\n    this.labels.selectAll('.label-day').remove();\n    this.labels.selectAll('.label-week').remove();\n    this.hideBackButton();\n  }\n\n  private removeWeekOverview() {\n    this.items.selectAll('.item-block-week')\n      .transition()\n      .duration(this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 0)\n      .attr('x', (d: any, i: number) => (i % 2 === 0) ? -this.gWidth / 3 : this.gWidth / 3)\n      .remove();\n    this.labels.selectAll('.label-day').remove();\n    this.labels.selectAll('.label-week').remove();\n    this.hideBackButton();\n  }\n\n  private removeDayOverview() {\n    this.items.selectAll('.item-block')\n      .transition()\n      .duration(this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 0)\n      .attr('x', (d: any, i: number) => (i % 2 === 0) ? -this.gWidth / 3 : this.gWidth / 3)\n      .remove();\n    this.labels.selectAll('.label-time').remove();\n    this.labels.selectAll('.label-project').remove();\n    this.hideBackButton();\n  }\n\n  private hideTooltip() {\n    this.tooltip.transition()\n      .duration(this.transitionDuration / 2)\n      .ease(easeLinear)\n      .style('opacity', 0);\n  }\n\n  /**\n   * Helper function to hide the back button\n   */\n  private hideBackButton() {\n    this.buttons.selectAll('.button')\n      .transition()\n      .duration(this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 0)\n      .remove();\n  }\n\n  private getTooltip = (d: any) => {\n    let tooltipHtml = '<div class=\"header\"><strong>' + d.date.format('dddd, MMM Do YYYY HH:mm') + '</strong></div><ul>';\n    (d.summary || []).forEach(s => {\n      tooltipHtml += `<li>\n  <div class=\"round\" style=\"background-color:${ColorLib.transparentize(s.color)}; border-color:${s.color}\"></div>\n${GTSLib.formatLabel(s.name)}: ${s.total}</li>`;\n    });\n    if (d.total !== undefined && d.name) {\n      tooltipHtml += `<li><div class=\"round\"\nstyle=\"background-color: ${ColorLib.transparentize(d.color)}; border-color: ${d.color}\"\n></div> ${GTSLib.formatLabel(d.name)}: ${d.total}</li>`;\n    }\n    tooltipHtml += '</ul>';\n    return tooltipHtml;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {AfterViewInit, Component, ElementRef, EventEmitter, HostListener, Input, Output, ViewEncapsulation} from '@angular/core';\n\n@Component({\n  selector: 'warpview-modal',\n  templateUrl: './warp-view-modal.component.html',\n  styleUrls: ['./warp-view-modal.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewModalComponent implements AfterViewInit {\n\n\n  @Input('modalTitle') modalTitle = '';\n  @Input('kbdLastKeyPressed') kbdLastKeyPressed: string[] = [];\n\n  @Output('warpViewModalOpen') warpViewModalOpen = new EventEmitter<any>();\n  @Output('warpViewModalClose') warpViewModalClose = new EventEmitter<any>();\n\n  private opened = false;\n\n  public open() {\n    this.el.nativeElement.style.display = 'block';\n    this.el.nativeElement.style.zIndex = '999999';\n    this.opened = true;\n    this.warpViewModalOpen.emit({});\n  }\n\n  public close() {\n    this.el.nativeElement.style.display = 'none';\n    this.el.nativeElement.style.zIndex = '-1';\n    this.opened = false;\n    this.warpViewModalClose.emit({});\n  }\n\n  public isOpened(): Promise<boolean> {\n    return new Promise<boolean>(resolve => {\n      resolve(this.opened);\n    });\n  }\n\n  @HostListener('kbdLastKeyPressed', ['$event'])\n  handleKeyDown($event: string[]) {\n    if ('Escape' === $event[0]) {\n      this.close();\n    }\n  }\n\n  constructor(public el: ElementRef) {\n  }\n\n  ngAfterViewInit(): void {\n    this.el.nativeElement.addEventListener('click', (event: any) => {\n      if (event.path[0].nodeName === 'WARP-VIEW-MODAL') {\n        this.close();\n      }\n    });\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {AfterViewInit, Component, EventEmitter, Input, Output, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {DataModel} from '../../model/dataModel';\nimport {Logger} from '../../utils/logger';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {WarpViewModalComponent} from '../warp-view-modal/warp-view-modal.component';\nimport {Param} from '../../model/param';\nimport deepEqual from 'deep-equal';\nimport {ChartLib} from '../../utils/chart-lib';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-gts-popup',\n  templateUrl: './warp-view-gts-popup.component.html',\n  styleUrls: ['./warp-view-gts-popup.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewGtsPopupComponent implements AfterViewInit {\n  @ViewChild('modal', {static: true}) modal: WarpViewModalComponent;\n\n  @Input('options') set options(options: Param | string) {\n    this.LOG.debug(['onOptions'], options);\n    if (typeof options === 'string') {\n      options = JSON.parse(options);\n    }\n    if (!deepEqual(options, this._options)) {\n      this.LOG.debug(['options', 'changed'], options);\n      this._options = ChartLib.mergeDeep(this._options, options as Param) as Param;\n      this.prepareData();\n    }\n  }\n\n  @Input('gtsList') set gtsList(gtsList: DataModel) {\n    this._gtsList = gtsList;\n    this.LOG.debug(['_gtsList'], this._gtsList);\n\n    this.prepareData();\n  }\n\n  get gtslist(): DataModel {\n    return this._gtsList;\n  }\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Input('data') set data(data: DataModel) {\n    this.LOG.debug(['data'], data);\n    if (data) {\n      this._data = data;\n    }\n  }\n\n  get data(): DataModel {\n    return this._data;\n  }\n\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    this._hiddenData = hiddenData;\n    this.prepareData();\n  }\n\n  get hiddenData(): number[] {\n    return this._hiddenData;\n  }\n\n  @Input('maxToShow') maxToShow = 5;\n\n  @Input('kbdLastKeyPressed') set kbdLastKeyPressed(kbdLastKeyPressed: string[]) {\n    this._kbdLastKeyPressed = kbdLastKeyPressed;\n    if (kbdLastKeyPressed[0] === 's' && !this.modalOpenned) {\n      this.showPopup();\n    } else if (this.modalOpenned) {\n      switch (kbdLastKeyPressed[0]) {\n        case'ArrowUp':\n        case'j':\n          this.current = Math.max(0, this.current - 1);\n          this.prepareData();\n          break;\n        case 'ArrowDown':\n        case 'k':\n          this.current = Math.min(this._gts.length - 1, this.current + 1);\n          this.prepareData();\n          break;\n        case ' ':\n          this.warpViewSelectedGTS.emit({\n            gts: this._gts[this.current],\n            selected: this.hiddenData.indexOf(this._gts[this.current].id) > -1\n          });\n          break;\n        default:\n          return;\n      }\n    }\n  }\n\n  get kbdLastKeyPressed(): string[] {\n    return this._kbdLastKeyPressed;\n  }\n\n  @Output('warpViewSelectedGTS') warpViewSelectedGTS = new EventEmitter<any>();\n  @Output('warpViewModalOpen') warpViewModalOpen = new EventEmitter<any>();\n  @Output('warpViewModalClose') warpViewModalClose = new EventEmitter<any>();\n\n  current = 0;\n  // tslint:disable-next-line:variable-name\n  _gts: any[] = [];\n  _options: Param = new Param();\n\n  // tslint:disable-next-line:variable-name\n  private _kbdLastKeyPressed: string[] = [];\n  // tslint:disable-next-line:variable-name\n  private _hiddenData: number[] = [];\n  // tslint:disable-next-line:variable-name\n  private _debug = false;\n  // tslint:disable-next-line:variable-name\n  private _gtsList: DataModel;\n  // tslint:disable-next-line:variable-name\n  private _data: DataModel;\n  private displayed: any[] = [];\n  private modalOpenned = false;\n  private LOG: Logger;\n\n  constructor() {\n    this.LOG = new Logger(WarpViewGtsPopupComponent, this.debug);\n  }\n\n  ngAfterViewInit(): void {\n    this.prepareData();\n  }\n\n  onWarpViewModalOpen() {\n    this.modalOpenned = true;\n    this.warpViewModalOpen.emit({});\n  }\n\n  onWarpViewModalClose() {\n    this.modalOpenned = false;\n    this.warpViewModalClose.emit({});\n  }\n\n  public isOpened(): Promise<boolean> {\n    return this.modal.isOpened();\n  }\n\n  private showPopup() {\n    this.current = 0;\n    this.prepareData();\n    this.modal.open();\n  }\n\n  public close() {\n    this.modal.close();\n  }\n\n  private prepareData() {\n    if (this._gtsList && this._gtsList.data) {\n      this._gts = GTSLib.flatDeep([this._gtsList.data]);\n      this.displayed = this._gts.slice(\n        Math.max(0, Math.min(this.current - this.maxToShow, this._gts.length - 2 * this.maxToShow)),\n        Math.min(this._gts.length, this.current + this.maxToShow + Math.abs(Math.min(this.current - this.maxToShow, 0)))\n      ) as any[];\n      this.LOG.debug(['prepareData'], this.displayed);\n    }\n  }\n\n  isHidden(gts) {\n    return !this.displayed.find(g => !!gts ? gts.id === g.id : false);\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {\n  AfterViewInit,\n  Component,\n  ElementRef,\n  EventEmitter,\n  Input,\n  NgZone,\n  Output,\n  Renderer2,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {DataModel} from '../../model/dataModel';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {Subject} from 'rxjs';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-gts-tree',\n  templateUrl: './warp-view-gts-tree.component.html',\n  styleUrls: ['./warp-view-gts-tree.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewGtsTreeComponent extends WarpViewComponent implements AfterViewInit {\n  @ViewChild('root', {static: true}) root: ElementRef;\n\n  @Input('kbdLastKeyPressed') kbdLastKeyPressed: string[] = [];\n\n  @Input('gtsFilter') set gtsFilter(gtsFilter: string) {\n    this._gtsFilter = gtsFilter;\n  }\n\n  get gtsFilter() {\n    return this._gtsFilter;\n  }\n\n  @Output('warpViewSelectedGTS') warpViewSelectedGTS = new EventEmitter<any>();\n\n  private _gtsFilter = 'x';\n  gtsList: any[] = [];\n  params: Param[] = [] as Param[];\n  expand = false;\n\n  initOpen: Subject<void> = new Subject<void>();\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewGtsTreeComponent, this._debug);\n  }\n\n  ngAfterViewInit(): void {\n    this.LOG.debug(['componentDidLoad', 'data'], this._data);\n    if (this._data) {\n      this.doRender();\n    }\n    if (!!this._options.foldGTSTree && !this.expand) {\n      this.foldAll();\n    }\n    if (!this._options.foldGTSTree) {\n      this.initOpen.next();\n    }\n  }\n\n  update(options: Param, refresh: boolean): void {\n    this.doRender();\n    if (!!this._options.foldGTSTree && !this.expand) {\n      this.foldAll();\n    }\n  }\n\n  private doRender() {\n    this.LOG.debug(['doRender', 'gtsList'], this._data);\n    this._options = ChartLib.mergeDeep(this.defOptions, this._options) as Param;\n    if (!this._data) {\n      return;\n    }\n    const dataList = GTSLib.getData(this._data).data;\n    this.params = this._data.params || [];\n    this.LOG.debug(['doRender', 'gtsList', 'dataList'], dataList);\n    if (!dataList) {\n      return;\n    }\n    this.expand = !this._options.foldGTSTree;\n    this.gtsList = GTSLib.flattenGtsIdArray(dataList as any[], 0).res;\n    this.LOG.debug(['doRender', 'gtsList'], this.gtsList, this._options.foldGTSTree, this.expand);\n    this.loading = false;\n    this.chartDraw.emit();\n  }\n\n  private foldAll() {\n    if (!this.root) {\n      setTimeout(() => this.foldAll());\n    } else {\n      this.expand = false;\n    }\n  }\n\n  toggleVisibility() {\n    this.expand = !this.expand;\n  }\n\n  protected convert(data: DataModel): any[] {\n    return [];\n  }\n\n  warpViewSelectedGTSHandler(event) {\n    this.LOG.debug(['warpViewSelectedGTS'], event);\n    this.warpViewSelectedGTS.emit(event);\n  }\n\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, EventEmitter, Input, OnDestroy, OnInit, Output, ViewEncapsulation} from '@angular/core';\nimport {Logger} from '../../../utils/logger';\nimport {GTSLib} from '../../../utils/gts.lib';\nimport {Param} from '../../../model/param';\nimport {Observable, Subject, Subscription} from 'rxjs';\n\n@Component({\n  selector: 'warpview-tree-view',\n  templateUrl: './warp-view-tree-view.component.html',\n  styleUrls: ['./warp-view-tree-view.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewTreeViewComponent implements OnInit, OnDestroy {\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    this._hiddenData = [...hiddenData];\n  }\n\n  get hiddenData(): number[] {\n    return this._hiddenData;\n  }\n\n  @Input('options') options: Param;\n  @Input('gtsFilter') gtsFilter = 'x';\n  @Input('gtsList') gtsList: any[];\n  @Input('params') params: Param[];\n  @Input('branch') branch = false;\n  @Input('hidden') hidden = false;\n  @Input() events: Observable<void>;\n\n  @Input('kbdLastKeyPressed') kbdLastKeyPressed: string[] = [];\n  @Output('warpViewSelectedGTS') warpViewSelectedGTS = new EventEmitter<any>();\n\n  hide: any = {};\n  initOpen: Subject<void> = new Subject<void>();\n  private LOG: Logger;\n  private _debug = false;\n  private _hiddenData: number[] = [];\n  private eventsSubscription: Subscription;\n\n  constructor() {\n    this.LOG = new Logger(WarpViewTreeViewComponent, this.debug);\n  }\n\n  ngOnInit(): void {\n    this.LOG.debug(['ngOnInit'], this.gtsList);\n    this.gtsList.forEach((g, index) => {\n      this.hide[index + ''] = false;\n    });\n    this.eventsSubscription = this.events.subscribe(() => this.open());\n  }\n\n  ngOnDestroy() {\n    this.eventsSubscription.unsubscribe();\n  }\n\n  toggleVisibility(index: number) {\n    this.LOG.debug(['toggleVisibility'], index, this.hide);\n    this.hide[index + ''] = !this.hide[index + ''];\n  }\n\n  isHidden(index: number) {\n    if (!!this.hide[index + '']) {\n      return this.hide[index + ''];\n    } else {\n      return false;\n    }\n  }\n\n  isGts(node) {\n    return GTSLib.isGts(node);\n  }\n\n  warpViewSelectedGTSHandler(event) {\n    this.LOG.debug(['warpViewSelectedGTS'], event);\n    this.warpViewSelectedGTS.emit(event);\n  }\n\n  open() {\n    this.gtsList.forEach((g, index) => {\n      this.hide[index + ''] = true;\n    });\n    setTimeout(() => this.initOpen.next());\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Label} from './label';\n\nexport class GTS {\n  c: string;\n  l: Label[];\n  a: Label[];\n  v: any[][];\n  id?: number;\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {AfterViewInit, Component, ElementRef, EventEmitter, Input, OnInit, Output, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {GTS} from '../../../model/GTS';\nimport {Logger} from '../../../utils/logger';\nimport {GTSLib} from '../../../utils/gts.lib';\nimport {ColorLib} from '../../../utils/color-lib';\nimport {Param} from '../../../model/param';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-chip',\n  templateUrl: './warp-view-chip.component.html',\n  styleUrls: ['./warp-view-chip.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewChipComponent implements OnInit, AfterViewInit {\n\n  @ViewChild('chip', {static: false}) chip: ElementRef;\n\n  @Input('name') name: string;\n  @Input('node') node: any;\n  @Input('param') param: Param = new Param();\n  @Input('options') options: Param = new Param();\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    this._hiddenData = hiddenData;\n    this.LOG.debug(['hiddenData'], hiddenData, this._node, this._node.gts, this._node.gts.c);\n    if (this._node && this._node.gts && this._node.gts.c) {\n      this._node = {\n        ...this._node,\n        selected: this.hiddenData.indexOf(this._node.gts.id) === -1,\n        label: GTSLib.serializeGtsMetadata(this._node.gts)\n      };\n      this.LOG.debug(['hiddenData'], this._node);\n      this.colorizeChip();\n    }\n  }\n\n  get hiddenData(): number[] {\n    return this._hiddenData;\n  }\n\n  @Input('gtsFilter') set gtsFilter(gtsFilter: string) {\n    this._gtsFilter = gtsFilter;\n    if (this._gtsFilter.slice(1) !== '') {\n      this.setState(new RegExp(this._gtsFilter.slice(1), 'gi').test(GTSLib.serializeGtsMetadata(this._node.gts)));\n    } else {\n      this.setState(true);\n    }\n  }\n\n  get gtsFilter() {\n    return this._gtsFilter;\n  }\n\n  @Input('kbdLastKeyPressed') set kbdLastKeyPressed(kbdLastKeyPressed: string[]) {\n    this._kbdLastKeyPressed = kbdLastKeyPressed;\n    if (kbdLastKeyPressed[0] === 'a') {\n      this.setState(true);\n    }\n    if (kbdLastKeyPressed[0] === 'n') {\n      this.setState(false);\n    }\n  }\n\n  @Output('warpViewSelectedGTS') warpViewSelectedGTS = new EventEmitter<any>();\n\n  private LOG: Logger;\n  private refreshCounter = 0;\n  // the first character triggers change each filter apply to trigger events. it must be discarded.\n  private _gtsFilter = 'x';\n  private _debug = false;\n  private _kbdLastKeyPressed: string[] = [];\n  private _hiddenData: number[] = [];\n  _node: any = {\n    selected: true,\n    gts: GTS,\n  };\n\n  constructor() {\n    this.LOG = new Logger(WarpViewChipComponent, this.debug);\n  }\n\n  ngOnInit(): void {\n    this._node = {...this.node, selected: this.hiddenData.indexOf(this.node.gts.id) === -1};\n  }\n\n  ngAfterViewInit() {\n    if (this.gtsFilter.slice(1) !== '' && new RegExp(this.gtsFilter.slice(1), 'gi').test(GTSLib.serializeGtsMetadata(this._node.gts))\n      || this.hiddenData.indexOf(this._node.gts.id) > -1) {\n      this.setState(false);\n    }\n    this.colorizeChip();\n  }\n\n  private colorizeChip() {\n    if (this.chip) {\n      if (this._node.selected && this.chip.nativeElement) {\n        const c = ColorLib.getColor(this._node.gts.id, this.options.scheme);\n        const color = (this.param || {datasetColor: c}).datasetColor || c;\n        this.chip.nativeElement.style.setProperty('background-color', ColorLib.transparentize(color));\n        this.chip.nativeElement.style.setProperty('border-color', color);\n      } else {\n        this.chip.nativeElement.style.setProperty('background-color', '#eeeeee');\n      }\n      this.refreshCounter++;\n    }\n  }\n\n  toArray(obj) {\n    if (obj === undefined) {\n      return [];\n    }\n    return Object.keys(obj).map(key => ({name: key, value: obj[key]}));\n  }\n\n  switchPlotState(event: UIEvent) {\n    event.preventDefault();\n    this.setState(!this._node.selected);\n    return false;\n  }\n\n  private setState(state: boolean) {\n    if (this._node && this._node.gts) {\n      this._node = {\n        ...this._node,\n        selected: state,\n        label: GTSLib.serializeGtsMetadata(this._node.gts)\n      };\n      this.LOG.debug(['switchPlotState'], this._node);\n      this.colorizeChip();\n      this.warpViewSelectedGTS.emit(this._node);\n    }\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {AfterViewInit, Component, ElementRef, HostListener, Input, NgZone, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {DataModel} from '../../model/dataModel';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-image',\n  templateUrl: './warp-view-image.component.html',\n  styleUrls: ['./warp-view-image.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewImageComponent extends WarpViewComponent implements AfterViewInit {\n  @Input('imageTitle') imageTitle = '';\n\n  toDisplay: string[];\n\n  private resizeTimer;\n  private parentWidth = -1;\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewImageComponent, this._debug);\n  }\n\n  ngAfterViewInit(): void {\n    this.LOG.debug(['ngAfterViewInit'], this._options);\n    this.drawChart();\n  }\n\n  update(options: Param, refresh: boolean): void {\n    this.drawChart();\n  }\n\n  @HostListener('window:resize')\n  onResize() {\n    if (this.el.nativeElement.parentElement.clientWidth !== this.parentWidth || this.parentWidth <= 0) {\n      this.parentWidth = this.el.nativeElement.parentElement.clientWidth;\n      clearTimeout(this.resizeTimer);\n      this.resizeTimer = setTimeout(() => {\n        if (this.el.nativeElement.parentElement.clientWidth > 0) {\n          this.LOG.debug(['onResize'], this.el.nativeElement.parentElement.clientWidth);\n          this.drawChart();\n        } else {\n          this.onResize();\n        }\n      }, 150);\n    }\n  }\n\n  private drawChart() {\n    if (!this._data || !this._data.data || this._data.data.length === 0) {\n      return;\n    }\n    this.initChart(this.el);\n    this.toDisplay = [];\n    let gts: DataModel = this._data;\n    this.LOG.debug(['drawChart', 'gts'], gts);\n    if (typeof gts === 'string') {\n      try {\n        gts = JSON.parse(gts as string);\n      } catch (error) {\n        // empty : it's a base64 string\n      }\n    }\n    if (gts.data && gts.data.length > 0 && GTSLib.isEmbeddedImage(gts.data[0])) {\n      this._options = ChartLib.mergeDeep(this._options, gts.globalParams || {}) as Param;\n      this.toDisplay.push(gts.data[0]);\n    } else if (gts.data && GTSLib.isEmbeddedImage(gts.data)) {\n      this.toDisplay.push(gts.data as string);\n    }\n    this.LOG.debug(['drawChart', 'this.data', 'this.toDisplay'], this.data, this.toDisplay);\n    this.loading = false;\n    this.chartDraw.emit();\n  }\n\n  getStyle() {\n    this.LOG.debug(['getStyle'], this._options);\n    if (!this._options) {\n      return {};\n    } else {\n      const style: any = {'background-color': this._options.bgColor || 'transparent', width: this.width, height: 'auto'};\n      if (this._options.fontColor) {\n        style.color = this._options.fontColor;\n      }\n      this.LOG.debug(['getStyle', 'style'], style);\n      return style;\n    }\n  }\n\n  protected convert(data: DataModel): any[] {\n    return [];\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {GTSLib} from './gts.lib';\nimport {ColorLib} from './color-lib';\nimport {Logger} from './logger';\n\nexport class MapLib {\n  static BASE_RADIUS = 2;\n  private static LOG: Logger = new Logger(MapLib, true);\n\n  static mapTypes: any = {\n    NONE: undefined,\n    DEFAULT: {\n      link: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n      attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n    },\n    HOT: {\n      link: 'https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png',\n      attribution: `&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, Tiles\n style by <a href=\"https://www.hotosm.org/\" target=\"_blank\">Humanitarian OpenStreetMap Team</a> hosted by\n <a href=\"https://openstreetmap.fr/\" target=\"_blank\">OpenStreetMap France</a>`\n    },\n    TOPO: {\n      link: 'https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png',\n      attribution: `Map data: &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors,\n <a href=\"http://viewfinderpanoramas.org\">SRTM</a> | Map style: &copy; <a href=\"https://opentopomap.org\">OpenTopoMap</a>\n  (<a href=\"https://creativecommons.org/licenses/by-sa/3.0/\">CC-BY-SA</a>)`\n    },\n    TOPO2: {\n      link: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}',\n      attribution: `Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN,\n       GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community`\n    },\n    SURFER: {\n      link: 'https://maps.heigit.org/openmapsurfer/tiles/roads/webmercator/{z}/{x}/{y}.png',\n      attribution: `Imagery from <a href=\"http://giscience.uni-hd.de/\">GIScience Research Group @ University of\n Heidelberg</a> | Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors`\n    },\n    HYDRA: {\n      link: 'https://{s}.tile.openstreetmap.se/hydda/full/{z}/{x}/{y}.png',\n      attribution: `Tiles courtesy of <a href=\"http://openstreetmap.se/\" target=\"_blank\">OpenStreetMap Sweden</a>\n &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors`\n    },\n    HYDRA2: {\n      link: 'https://{s}.tile.openstreetmap.se/hydda/base/{z}/{x}/{y}.png',\n      attribution: `Tiles courtesy of <a href=\"http://openstreetmap.se/\" target=\"_blank\">OpenStreetMap Sweden</a>\n &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors`\n    },\n    TONER: {\n      link: 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}{r}.png',\n      attribution: `Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>,\n <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy;\n  <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors`,\n      subdomains: 'abcd'\n    },\n    TONER_LITE: {\n      link: 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}{r}.png',\n      attribution: `Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>,\n <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy;\n  <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors`,\n      subdomains: 'abcd',\n    },\n    TERRAIN: {\n      link: 'https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}{r}.png',\n      attribution: `Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>,\n <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy;\n <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors`,\n      subdomains: 'abcd',\n    },\n    ESRI: {\n      link: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}',\n      attribution: `Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ, USGS, Intermap, iPC, NRCAN, Esri Japan,\n METI, Esri China (Hong Kong), Esri (Thailand), TomTom, 2012`\n    },\n    SATELLITE: {\n      link: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n      attribution: `Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN,\n IGP, UPR-EGP, and the GIS User Community`\n    },\n    OCEANS: {\n      link: 'https://server.arcgisonline.com/ArcGIS/rest/services/Ocean_Basemap/MapServer/tile/{z}/{y}/{x}',\n      attribution: 'Tiles &copy; Esri &mdash; Sources: GEBCO, NOAA, CHS, OSU, UNH, CSUMB, National Geographic, DeLorme, NAVTEQ, and Esri',\n    },\n    GRAY: {\n      link: 'https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}',\n      attibs: ''\n    },\n    GRAYSCALE: {\n      link: 'https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}',\n      attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ',\n    },\n    WATERCOLOR: {\n      link: 'https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg',\n      attribution: `Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>,\n <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy;\n  <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors`,\n      subdomains: 'abcd',\n    },\n    CARTODB: {\n      link: 'https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png',\n      attribution: `&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy;\n <a href=\"https://carto.com/attributions\">CartoDB</a>`,\n      subdomains: 'abcd',\n    },\n    CARTODB_DARK: {\n      link: 'https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png',\n      attribution: `&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy;\n <a href=\"https://carto.com/attributions\">CartoDB</a>`,\n      subdomains: 'abcd',\n    },\n  };\n\n  static toLeafletMapPaths(data: { gts: any[]; params: any[] }, hiddenData: number[], divider: number = 1000, scheme: string) {\n    const paths = [];\n    const size = (data.gts || []).length;\n    for (let i = 0; i < size; i++) {\n      const gts = data.gts[i];\n      if (GTSLib.isGtsToPlotOnMap(gts) && (hiddenData || []).filter(id => id === gts.id).length === 0) {\n        const path: any = {};\n        path.path = MapLib.gtsToPath(gts, divider);\n        if (data.params && data.params[i] && data.params[i].key) {\n          path.key = data.params[i].key;\n        } else {\n          path.key = GTSLib.serializeGtsMetadata(gts);\n        }\n        if (data.params && data.params[i] && data.params[i].color) {\n          path.color = data.params[i].color;\n        } else {\n          path.color = ColorLib.getColor(i, scheme);\n        }\n        paths.push(path);\n      }\n    }\n    return paths;\n  }\n\n  static gtsToPath(gts, divider: number = 1000) {\n    const path = [];\n    const size = (gts.v || []).length;\n    for (let i = 0; i < size; i++) {\n      const v = gts.v[i];\n      const l = v.length;\n      if (l >= 4) {\n        // timestamp, lat, lon, elev?, value\n        path.push({ts: Math.floor(v[0] / divider), lat: v[1], lon: v[2], val: v[l - 1]});\n      }\n    }\n    return path;\n  }\n\n  static annotationsToLeafletPositions(data: { gts: any[]; params: any[] }, hiddenData: number[], divider: number = 1000, scheme: string) {\n    const annotations = [];\n    const size = (data.gts || []).length;\n    for (let i = 0; i < size; i++) {\n      const gts = data.gts[i];\n      if (GTSLib.isGtsToAnnotate(gts) && (hiddenData || []).filter(id => id === gts.id).length === 0) {\n        this.LOG.debug(['annotationsToLeafletPositions'], gts);\n        const annotation: any = {};\n        let params = (data.params || [])[i];\n        if (!params) {\n          params = {};\n        }\n        annotation.path = MapLib.gtsToPath(gts, divider);\n        MapLib.extractCommonParameters(annotation, params, i, scheme);\n        if (params.render) {\n          annotation.render = params.render;\n        }\n        if (annotation.render === 'marker') {\n          annotation.marker = (data.params && data.params[i]) ? data.params[i].marker : 'circle';\n        }\n        if (annotation.render === 'weightedDots') {\n          MapLib.validateWeightedDotsPositionArray(annotation, params);\n        }\n        this.LOG.debug(['annotationsToLeafletPositions', 'annotations'], annotation);\n        annotations.push(annotation);\n      }\n    }\n    return annotations;\n  }\n\n  private static extractCommonParameters(obj, params, index, scheme: string) {\n    params = params || {};\n    obj.key = params.key || '';\n    obj.color = params.color || ColorLib.getColor(index, scheme);\n    obj.borderColor = params.borderColor || '#000';\n    obj.properties = params.properties || {};\n    if (params.baseRadius === undefined\n      || isNaN(parseInt(params.baseRadius, 10))\n      || parseInt(params.baseRadius, 10) < 0) {\n      obj.baseRadius = MapLib.BASE_RADIUS;\n    } else {\n      obj.baseRadius = params.baseRadius;\n    }\n  }\n\n  private static validateWeightedDotsPositionArray(posArray, params) {\n    if (params.minValue === undefined || params.maxValue === undefined) {\n      MapLib.LOG.error(['validateWeightedDotsPositionArray'], 'When using \\'weightedDots\\' or ' +\n        '\\'weightedColoredDots\\' rendering, \\'maxValue\\' and \\'minValue\\' parameters are compulsory');\n      posArray.render = undefined;\n      return;\n    }\n    posArray.maxValue = params.maxValue;\n    posArray.minValue = params.minValue;\n    if (typeof posArray.minValue !== 'number' ||\n      typeof posArray.maxValue !== 'number' ||\n      posArray.minValue >= posArray.maxValue) {\n      MapLib.LOG.error(['validateWeightedDotsPositionArray'], 'When using \\'weightedDots\\' or ' +\n        '\\'weightedColoredDots\\' rendering, \\'maxValue\\' and \\'minValue\\' must be numbers and \\'maxValue\\' ' +\n        'must be greater than \\'minValue\\'');\n      posArray.render = undefined;\n      return;\n    }\n    if (!GTSLib.isPositionsArrayWithValues(posArray) && !GTSLib.isPositionsArrayWithTwoValues(posArray)) {\n      MapLib.LOG.error(['validateWeightedDotsPositionArray'], 'When using \\'weightedDots\\' or ' +\n        '\\'weightedColoredDots\\' rendering, positions must have an associated value');\n      posArray.render = undefined;\n      return;\n    }\n\n    if (params.numSteps === undefined || isNaN(parseInt(params.numSteps, 10)) || parseInt(params.numSteps, 10) < 0) {\n      posArray.numSteps = 5;\n    } else {\n      posArray.numSteps = params.numSteps;\n    }\n    const step = (posArray.maxValue - posArray.minValue) / posArray.numSteps;\n    const steps = [];\n    for (let i = 0; i < posArray.numSteps - 1; i++) {\n      steps[i] = posArray.minValue + (i + 1) * step;\n    }\n    steps[posArray.numSteps - 1] = posArray.maxValue;\n\n    const size = (posArray || []).length;\n    for (let i = 0; i < size; i++) {\n      const pos = posArray[i];\n      const value = pos[2];\n      pos[4] = posArray.numSteps - 1;\n      for (const k in steps) {\n        if (value <= steps[k]) {\n          pos[4] = k;\n          break;\n        }\n      }\n    }\n    return true;\n  }\n\n  static toLeafletMapPositionArray(data: { gts: any[]; params: any[] }, hiddenData: number[], scheme: string) {\n    const positions = [];\n    const size = (data.gts || []).length;\n    for (let i = 0; i < size; i++) {\n      const gts = data.gts[i];\n      if (GTSLib.isPositionArray(gts) && (hiddenData || []).filter(id => id === gts.id).length === 0) {\n        this.LOG.debug(['toLeafletMapPositionArray'], gts, data.params[i]);\n        const posArray = gts;\n        const params = data.params[i] || {};\n        MapLib.extractCommonParameters(posArray, params, i, scheme);\n        if (params.render !== undefined) {\n          posArray.render = params.render;\n        }\n        if (posArray.render === 'weightedDots') {\n          MapLib.validateWeightedDotsPositionArray(posArray, params);\n        }\n        if (posArray.render === 'coloredWeightedDots') {\n          MapLib.validateWeightedColoredDotsPositionArray(posArray, params);\n        }\n        if (posArray.render === 'marker') {\n          posArray.marker = params.marker;\n        }\n        this.LOG.debug(['toLeafletMapPositionArray', 'posArray'], posArray);\n        positions.push(posArray);\n      }\n    }\n    return positions;\n  }\n\n  private static validateWeightedColoredDotsPositionArray(posArray: any, params: any) {\n    if (!MapLib.validateWeightedDotsPositionArray(posArray, params)) {\n      return;\n    }\n    if (params.minColorValue === undefined ||\n      params.maxColorValue === undefined ||\n      params.startColor === undefined ||\n      params.endColor === undefined) {\n      MapLib.LOG.error(['validateWeightedColoredDotsPositionArray'], 'When using ' +\n        '\\'weightedColoredDots\\' rendering, \\'maxColorValue\\', \\'minColorValue\\', \\'startColor\\' ' +\n        'and \\'endColor\\' parameters are compulsory');\n      posArray.render = undefined;\n      return;\n    }\n\n    posArray.maxColorValue = params.maxColorValue;\n    posArray.minColorValue = params.minColorValue;\n\n    if (typeof posArray.minColorValue !== 'number' ||\n      typeof posArray.maxColorValue !== 'number' ||\n      posArray.minColorValue >= posArray.maxColorValue) {\n      MapLib.LOG.error(['validateWeightedColoredDotsPositionArray'], ['When using ' +\n      'weightedColoredDots\\' rendering, \\'maxColorValue\\' and \\'minColorValue\\' must be numbers ' +\n      'and \\'maxColorValue\\' must be greater than \\'minColorValue\\'', {\n        maxColorValue: posArray.maxColorValue,\n        minColorValue: posArray.minColorValue,\n      }]);\n      posArray.render = undefined;\n      return;\n    }\n    const re = /^#(?:[0-9a-f]{3}){1,2}$/i;\n    if (typeof params.startColor !== 'string'\n      || typeof params.endColor !== 'string'\n      || !re.test(params.startColor)\n      || !re.test(params.endColor)) {\n      MapLib.LOG.error(['validateWeightedColoredDotsPositionArray'], ['When using ' +\n      'weightedColoredDots\\' rendering, \\'startColor\\' and \\'endColor\\' parameters must be RGB ' +\n      'colors in #rrggbb format', {\n        startColor: params.startColor,\n        endColor: params.endColor,\n        tests: [\n          typeof params.startColor,\n          typeof params.endColor,\n          re.test(params.startColor),\n          re.test(params.endColor),\n          re.test(params.startColor),\n        ],\n      }]);\n      posArray.render = undefined;\n      return;\n    }\n\n    posArray.startColor = {\n      r: parseInt(params.startColor.substring(1, 3), 16),\n      g: parseInt(params.startColor.substring(3, 5), 16),\n      b: parseInt(params.startColor.substring(5, 7), 16),\n    };\n\n    posArray.endColor = {\n      r: parseInt(params.endColor.substring(1, 3), 16),\n      g: parseInt(params.endColor.substring(3, 5), 16),\n      b: parseInt(params.endColor.substring(5, 7), 16),\n    };\n\n    if (params.numColorSteps === undefined ||\n      isNaN(parseInt(params.numColorSteps, 10)) ||\n      parseInt(params.numColorSteps, 10) < 0) {\n      posArray.numColorSteps = 5;\n    } else {\n      posArray.numColorSteps = params.numColorSteps;\n    }\n\n    posArray.colorGradient = ColorLib.hsvGradientFromRgbColors(\n      posArray.startColor,\n      posArray.endColor,\n      posArray.numColorSteps);\n\n    const step = (posArray.maxColorValue - posArray.minColorValue) / posArray.numColorSteps;\n    const steps = [];\n    for (let j = 0; j < posArray.numColorSteps; j++) {\n      steps[j] = posArray.minColorValue + (j + 1) * step;\n    }\n\n    posArray.steps = steps;\n\n    posArray.positions.forEach(pos => {\n      const colorValue = pos[3];\n      pos[5] = posArray.numColorSteps - 1;\n      for (let k = 0; k < steps.length - 1; k++) {\n        if (colorValue < steps[k]) {\n          pos[5] = k;\n          break;\n        }\n      }\n    });\n  }\n\n  static getBoundsArray(paths, positionsData, annotationsData, geoJson) {\n    const pointsArray = [];\n    let size;\n    this.LOG.debug(['getBoundsArray', 'paths'], paths);\n    size = (paths || []).length;\n    for (let i = 0; i < size; i++) {\n      const path = paths[i];\n      const s = (path.path || []).length;\n      for (let j = 0; j < s; j++) {\n        const p = path.path[j];\n        pointsArray.push([p.lat, p.lon]);\n      }\n    }\n    this.LOG.debug(['getBoundsArray', 'positionsData'], positionsData);\n    size = (positionsData || []).length;\n    for (let i = 0; i < size; i++) {\n      const position = positionsData[i];\n      const s = (position.positions || []).length;\n      for (let j = 0; j < s; j++) {\n        const p = position.positions[j];\n        pointsArray.push([p[0], p[1]]);\n      }\n    }\n    this.LOG.debug(['getBoundsArray', 'annotationsData'], annotationsData);\n    size = (annotationsData || []).length;\n    for (let i = 0; i < size; i++) {\n      const annotation = annotationsData[i];\n      const s = (annotation.path || []).length;\n      for (let j = 0; j < s; j++) {\n        const p = annotation.path[j];\n        pointsArray.push([p.lat, p.lon]);\n      }\n    }\n    size = (geoJson || []).length;\n    for (let i = 0; i < size; i++) {\n      const g = geoJson[i];\n      switch (g.geometry.type) {\n        case 'MultiPolygon':\n          g.geometry.coordinates.forEach(c => c.forEach(m => m.forEach(p => pointsArray.push([p[1], p[0]]))));\n          break;\n        case 'Polygon':\n          g.geometry.coordinates.forEach(c => c.forEach(p => pointsArray.push([p[1], p[0]])));\n          break;\n        case 'LineString':\n          g.geometry.coordinates.forEach(p => pointsArray.push([p[1], p[0]]));\n          break;\n        case 'Point':\n          pointsArray.push([g.geometry.coordinates[1], g.geometry.coordinates[0]]);\n          break;\n      }\n    }\n    if (pointsArray.length === 1) {\n      return pointsArray;\n    }\n    let south = 90;\n    let west = -180;\n    let north = -90;\n    let east = 180;\n    this.LOG.debug(['getBoundsArray'], pointsArray);\n    size = (pointsArray || []).length;\n    for (let i = 0; i < size; i++) {\n      const point = pointsArray[i];\n      if (point[0] > north) {\n        north = point[0];\n      }\n      if (point[0] < south) {\n        south = point[0];\n      }\n      if (point[1] > west) {\n        west = point[1];\n      }\n      if (point[1] < east) {\n        east = point[1];\n      }\n    }\n    return [[south, west], [north, east]];\n  }\n\n  static pathDataToLeaflet(pathData, options) {\n    const path = [];\n    const firstIndex = ((options === undefined) ||\n      (options.from === undefined) ||\n      (options.from < 0)) ? 0 : options.from;\n    const lastIndex = ((options === undefined) || (options.to === undefined) || (options.to >= pathData.length)) ?\n      pathData.length - 1 : options.to;\n    for (let i = firstIndex; i <= lastIndex; i++) {\n      path.push([pathData[i].lat, pathData[i].lon]);\n    }\n    return path;\n  }\n\n  static toGeoJSON(data: { gts: any[]; params: any[] }) {\n    const defShapes = ['Point', 'LineString', 'Polygon', 'MultiPolygon'];\n    const geoJsons = [];\n    data.gts.forEach(d => {\n      if (d.type && d.type === 'Feature' && d.geometry && d.geometry.type && defShapes.indexOf(d.geometry.type) > -1) {\n        geoJsons.push(d);\n      } else if (d.type && defShapes.indexOf(d.type) > -1) {\n        geoJsons.push({type: 'Feature', geometry: d});\n      }\n    });\n    return geoJsons;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, EventEmitter, Input, OnInit, Output, Renderer2, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {Param} from '../../model/param';\nimport {Logger} from '../../utils/logger';\nimport Leaflet, {TileLayerOptions} from 'leaflet';\nimport 'leaflet.heat';\nimport 'leaflet.markercluster';\nimport {ColorLib} from '../../utils/color-lib';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {DataModel} from '../../model/dataModel';\nimport {MapLib} from '../../utils/map-lib';\nimport {GTSLib} from '../../utils/gts.lib';\nimport moment from 'moment-timezone';\nimport deepEqual from 'deep-equal';\nimport {SizeService} from '../../services/resize.service';\nimport {Timsort} from '../../utils/timsort';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-map',\n  templateUrl: './warp-view-map.component.html',\n  styleUrls: ['./warp-view-map.component.scss'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class WarpViewMapComponent implements OnInit {\n\n  @ViewChild('mapDiv', {static: true}) mapDiv: ElementRef<HTMLDivElement>;\n  @ViewChild('wrapper', {static: true}) wrapper: ElementRef<HTMLDivElement>;\n  @ViewChild('timeSlider', {static: false}) timeSlider: ElementRef<HTMLDivElement>;\n  @ViewChild('timeRangeSlider', {static: false}) timeRangeSlider: ElementRef<HTMLDivElement>;\n\n  @Input('heatData') heatData: any[] = [];\n  @Input('responsive') responsive = false;\n  @Input('showLegend') showLegend = true;\n  @Input('width') width = ChartLib.DEFAULT_WIDTH;\n  @Input('height') height = ChartLib.DEFAULT_HEIGHT;\n  private bounds: Leaflet.LatLngBounds;\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Input('options') set options(options: Param) {\n    this.LOG.debug(['onOptions'], options);\n    if (!deepEqual(this._options, options)) {\n      const reZoom =\n        options.map.startZoom !== this._options.map.startZoom\n        || options.map.startLat !== this._options.map.startLat\n        || options.map.startLong !== this._options.map.startLong;\n      this._options = options;\n      this.divider = GTSLib.getDivider(this._options.timeUnit);\n      this.drawMap(reZoom);\n    }\n  }\n\n  @Input('data') set data(data: any) {\n    this.LOG.debug(['onData'], data);\n    this.currentValuesMarkers = [];\n    this.annotationsMarkers = [];\n    this.positionArraysMarkers = [];\n    if (!!data) {\n      this._data = data;\n      this.drawMap(true);\n    }\n  }\n\n  get data() {\n    return this._data;\n  }\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    this._hiddenData = hiddenData;\n    this.drawMap(false);\n  }\n\n  get hiddenData(): number[] {\n    return this._hiddenData;\n  }\n\n  @Output('change') change = new EventEmitter();\n  @Output('chartDraw') chartDraw = new EventEmitter();\n\n  currentZoom: number;\n  currentLat: number;\n  currentLong: number;\n  minTimeValue: number;\n  maxTimeValue: number;\n  divider = 1;\n  lowerTimeBound: number;\n  upperTimeBound: number;\n  timeSpan: number;\n  _options: Param = new Param();\n\n  private _firstDraw = true;\n  private LOG: Logger;\n  private _data: any;\n  private _debug = false;\n  private defOptions: Param = ChartLib.mergeDeep<Param>(\n    new Param(), {\n      map: {\n        heatControls: false,\n        tiles: [],\n        dotsLimit: 1000,\n      },\n      timeMode: 'date',\n      showRangeSelector: true,\n      gridLineColor: '#8e8e8e',\n      showDots: false,\n      timeZone: 'UTC',\n      timeUnit: 'us',\n      bounds: {}\n    });\n\n  private _map: Leaflet.Map;\n  private _hiddenData: number[];\n  private currentValuesMarkers = [];\n  private annotationsMarkers = [];\n  private positionArraysMarkers = [];\n  private _iconAnchor: Leaflet.PointExpression = [20, 52];\n  private _popupAnchor: Leaflet.PointExpression = [0, -50];\n  private _heatLayer: any;\n  private pathData: any[] = [];\n  private annotationsData: any[] = [];\n  private positionData: any[] = [];\n  private geoJson: any[] = [];\n  private timeStart: number;\n  private timeEnd: number;\n  private firstDraw = true;\n  private finalHeight = 0;\n  // Layers\n  private pathDataLayer = Leaflet.featureGroup();\n  private annotationsDataLayer = Leaflet.featureGroup();\n  private positionDataLayer = Leaflet.featureGroup();\n  private tileLayerGroup = Leaflet.featureGroup();\n  private geoJsonLayer = Leaflet.featureGroup();\n  private tilesLayer: Leaflet.TileLayer;\n\n  constructor(public el: ElementRef, public sizeService: SizeService, private renderer: Renderer2) {\n    this.LOG = new Logger(WarpViewMapComponent, this.debug);\n    this.LOG.debug(['constructor'], this.debug);\n    this.sizeService.sizeChanged$.subscribe(() => {\n      if (this._map) {\n        this.resizeMe();\n      }\n    });\n  }\n\n  ngOnInit(): void {\n    this._options = ChartLib.mergeDeep(this._options, this.defOptions) as Param;\n  }\n\n  resizeMe() {\n    this.LOG.debug(['resizeMe'], this.wrapper.nativeElement.parentElement.getBoundingClientRect());\n    let height = this.wrapper.nativeElement.parentElement.getBoundingClientRect().height;\n    const width = this.wrapper.nativeElement.parentElement.getBoundingClientRect().width;\n    if (this._options.map.showTimeSlider && this.timeSlider && this.timeSlider.nativeElement) {\n      height -= this.timeSlider.nativeElement.getBoundingClientRect().height;\n    }\n    if (this._options.map.showTimeRange && this.timeRangeSlider && this.timeRangeSlider.nativeElement) {\n      height -= this.timeRangeSlider.nativeElement.getBoundingClientRect().height;\n    }\n    this.finalHeight = height;\n    this.renderer.setStyle(this.mapDiv.nativeElement, 'width', 'calc(' + width + 'px - '\n      + getComputedStyle(this.wrapper.nativeElement).getPropertyValue('--warp-view-map-margin').trim()\n      + ' - '\n      + getComputedStyle(this.wrapper.nativeElement).getPropertyValue('--warp-view-map-margin').trim()\n      + ')');\n    this.renderer.setStyle(this.mapDiv.nativeElement, 'height', 'calc(' + height + 'px - '\n      + getComputedStyle(this.wrapper.nativeElement).getPropertyValue('--warp-view-map-margin').trim()\n      + ' - '\n      + getComputedStyle(this.wrapper.nativeElement).getPropertyValue('--warp-view-map-margin').trim()\n      + ')');\n    this.width = width;\n    this.height = height;\n    if (!!this._map) {\n      setTimeout(() => this._map.invalidateSize());\n    }\n  }\n\n  heatRadiusDidChange(event) {\n    this._heatLayer.setOptions({radius: event.detail.valueAsNumber});\n    this.LOG.debug(['heatRadiusDidChange'], event.detail.valueAsNumber);\n  }\n\n  heatBlurDidChange(event) {\n    this._heatLayer.setOptions({blur: event.detail.valueAsNumber});\n    this.LOG.debug(['heatBlurDidChange'], event.detail.valueAsNumber);\n  }\n\n  heatOpacityDidChange(event) {\n    const minOpacity = event.detail.valueAsNumber / 100;\n    this._heatLayer.setOptions({minOpacity});\n    this.LOG.debug(['heatOpacityDidChange'], event.detail.valueAsNumber);\n  }\n\n  private drawMap(reZoom: boolean) {\n    this.LOG.debug(['drawMap'], this._data);\n    this._options = ChartLib.mergeDeep<Param>(this._options, this.defOptions);\n    this.timeStart = this._options.map.timeStart;\n    moment.tz.setDefault(this._options.timeZone);\n    let gts: any = this._data;\n    if (!gts) {\n      return;\n    }\n    if (typeof gts === 'string') {\n      try {\n        gts = JSON.parse(gts as string);\n      } catch (error) {\n        return;\n      }\n    }\n    if (GTSLib.isArray(gts) && gts[0] && (gts[0] instanceof DataModel || gts[0].hasOwnProperty('data'))) {\n      gts = gts[0];\n    }\n    if (!!this._map) {\n      this._map.invalidateSize(true);\n    }\n    let dataList: any[];\n    let params: any[];\n    if (gts.data) {\n      dataList = gts.data as any[];\n      this._options = ChartLib.mergeDeep<Param>(gts.globalParams || {}, this._options);\n      this.timeSpan = this.timeSpan || this._options.map.timeSpan;\n      params = gts.params;\n    } else {\n      dataList = gts;\n      params = [];\n    }\n    this.divider = GTSLib.getDivider(this._options.timeUnit);\n    this.LOG.debug(['drawMap'], dataList, this._options, gts.globalParams);\n    const flattenGTS = GTSLib.flatDeep(dataList);\n\n    const size = flattenGTS.length;\n    for (let i = 0; i < size; i++) {\n      const item = flattenGTS[i];\n      if (item.v) {\n        Timsort.sort(item.v, (a, b) => a[0] - b[0]);\n        item.i = i;\n        i++;\n      }\n    }\n    this.LOG.debug(['GTSLib.flatDeep(dataList)'], flattenGTS);\n    this.displayMap({gts: flattenGTS, params}, reZoom);\n  }\n\n  private icon(color: string, marker = '') {\n    const c = `${color.slice(1)}`;\n    const m = marker !== '' ? marker : 'circle';\n    return Leaflet.icon({\n      iconUrl: `https://cdn.mapmarker.io/api/v1/font-awesome/v4/pin?icon=fa-${m}&iconSize=17&size=40&hoffset=${m === 'circle' ? 0 : -1}&voffset=-4&color=fff&background=${c}`,\n      iconAnchor: this._iconAnchor,\n      popupAnchor: this._popupAnchor\n    });\n  }\n\n  private patchMapTileGapBug() {\n    // Workaround for 1px lines appearing in some browsers due to fractional transforms\n    // and resulting anti-aliasing. adapted from @cmulders' solution:\n    // https://github.com/Leaflet/Leaflet/issues/3575#issuecomment-150544739\n    // @ts-ignore\n    const originalInitTile = Leaflet.GridLayer.prototype._initTile;\n    if (originalInitTile.isPatched) {\n      return;\n    }\n    Leaflet.GridLayer.include({\n      _initTile(tile) {\n        originalInitTile.call(this, tile);\n        const tileSize = this.getTileSize();\n        tile.style.width = tileSize.x + 1.5 + 'px';\n        tile.style.height = tileSize.y + 1 + 'px';\n      }\n    });\n    // @ts-ignore\n    Leaflet.GridLayer.prototype._initTile.isPatched = true;\n  }\n\n  private displayMap(data: { gts: any[], params: any[] }, reDraw = false) {\n    this.currentValuesMarkers = [];\n    this.LOG.debug(['drawMap'], data, this._options, this._hiddenData || []);\n    if (!this.lowerTimeBound) {\n      this.lowerTimeBound = this._options.map.timeSliderMin / this.divider;\n      this.upperTimeBound = this._options.map.timeSliderMax / this.divider;\n    }\n    let height = this.height || ChartLib.DEFAULT_HEIGHT;\n    const width = this.width || ChartLib.DEFAULT_WIDTH;\n    if (this.responsive && this.finalHeight === 0) {\n      this.resizeMe();\n    } else {\n      if (this._options.map.showTimeSlider && this.timeSlider && this.timeSlider.nativeElement) {\n        height -= this.timeSlider.nativeElement.getBoundingClientRect().height;\n      }\n      if (this._options.map.showTimeRange && this.timeRangeSlider && this.timeRangeSlider.nativeElement) {\n        height -= this.timeRangeSlider.nativeElement.getBoundingClientRect().height;\n      }\n    }\n    this.width = width;\n    this.height = height;\n    if (data.gts.length === 0) {\n      return;\n    }\n    this.pathData = MapLib.toLeafletMapPaths(data, this._hiddenData || [], this.divider, this._options.scheme) || [];\n    this.annotationsData = MapLib.annotationsToLeafletPositions(data, this._hiddenData, this.divider, this._options.scheme) || [];\n    this.positionData = MapLib.toLeafletMapPositionArray(data, this._hiddenData || [], this._options.scheme) || [];\n    this.geoJson = MapLib.toGeoJSON(data);\n    this.LOG.debug(['displayMap'], this.pathData, this.annotationsData, this.positionData);\n\n    if (this._options.map.mapType !== 'NONE') {\n      const map = MapLib.mapTypes[this._options.map.mapType || 'DEFAULT'];\n      const mapOpts: TileLayerOptions = {\n        maxZoom: 24,\n        maxNativeZoom: 19,\n      };\n      if (map.attribution) {\n        mapOpts.attribution = map.attribution;\n      }\n      if (map.subdomains) {\n        mapOpts.subdomains = map.subdomains;\n      }\n      this.tilesLayer = Leaflet.tileLayer(map.link, mapOpts);\n    }\n\n    if (!!this._map) {\n      this.LOG.debug(['displayMap'], 'map exists');\n      this.pathDataLayer.clearLayers();\n      this.annotationsDataLayer.clearLayers();\n      this.positionDataLayer.clearLayers();\n      this.geoJsonLayer.clearLayers();\n      this.tileLayerGroup.clearLayers();\n    } else {\n      this.LOG.debug(['displayMap'], 'build map');\n      this._map = Leaflet.map(this.mapDiv.nativeElement, {\n        preferCanvas: true,\n        layers: [this.tileLayerGroup, this.geoJsonLayer, this.pathDataLayer, this.annotationsDataLayer, this.positionDataLayer],\n        zoomAnimation: true,\n        maxZoom: 24\n      });\n      this.tilesLayer.addTo(this._map);\n      this.LOG.debug(['displayMap'], 'build map', this.tilesLayer);\n      this.geoJsonLayer.bringToBack();\n      this.tilesLayer.bringToBack(); // TODO: tester\n      this._map.on('load', () => this.LOG.debug(['displayMap', 'load'], this._map.getCenter().lng, this.currentLong, this._map.getZoom()));\n      this._map.on('zoomend', () => {\n        if (!this.firstDraw) {\n          this.LOG.debug(['moveend'], this._map.getCenter());\n          this.currentZoom = this._map.getZoom();\n        }\n      });\n      this._map.on('moveend', () => {\n        if (!this.firstDraw) {\n          this.LOG.debug(['moveend'], this._map.getCenter());\n          this.currentLat = this._map.getCenter().lat;\n          this.currentLong = this._map.getCenter().lng;\n        }\n      });\n    }\n\n    let size = (this.pathData || []).length;\n    this.LOG.debug(['displayMap'], 'build map done', size);\n    for (let i = 0; i < size; i++) {\n      const d = this.pathData[i];\n      if (!!d) {\n        const plottedGts: any = this.updateGtsPath(d);\n        if (!!plottedGts) {\n          this.currentValuesMarkers.push(plottedGts.beforeCurrentValue);\n          this.currentValuesMarkers.push(plottedGts.afterCurrentValue);\n          this.currentValuesMarkers.push(plottedGts.currentValue);\n        }\n      }\n    }\n    this.LOG.debug(['displayMap'], 'this.pathData', this.pathData);\n    size = (this.annotationsData || []).length;\n    for (let i = 0; i < size; i++) {\n      const d = this.annotationsData[i];\n      const plottedGts: any = this.updateGtsPath(d);\n      if (!!plottedGts) {\n        if (d.render === 'line') {\n          this.currentValuesMarkers.push(plottedGts.beforeCurrentValue);\n          this.currentValuesMarkers.push(plottedGts.afterCurrentValue);\n        }\n        this.currentValuesMarkers.push(plottedGts.currentValue);\n      }\n    }\n    if (!!this._map) {\n      this.pathDataLayer = Leaflet.featureGroup(this.currentValuesMarkers || []).addTo(this._map);\n    }\n    this.LOG.debug(['displayMap', 'annotationsMarkers'], this.annotationsMarkers);\n    this.LOG.debug(['displayMap', 'this.hiddenData'], this.hiddenData);\n    this.LOG.debug(['displayMap', 'this.positionData'], this.positionData);\n    // Create the positions arrays\n    size = (this.positionData || []).length;\n    for (let i = 0; i < size; i++) {\n      const d = this.positionData[i];\n      this.positionArraysMarkers = this.positionArraysMarkers.concat(this.updatePositionArray(d));\n    }\n    this.LOG.debug(['displayMap'], 'this.po sitionData');\n    size = (this.annotationsData || []).length;\n    for (let i = 0; i < size; i++) {\n      const d = this.annotationsData[i];\n      this.positionArraysMarkers = this.positionArraysMarkers.concat(this.updateAnnotation(d));\n    }\n    this.LOG.debug(['displayMap'], 'this.annotationsData');\n\n    (this._options.map.tiles || []).forEach((t) => { // TODO to test\n      this.LOG.debug(['displayMap'], t);\n      if (this._options.map.showTimeRange) {\n        this.tileLayerGroup.addLayer(Leaflet.tileLayer(t\n            .replace('{start}', moment(this.timeStart).toISOString())\n            .replace('{end}', moment(this.timeEnd).toISOString()), {\n            subdomains: 'abcd',\n            maxNativeZoom: 19,\n            maxZoom: 40\n          }\n        ));\n      } else {\n        this.tileLayerGroup.addLayer(Leaflet.tileLayer(t, {\n          subdomains: 'abcd',\n          maxNativeZoom: 19,\n          maxZoom: 40\n        }));\n      }\n    });\n    this.LOG.debug(['displayMap'], 'this.tiles');\n\n    this.LOG.debug(['displayMap', 'positionArraysMarkers'], this.positionArraysMarkers);\n    this.LOG.debug(['displayMap', 'annotationsMarkers'], this.annotationsMarkers);\n\n    size = (this.positionArraysMarkers || []).length;\n    for (let i = 0; i < size; i++) {\n      const m = this.positionArraysMarkers[i];\n      m.addTo(this.positionDataLayer);\n    }\n    size = (this.annotationsMarkers || []).length;\n    for (let i = 0; i < size; i++) {\n      const m = this.annotationsMarkers[i];\n      m.addTo(this.annotationsDataLayer);\n    }\n\n    this.LOG.debug(['displayMap', 'geoJson'], this.geoJson);\n    size = (this.geoJson || []).length;\n    for (let i = 0; i < size; i++) {\n      const m = this.geoJson[i];\n      const color = ColorLib.getColor(i, this._options.scheme);\n      const opts = {\n        style: () => ({\n          color: (data.params && data.params[i]) ? data.params[i].color || color : color,\n          fillColor: (data.params && data.params[i])\n            ? ColorLib.transparentize(data.params[i].fillColor || color)\n            : ColorLib.transparentize(color),\n        })\n      } as any;\n      if (m.geometry.type === 'Point') {\n        opts.pointToLayer = (geoJsonPoint, latlng) => Leaflet.marker(latlng, {\n          icon: this.icon(color, (data.params && data.params[i]) ? data.params[i].marker : 'circle'),\n          opacity: 1,\n        });\n      }\n      let display = '';\n      const geoShape = Leaflet.geoJSON(m, opts);\n      if (m.properties) {\n        Object.keys(m.properties).forEach(k => display += `<b>${k}</b>: ${m.properties[k]}<br />`);\n        geoShape.bindPopup(display);\n      }\n      geoShape.addTo(this.geoJsonLayer);\n    }\n    if (this.pathData.length > 0 || this.positionData.length > 0 || this.annotationsData.length > 0 || this.geoJson.length > 0) {\n      // Fit map to curves\n      const group = Leaflet.featureGroup([this.geoJsonLayer, this.annotationsDataLayer, this.positionDataLayer, this.pathDataLayer]);\n      this.LOG.debug(['displayMap', 'setView'], 'fitBounds', group.getBounds());\n      this.LOG.debug(['displayMap', 'setView'], {lat: this.currentLat, lng: this.currentLong}, {\n        lat: this._options.map.startLat,\n        lng: this._options.map.startLong\n      });\n      this.bounds = group.getBounds();\n      setTimeout(() => {\n        if (!!this.bounds && this.bounds.isValid()) {\n          if ((this.currentLat || this._options.map.startLat) && (this.currentLong || this._options.map.startLong)) {\n            this._map.setView({\n                lat: this.currentLat || this._options.map.startLat || 0,\n                lng: this.currentLong || this._options.map.startLong || 0\n              }, this.currentZoom || this._options.map.startZoom || 10,\n              {animate: false, duration: 500});\n          } else {\n            this._map.fitBounds(this.bounds, {padding: [1, 1], animate: false, duration: 0});\n            //   this.currentZoom = this._map.getBoundsZoom(this.bounds, false);\n          }\n          this.currentLat = this._map.getCenter().lat;\n          this.currentLong = this._map.getCenter().lng;\n          //  this.currentZoom = this._map.getZoom();\n        } else {\n          this.LOG.debug(['displayMap', 'setView'], {lat: this.currentLat, lng: this.currentLong});\n          this._map.setView({\n              lat: this.currentLat || this._options.map.startLat || 0,\n              lng: this.currentLong || this._options.map.startLong || 0\n            }, this.currentZoom || this._options.map.startZoom || 10,\n            {\n              animate: false,\n              duration: 500\n            });\n        }\n      }, 10);\n    } else {\n      this.LOG.debug(['displayMap', 'lost'], 'lost', this.currentZoom, this._options.map.startZoom);\n      this._map.setView(\n        [\n          this.currentLat || this._options.map.startLat || 0,\n          this.currentLong || this._options.map.startLong || 0\n        ],\n        this.currentZoom || this._options.map.startZoom || 2,\n        {\n          animate: false,\n          duration: 0\n        }\n      );\n    }\n    if (this.heatData && this.heatData.length > 0) {\n      this._heatLayer = (Leaflet as any).heatLayer(this.heatData, {\n        radius: this._options.map.heatRadius,\n        blur: this._options.map.heatBlur,\n        minOpacity: this._options.map.heatOpacity\n      });\n      this._heatLayer.addTo(this._map);\n    }\n    this.firstDraw = false;\n    this.resizeMe();\n    this.patchMapTileGapBug();\n    this.chartDraw.emit(true);\n  }\n\n  updateAnnotation(gts) {\n    const positions = [];\n    let icon;\n    let size;\n    switch (gts.render) {\n      case 'marker':\n        icon = this.icon(gts.color, gts.marker);\n        size = (gts.path || []).length;\n        for (let i = 0; i < size; i++) {\n          const g = gts.path[i];\n          const marker = Leaflet.marker(g, {icon, opacity: 1});\n          marker.bindPopup(g.val.toString());\n          positions.push(marker);\n        }\n        break;\n      case 'weightedDots':\n        size = (gts.path || []).length;\n        for (let i = 0; i < size; i++) {\n          const p = gts.path[i];\n          if ((this._hiddenData || []).filter(h => h === gts.key).length === 0) {\n            let v = parseInt(p.val, 10);\n            if (isNaN(v)) {\n              v = 0;\n            }\n            const radius = (v - (gts.minValue || 0)) * 50 / (gts.maxValue || 50);\n            const marker = Leaflet.circleMarker(\n              p, {\n                radius: radius === 0 ? 1 : radius,\n                color: gts.borderColor,\n                fillColor: gts.color, fillOpacity: 0.5,\n                weight: 1\n              });\n            this.addPopup(gts, p.val, marker);\n            positions.push(marker);\n          }\n        }\n        break;\n      case 'dots':\n      default:\n        size = (gts.path || []).length;\n        for (let i = 0; i < size; i++) {\n          const g = gts.path[i];\n          const marker = Leaflet.circleMarker(\n            g, {\n              radius: gts.baseRadius,\n              color: gts.color,\n              fillColor: gts.color,\n              fillOpacity: 1\n            }\n          );\n          marker.bindPopup(g.val.toString());\n          positions.push(marker);\n        }\n        break;\n    }\n    return positions;\n  }\n\n  private updateGtsPath(gts: any) {\n    const beforeCurrentValue = Leaflet.polyline(\n      MapLib.pathDataToLeaflet(gts.path, {to: 0}), {\n        color: gts.color,\n        opacity: 1,\n      });\n    const afterCurrentValue = Leaflet.polyline(\n      MapLib.pathDataToLeaflet(gts.path, {from: 0}), {\n        color: gts.color,\n        opacity: 0.7,\n      });\n    let currentValue;\n    // Let's verify we have a path... No path, no marker\n    const size = (gts.path || []).length;\n    for (let i = 0; i < size; i++) {\n      const p = gts.path[i];\n      let date;\n      if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n        date = parseInt(p.ts, 10);\n      } else {\n        date = (moment(parseInt(p.ts, 10))\n          .utc(true).toISOString() || '')\n          .replace('Z', this._options.timeZone === 'UTC' ? 'Z' : '');\n      }\n      currentValue = Leaflet.circleMarker([p.lat, p.lon],\n        {radius: MapLib.BASE_RADIUS, color: gts.color, fillColor: gts.color, fillOpacity: 0.7})\n        .bindPopup(`<p>${date}</p><p><b>${gts.key}</b>: ${p.val.toString()}</p>`);\n    }\n    if (size > 0) {\n      return {\n        beforeCurrentValue,\n        afterCurrentValue,\n        currentValue,\n      };\n    } else {\n      return undefined;\n    }\n  }\n\n  private addPopup(positionData: any, value: any, marker: any) {\n    if (!!positionData) {\n      let content = '';\n      if (positionData.key) {\n        content = `<p><b>${positionData.key}</b>: ${value || 'na'}</p>`;\n      }\n      Object.keys(positionData.properties || []).forEach(k => content += `<b>${k}</b>: ${positionData.properties[k]}<br />`);\n      marker.bindPopup(content);\n    }\n  }\n\n  private updatePositionArray(positionData: any) {\n    const positions = [];\n    let polyline;\n    let icon;\n    let result;\n    let inStep;\n    let size;\n    this.LOG.debug(['updatePositionArray'], positionData);\n    switch (positionData.render) {\n      case 'path':\n        polyline = Leaflet.polyline(positionData.positions, {color: positionData.color, opacity: 1});\n        positions.push(polyline);\n        break;\n      case 'marker':\n        icon = this.icon(positionData.color, positionData.marker);\n        size = (positionData.positions || []).length;\n        for (let i = 0; i < size; i++) {\n          const p = positionData.positions[i];\n          if ((this.hiddenData || []).filter(h => h === positionData.key).length === 0) {\n            const marker = Leaflet.marker({lat: p[0], lng: p[1]}, {icon, opacity: 1});\n            this.addPopup(positionData, p[2], marker);\n            positions.push(marker);\n          }\n          this.LOG.debug(['updatePositionArray', 'build marker'], icon);\n        }\n        break;\n      case 'coloredWeightedDots':\n        this.LOG.debug(['updatePositionArray', 'coloredWeightedDots'], positionData);\n        result = [];\n        inStep = [];\n        for (let j = 0; j < positionData.numColorSteps; j++) {\n          result[j] = 0;\n          inStep[j] = 0;\n        }\n        size = (positionData.positions || []).length;\n        for (let i = 0; i < size; i++) {\n          const p = positionData.positions[i];\n          if ((this._hiddenData || []).filter(h => h === positionData.key).length === 0) {\n            this.LOG.debug(['updatePositionArray', 'coloredWeightedDots', 'radius'], positionData.baseRadius * p[4]);\n            const marker = Leaflet.circleMarker(\n              {lat: p[0], lng: p[1]},\n              {\n                radius: positionData.baseRadius * (parseInt(p[4], 10) + 1),\n                color: positionData.borderColor,\n                fillColor: ColorLib.rgb2hex(\n                  positionData.colorGradient[p[5]].r,\n                  positionData.colorGradient[p[5]].g,\n                  positionData.colorGradient[p[5]].b),\n                fillOpacity: 0.7,\n              });\n            this.addPopup(positionData, p[2], marker);\n            positions.push(marker);\n          }\n        }\n        break;\n      case 'weightedDots':\n        size = (positionData.positions || []).length;\n        for (let i = 0; i < size; i++) {\n          const p = positionData.positions[i];\n          if ((this._hiddenData || []).filter(h => h === positionData.key).length === 0) {\n            const marker = Leaflet.circleMarker(\n              {lat: p[0], lng: p[1]}, {\n                radius: positionData.baseRadius * (parseInt(p[4], 10) + 1),\n                color: positionData.borderColor,\n                fillColor: positionData.color, fillOpacity: 0.7,\n              });\n            this.addPopup(positionData, p[2], marker);\n            positions.push(marker);\n          }\n        }\n        break;\n      case 'dots':\n      default:\n        size = (positionData.positions || []).length;\n        for (let i = 0; i < size; i++) {\n          const p = positionData.positions[i];\n          if ((this._hiddenData || []).filter(h => h === positionData.key).length === 0) {\n            const marker = Leaflet.circleMarker(\n              {lat: p[0], lng: p[1]}, {\n                radius: positionData.baseRadius,\n                color: positionData.borderColor,\n                fillColor: positionData.color,\n                fillOpacity: 1,\n              });\n            this.addPopup(positionData, p[2], marker);\n            positions.push(marker);\n          }\n        }\n        break;\n    }\n    return positions;\n  }\n\n  public resize(): Promise<boolean> {\n    return new Promise<boolean>(resolve => {\n      this.resizeMe();\n      resolve(true);\n    });\n  }\n\n  onRangeSliderChange(event) {\n    this.LOG.debug(['onRangeSliderChange'], event);\n    this.timeStart = event.value || moment().valueOf();\n    this.timeEnd = event.highValue || moment().valueOf();\n    this.drawMap(true);\n  }\n\n  onRangeSliderWindowChange(event) {\n    this.LOG.debug(['onRangeSliderWindowChange'], event);\n    if (this.lowerTimeBound !== event.min || this.upperTimeBound !== event.max) {\n      this.lowerTimeBound = event.min;\n      this.upperTimeBound = event.max;\n    }\n  }\n\n  onSliderChange(event) {\n    this.LOG.debug(['onSliderChange'], event, moment(event.value).toISOString());\n    this._firstDraw = false;\n    if (this.timeEnd !== event.value) {\n      this.timeSpan = this.timeSpan || this._options.map.timeSpan;\n      this.timeEnd = event.value || moment().valueOf();\n      this.timeStart = (event.value || moment().valueOf()) - this.timeSpan / this.divider;\n      this.LOG.debug(['onSliderChange'], moment(this.timeStart).toISOString(), moment(this.timeEnd).toISOString());\n      this.change.emit(this.timeStart);\n      this.drawMap(true);\n    }\n  }\n\n  updateTimeSpan(event) {\n    this.LOG.debug(['updateTimeSpan'], event.target.value);\n    if (this.timeSpan !== event.target.value) {\n      this.timeSpan = event.target.value;\n      this.timeStart = (this.timeEnd || moment().valueOf()) - this.timeSpan / this.divider;\n      this.drawMap(true);\n    }\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, EventEmitter, Input, Output, ViewEncapsulation} from '@angular/core';\n\n@Component({\n  selector: 'warpview-heatmap-sliders',\n  templateUrl: './warp-view-heatmap-sliders.component.html',\n  styleUrls: ['./warp-view-heatmap-sliders.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewHeatmapSlidersComponent {\n\n  @Input('radiusValue') radiusValue: number;\n  @Input('minRadiusValue') minRadiusValue: number;\n  @Input('maxRadiusValue') maxRadiusValue: number;\n  @Input('blurValue') blurValue: number;\n  @Input('minBlurValue') minBlurValue: number;\n  @Input('maxBlurValue') maxBlurValue: number;\n\n  @Output('heatRadiusDidChange') heatRadiusDidChange = new EventEmitter<any>();\n  @Output('heatBlurDidChange') heatBlurDidChange = new EventEmitter<any>();\n  @Output('heatOpacityDidChange') heatOpacityDidChange = new EventEmitter<any>();\n\n  radiusChanged(value) {\n    this.heatRadiusDidChange.emit(value);\n  }\n\n  blurChanged(value) {\n    this.heatBlurDidChange.emit(value);\n  }\n\n  opacityChanged(value) {\n    this.heatOpacityDidChange.emit(value);\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, EventEmitter, Input, NgZone, OnInit, Output, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {DataModel} from '../../model/dataModel';\nimport {ColorLib} from '../../utils/color-lib';\nimport deepEqual from 'deep-equal';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {Param} from '../../model/param';\nimport {GTSLib} from '../../utils/gts.lib';\n\n@Component({\n  selector: 'warpview-pie',\n  templateUrl: './warp-view-pie.component.html',\n  styleUrls: ['./warp-view-pie.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewPieComponent extends WarpViewComponent implements OnInit {\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  @Output('chartDraw') chartDraw = new EventEmitter<any>();\n\n  private _type = 'pie';\n  layout: Partial<any> = {\n    showlegend: true,\n    legend: {\n      orientation: 'h',\n      bgcolor: 'transparent',\n    },\n    orientation: 270,\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 10\n    }\n  };\n\n  update(options, refresh): void {\n    this.LOG.debug(['onOptions', 'before'], this._options, options);\n    if (!deepEqual(options, this._options)) {\n      this.LOG.debug(['options', 'changed'], options);\n      this._options = ChartLib.mergeDeep(this._options, options as Param) as Param;\n    }\n    this.drawChart();\n  }\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewPieComponent, this._debug);\n  }\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.LOG.debug(['drawChart', 'this.plotlyData'], this.plotlyData);\n    this.layout.legend.font = {\n      color: this.getCSSColor(this.el.nativeElement, '--warp-view-font-color', '#000')\n    };\n    this.layout.textfont = {\n      color: this.getCSSColor(this.el.nativeElement, '--warp-view-font-color', '#000')\n    };\n    this.loading = false;\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const gtsList = data.data as any[];\n    const plotData = [] as Partial<any>[];\n    this.LOG.debug(['convert', 'gtsList'], gtsList);\n    const pieData = {\n      values: [],\n      labels: [],\n      marker: {\n        colors: [],\n        line: {\n          width: 3,\n          color: [],\n        }\n      },\n      textfont: {\n        color: this.getLabelColor(this.el.nativeElement)\n      },\n      hoverlabel: {\n        bgcolor: this.getCSSColor(this.el.nativeElement, '--warp-view-chart-legend-bg', '#000000'),\n        bordercolor: 'grey',\n        font: {\n          color: this.getCSSColor(this.el.nativeElement, '--warp-view-chart-legend-color', '#ffffff')\n        }\n      },\n      type: 'pie'\n    } as any;\n    gtsList.forEach((d: any, i) => {\n      if (!GTSLib.isGts(d)) {\n        const c = ColorLib.getColor(i, this._options.scheme);\n        const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n        pieData.values.push(d[1]);\n        pieData.labels.push(d[0]);\n        pieData.marker.colors.push(ColorLib.transparentize(color));\n        pieData.marker.line.color.push(color);\n        if (this._type === 'donut') {\n          pieData.hole = 0.5;\n        }\n        if (this.unit) {\n          pieData.title = {\n            text: this.unit\n          };\n        }\n      }\n    });\n    if (pieData.values.length > 0) {\n      plotData.push(pieData);\n    }\n    this.noData = plotData.length === 0;\n    return plotData;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, Input, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {DataModel} from '../../model/dataModel';\nimport gauge from 'canvas-gauges';\nimport {ColorLib} from '../../utils/color-lib';\nimport deepEqual from 'deep-equal';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {Param} from '../../model/param';\n\n@Component({\n  selector: 'warpview-gauge',\n  templateUrl: './warp-view-gauge.component.html',\n  styleUrls: ['./warp-view-gauge.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewGaugeComponent extends WarpViewComponent implements OnInit {\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  private CHART_MARGIN = 0.05;\n  // tslint:disable-next-line:variable-name\n  private _type = 'gauge'; // gauge or bullet\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewGaugeComponent, this._debug);\n  }\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  update(options, refresh): void {\n    this.LOG.debug(['onOptions', 'before'], this._options, options);\n    if (!deepEqual(options, this._options)) {\n      this.LOG.debug(['options', 'changed'], options);\n      this._options = ChartLib.mergeDeep(this._options, options as Param) as Param;\n    }\n    this.drawChart();\n  }\n\n  drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.LOG.debug(['drawChart', 'plotlyData'], this.plotlyData, this._type);\n    this.layout.autosize = true;\n    this.layout.grid = {\n      rows: Math.ceil(this.plotlyData.length / 2),\n      columns: 2,\n      pattern: 'independent',\n      xgap: 0.2,\n      ygap: 0.2\n    };\n    this.layout.margin = {t: 25, r: 25, l: 25, b: 25};\n    if (this._type === 'bullet') {\n      this.layout.height = this.plotlyData.length * 100;\n      (this.el.nativeElement as HTMLDivElement).style.height = this.layout.height + 'px';\n      this.layout.margin.l = 300;\n      this.layout.yaxis = {\n        automargin: true\n      };\n      this.layout.grid = {rows: this.plotlyData.length, columns: 1, pattern: 'independent'};\n    }\n    this.loading = false;\n  }\n\n  protected convert(data: DataModel): any[] {\n    this.LOG.debug(['convert'], data);\n    const gtsList = data.data as any[];\n    const dataList = [];\n    let max = Number.MIN_VALUE;\n    this.LOG.debug(['convert', 'gtsList'], gtsList);\n    if (!gtsList || gtsList.length === 0 || gtsList[0].length < 2) {\n      return;\n    }\n    gtsList.forEach(d => max = Math.max(max, d[1]));\n    let x = 0;\n    let y = -1 / (gtsList.length / 2);\n    gtsList.forEach((gts, i) => {\n      if (i % 2 !== 0) {\n        x = 0.5;\n      } else {\n        x = 0;\n        y += 1 / (gtsList.length / 2);\n      }\n      const c = ColorLib.getColor(gts.id || i, this._options.scheme);\n      const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n      const domain = gtsList.length > 1 ? {\n        x: [x + this.CHART_MARGIN, x + 0.5 - this.CHART_MARGIN],\n        y: [y + this.CHART_MARGIN, y + 1 / (gtsList.length / 2) - this.CHART_MARGIN * 2]\n      } : {\n        x: [0, 1],\n        y: [0, 1]\n      };\n      if (this._type === 'bullet' || (!!data.params && !!data.params[i].type && data.params[i].type === 'bullet')) {\n        domain.x = [this.CHART_MARGIN, 1 - this.CHART_MARGIN];\n        domain.y = [(i > 0 ? i / gtsList.length : 0) + this.CHART_MARGIN, (i + 1) / gtsList.length - this.CHART_MARGIN];\n      }\n      dataList.push(\n        {\n          domain,\n          align: 'left',\n          value: gts[1],\n          delta: {\n            reference: !!data.params && !!data.params[i].delta ? data.params[i].delta + gts[1] : 0,\n            font: {color: this.getLabelColor(this.el.nativeElement)}\n          },\n          title: {\n            text: gts[0],\n            align: 'center',\n            font: {color: this.getLabelColor(this.el.nativeElement)}\n          },\n          number: {\n            font: {color: this.getLabelColor(this.el.nativeElement)}\n          },\n          type: 'indicator',\n          mode: !!data.params && !!data.params[i].delta ? 'number+delta+gauge' : 'gauge+number',\n          gauge: {\n            bgcolor: 'transparent',\n            shape: !!data.params && !!data.params[i].type ? data.params[i].type : this._type || 'gauge',\n            bordercolor: this.getGridColor(this.el.nativeElement),\n            axis: {\n              range: [null, max],\n              tickcolor: this.getGridColor(this.el.nativeElement),\n              tickfont: {color: this.getGridColor(this.el.nativeElement)}\n            },\n            bar: {\n              color: ColorLib.transparentize(color),\n              line: {\n                width: 1,\n                color\n              }\n            }\n          }\n        });\n      this.LOG.debug(['convert', 'dataList'], i);\n    });\n    this.LOG.debug(['convert', 'dataList'], dataList);\n    return dataList;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {\n  Component,\n  ElementRef,\n  EventEmitter,\n  HostListener,\n  Input,\n  NgZone,\n  Output,\n  Renderer2,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport {ChartLib} from '../../utils/chart-lib';\nimport moment from 'moment-timezone';\nimport {DataModel} from '../../model/dataModel';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\nimport {ColorLib} from '../../utils/color-lib';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {ChartBounds} from '../../model/chartBounds';\n\n@Component({\n  selector: 'warpview-annotation',\n  templateUrl: './warp-view-annotation.component.html',\n  styleUrls: ['./warp-view-annotation.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewAnnotationComponent extends WarpViewComponent {\n  @ViewChild('chartContainer', {static: true}) chartContainer: ElementRef;\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    const previousVisibility = JSON.stringify(this.visibility);\n    this.LOG.debug(['hiddenData', 'previousVisibility'], previousVisibility);\n    this._hiddenData = hiddenData;\n    this.visibility = [];\n    this.visibleGtsId.forEach(id => this.visibility.push(hiddenData.indexOf(id) < 0 && (id !== -1)));\n    this.LOG.debug(['hiddenData', 'hiddendygraphfullv'], this.visibility);\n    const newVisibility = JSON.stringify(this.visibility);\n    this.LOG.debug(['hiddenData', 'json'], previousVisibility, newVisibility);\n    if (previousVisibility !== newVisibility) {\n      const visible = [];\n      const hidden = [];\n      this.gtsId.forEach((id, i) => {\n        if (this._hiddenData.indexOf(id) > -1) {\n          hidden.push(i);\n        } else {\n          visible.push(i);\n        }\n      });\n      if (visible.length > 0) {\n        this.graph.restyleChart({visible: true}, visible);\n      }\n      if (hidden.length > 0) {\n        this.graph.restyleChart({visible: false}, hidden);\n      }\n      this.LOG.debug(['hiddendygraphtrig', 'destroy'], 'redraw by visibility change');\n    }\n  }\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  @Input('standalone') set standalone(isStandalone: boolean) {\n    if (this._standalone !== isStandalone) {\n      this._standalone = isStandalone;\n      this.drawChart();\n    }\n  }\n\n  get standalone(): boolean {\n    return this._standalone;\n  }\n\n  @Output('pointHover') pointHover = new EventEmitter<any>();\n  @Output('warpViewChartResize') warpViewChartResize = new EventEmitter<any>();\n  @Output('chartDraw') chartDraw = new EventEmitter<any>();\n  @Output('boundsDidChange') boundsDidChange = new EventEmitter<any>();\n\n  displayExpander = true;\n\n  // tslint:disable-next-line:variable-name\n  private _type = 'line';\n  private visibility: boolean[] = [];\n  private expanded = false;\n  private _standalone = true;\n  private trimmed;\n  private maxTick = Number.MIN_VALUE;\n  private minTick = Number.MAX_VALUE;\n  private visibleGtsId = [];\n  private gtsId = [];\n  private dataHashset = {};\n  private lineHeight = 30;\n  private chartBounds: ChartBounds = new ChartBounds();\n  layout: Partial<any> = {\n    showlegend: false,\n    hovermode: 'closest',\n    xaxis: {\n      gridwidth: 1,\n      fixedrange: false,\n      autorange: false,\n      automargin: false,\n      showticklabels: true,\n    },\n    autosize: false,\n    autoexpand: false,\n    yaxis: {\n      showticklabels: false,\n      fixedrange: true,\n      dtick: 1,\n      gridwidth: 1,\n      tick0: 0,\n      nticks: 2,\n      rangemode: 'tozero',\n      tickson: 'boundaries',\n      automargin: true,\n      showline: true,\n      zeroline: true\n    },\n    margin: {\n      t: 30,\n      b: 2,\n      r: 10,\n      l: 10\n    },\n  };\n  marginLeft = 50;\n\n  @HostListener('keydown', ['$event'])\n  @HostListener('document:keydown', ['$event'])\n  handleKeyDown($event: KeyboardEvent) {\n    if ($event.key === 'Control') {\n      this.trimmed = setInterval(() => {\n        if (!!this.toolTip.nativeElement.querySelector('#tooltip-body')) {\n          this.toolTip.nativeElement.querySelector('#tooltip-body').classList.add('full');\n        }\n      }, 100);\n    }\n  }\n\n  @HostListener('keyup', ['$event'])\n  @HostListener('document:keyup', ['$event'])\n  handleKeyup($event: KeyboardEvent) {\n    this.LOG.debug(['document:keyup'], $event);\n    if ($event.key === 'Control') {\n      if (!!this.toolTip.nativeElement.querySelector('#tooltip-body')) {\n        if (this.trimmed) {\n          clearInterval(this.trimmed);\n        }\n        this.toolTip.nativeElement.querySelector('#tooltip-body').classList.remove('full');\n      }\n    }\n  }\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this._autoResize = false;\n    this.LOG = new Logger(WarpViewAnnotationComponent, this._debug);\n  }\n\n  update(options: Param, refresh: boolean): void {\n    if (!!options) {\n      this._options = ChartLib.mergeDeep(this._options, options) as Param;\n    }\n    this.drawChart(refresh);\n  }\n\n  updateBounds(min, max, marginLeft) {\n    this.LOG.debug(['updateBounds'], min, max, this._options);\n    this._options.bounds.minDate = min;\n    this._options.bounds.maxDate = max;\n    this.layout.xaxis.autorange = false;\n    this.LOG.debug(['updateBounds'],\n      moment.tz(min / this.divider, this._options.timeZone).toISOString(),\n      moment.tz(max / this.divider, this._options.timeZone).toISOString());\n    this.minTick = min;\n    this.maxTick = max;\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      this.layout.xaxis.tick0 = min / this.divider;\n      this.layout.xaxis.range = [min / this.divider, max / this.divider];\n    } else {\n      this.layout.xaxis.tick0 = moment.tz(min / this.divider, this._options.timeZone).toISOString();\n      this.layout.xaxis.range = [\n        moment.tz(min / this.divider, this._options.timeZone).toISOString(),\n        moment.tz(max / this.divider, this._options.timeZone).toISOString()\n      ];\n    }\n    this.layout.margin.l = marginLeft;\n    this.marginLeft = marginLeft;\n    this.layout = {...this.layout};\n    this.LOG.debug(['updateBounds'], {...this.layout.xaxis.range});\n  }\n\n  drawChart(reparseNewData: boolean = false) {\n    if (!this.initChart(this.el)) {\n      this.el.nativeElement.style.display = 'none';\n      return;\n    }\n    this.el.nativeElement.style.display = 'block';\n    this.LOG.debug(['drawChart', 'this.plotlyData'], this.plotlyData);\n    this.LOG.debug(['drawChart', 'hiddenData'], this._hiddenData);\n    this.LOG.debug(['drawChart', 'this._options.bounds'], this._options.bounds);\n    this.layout.yaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.yaxis.gridcolor = this.getGridColor(this.el.nativeElement);\n    this.layout.yaxis.showline = !!this._standalone;\n    this.layout.yaxis.zerolinecolor = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.gridcolor = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.autorange = !!this._standalone;\n    this.layout.xaxis.showticklabels = !!this._standalone;\n    this.displayExpander = (this.plotlyData.length > 1);\n    const count = this.plotlyData.filter(d => d.y.length > 0).length;\n    this.layout.margin.l = !!this._standalone ? 10 : 50;\n    this.layout.margin.b = !!this._standalone ? 50 : 1;\n    const calculatedHeight = (this.expanded ? this.lineHeight * count : this.lineHeight) + this.layout.margin.t + this.layout.margin.b;\n    this.el.nativeElement.style.height = calculatedHeight + 'px';\n    this.height = calculatedHeight;\n    this.layout.height = this.height;\n    this.LOG.debug(['drawChart', 'height'], this.height, count, calculatedHeight);\n    this.layout.yaxis.range = [0, this.expanded ? count : 1];\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      this.layout.xaxis.tick0 = this.minTick / this.divider;\n      this.layout.xaxis.range = [this.minTick / this.divider, this.maxTick / this.divider];\n      this.layout.xaxis.type = 'linear';\n    } else {\n      this.layout.xaxis.tick0 = moment.tz(this.minTick / this.divider, this._options.timeZone).toISOString(true);\n      this.layout.xaxis.range = [\n        moment.tz(this.minTick / this.divider, this._options.timeZone).toISOString(true),\n        moment.tz(this.maxTick / this.divider, this._options.timeZone).toISOString(true)\n      ];\n      this.layout.xaxis.type = 'date';\n    }\n    this.plotlyConfig.scrollZoom = true;\n    this.plotlyConfig = {...this.plotlyConfig};\n    this.layout = {...this.layout};\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig, this.plotlyData);\n    this.loading = false;\n  }\n\n  relayout(data: any) {\n    if (data['xaxis.range'] && data['xaxis.range'].length === 2) {\n      this.LOG.debug(['relayout', 'updateBounds', 'xaxis.range'], data['xaxis.range']);\n      this.chartBounds.msmin = data['xaxis.range'][0];\n      this.chartBounds.msmax = data['xaxis.range'][1];\n      this.chartBounds.tsmin = moment.tz(moment(this.chartBounds.msmin), this._options.timeZone).valueOf();\n      this.chartBounds.tsmax = moment.tz(moment(this.chartBounds.msmax), this._options.timeZone).valueOf();\n    } else if (data['xaxis.range[0]'] && data['xaxis.range[1]']) {\n      this.LOG.debug(['relayout', 'updateBounds', 'xaxis.range[x]'], data['xaxis.range[0]']);\n      this.chartBounds.msmin = data['xaxis.range[0]'];\n      this.chartBounds.msmax = data['xaxis.range[1]'];\n      this.chartBounds.tsmin = moment.tz(moment(this.chartBounds.msmin), this._options.timeZone).valueOf();\n      this.chartBounds.tsmax = moment.tz(moment(this.chartBounds.msmax), this._options.timeZone).valueOf();\n    } else if (data['xaxis.autorange']) {\n      this.LOG.debug(['relayout', 'updateBounds', 'autorange'], data);\n      this.chartBounds.tsmin = this.minTick / this.divider;\n      this.chartBounds.tsmax = this.maxTick / this.divider;\n    }\n    this.emitNewBounds(moment.utc(this.chartBounds.tsmin).valueOf(), moment.utc(this.chartBounds.msmax).valueOf());\n  }\n\n  hover(data: any) {\n    this.LOG.debug(['hover'], data);\n    const tooltip = this.toolTip.nativeElement;\n    this.pointHover.emit({\n      x: data.event.offsetX,\n      y: data.event.offsetY\n    });\n    let x = data.xvals[0];\n    if (!!data.points[0]) {\n      x = data.points[0].x;\n    }\n    const layout = this.el.nativeElement.getBoundingClientRect();\n    const count = this.plotlyData.filter(d => d.y.length > 0).length;\n    tooltip.style.opacity = '1';\n    tooltip.style.display = 'block';\n    tooltip.style.paddingLeft = (this._standalone ? 0 : 40) + 'px';\n    tooltip.style.top = (\n      (this.expanded ? count - 1 - (data.points[0].y + 0.5) : -1) * (this.lineHeight) + this.layout.margin.t\n    ) + 6 + 'px';\n    tooltip.classList.remove('right', 'left');\n    tooltip.innerHTML = `<div class=\"tooltip-body trimmed\" id=\"tooltip-body\">\n<span class=\"tooltip-date\">${this._options.timeMode === 'timestamp'\n      ? x\n      : (moment(x).utc().toISOString().replace('Z', this._options.timeZone === 'UTC' ? 'Z' : '') || '')}</span>\n<ul>\n<li>${GTSLib.formatLabel(data.points[0].data.name)}: <span class=\"value\">${data.points[0].text}</span></li>\n</ul>\n      </div>`;\n    if (data.event.offsetX > layout.width / 2) {\n      tooltip.classList.add('left');\n    } else {\n      tooltip.classList.add('right');\n    }\n    tooltip.style.pointerEvents = 'none';\n  }\n\n  unhover() {\n    this.toolTip.nativeElement.style.display = 'none';\n  }\n\n  afterPlot(div) {\n    this.loading = false;\n    this.chartBounds.tsmin = this.minTick;\n    this.chartBounds.tsmax = this.maxTick;\n    this.chartDraw.emit(this.chartBounds);\n    this.LOG.debug(['afterPlot'], this.chartBounds, div);\n  }\n\n  private emitNewBounds(min, max) {\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      this.boundsDidChange.emit({bounds: {min, max}, source: 'annotation'});\n    } else {\n      this.boundsDidChange.emit({\n        bounds: {\n          min: moment.tz(min, this._options.timeZone).valueOf(),\n          max: moment.tz(max, this._options.timeZone).valueOf()\n        },\n        source: 'annotation'\n      });\n    }\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const dataset: Partial<any>[] = [];\n    let gtsList = GTSLib.flatDeep(GTSLib.flattenGtsIdArray(data.data as any[], 0).res);\n    this.maxTick = Number.NEGATIVE_INFINITY;\n    this.minTick = Number.POSITIVE_INFINITY;\n    this.visibleGtsId = [];\n    this.gtsId = [];\n    const nonPlottable = gtsList.filter(g => g.v && GTSLib.isGtsToPlot(g));\n    gtsList = gtsList.filter(g => g.v && !GTSLib.isGtsToPlot(g));\n    let timestampMode = true;\n    const tsLimit = 100 * GTSLib.getDivider(this._options.timeUnit);\n    gtsList.forEach((gts: GTS) => {\n      const ticks = gts.v.map(t => t[0]);\n      const size = gts.v.length;\n      timestampMode = timestampMode && (ticks[0] > -tsLimit && ticks[0] < tsLimit);\n      timestampMode = timestampMode && (ticks[size - 1] > -tsLimit && ticks[size - 1] < tsLimit);\n    });\n    if (timestampMode || this._options.timeMode === 'timestamp') {\n      this.layout.xaxis.type = 'linear';\n    } else {\n      this.layout.xaxis.type = 'date';\n    }\n    gtsList.forEach((gts: GTS, i) => {\n      if (gts.v) {\n        const size = gts.v.length;\n        const label = GTSLib.serializeGtsMetadata(gts);\n        const c = ColorLib.getColor(gts.id, this._options.scheme);\n        const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n        const series: Partial<any> = {\n          type: 'scatter',\n          mode: 'markers',\n          name: label,\n          x: [],\n          y: [],\n          text: [],\n          hoverinfo: 'none',\n          connectgaps: false,\n          visible: !(this._hiddenData.filter(h => h === gts.id).length > 0),\n          line: {color},\n          marker: {\n            symbol: 'line-ns-open',\n            color,\n            size: 20,\n            width: 5,\n          }\n        };\n        this.visibleGtsId.push(gts.id);\n        this.gtsId.push(gts.id);\n        if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n          this.layout.xaxis.type = 'linear';\n        } else {\n          this.layout.xaxis.type = 'date';\n        }\n        const ticks = gts.v.map(t => t[0]);\n        series.text = gts.v.map(t => t[t.length - 1]);\n        series.y = gts.v.map(() => (this.expanded ? i : 0) + 0.5);\n        if (size > 0) {\n          this.minTick = ticks[0];\n          this.maxTick = ticks[0];\n          for (let v = 1; v < size; v++) {\n            const val = ticks[v];\n            this.minTick = (val < this.minTick) ? val : this.minTick;\n            this.maxTick = (val > this.maxTick) ? val : this.maxTick;\n          }\n        }\n        if (timestampMode || this._options.timeMode === 'timestamp') {\n          series.x = ticks;\n        } else {\n          if (this._options.timeZone !== 'UTC') {\n            series.x = ticks.map(t => moment.utc(t / this.divider).tz(this._options.timeZone).toISOString());\n          } else {\n            series.x = ticks.map(t => moment.utc(t / this.divider).toISOString());\n          }\n        }\n        if (series.x.length > 0) {\n          dataset.push(series);\n        }\n      }\n    });\n    if (nonPlottable.length > 0) {\n      nonPlottable.forEach(g => {\n        g.v.forEach(value => {\n          const ts = value[0];\n          if (ts < this.minTick) {\n            this.minTick = ts;\n          }\n          if (ts > this.maxTick) {\n            this.maxTick = ts;\n          }\n        });\n      });\n      // if there is not any plottable data, we must add a fake one with id -1. This one will always be hidden.\n      if (0 === gtsList.length) {\n        if (!this.dataHashset[this.minTick]) {\n          this.dataHashset[this.minTick] = [0];\n        }\n        if (!this.dataHashset[this.maxTick]) {\n          this.dataHashset[this.maxTick] = [0];\n        }\n        this.visibility.push(false);\n        this.visibleGtsId.push(-1);\n      }\n    }\n    if (timestampMode) {\n      this._options.timeMode = 'timestamp';\n    }\n    return dataset;\n  }\n\n  toggle() {\n    this.expanded = !this.expanded;\n    this.drawChart();\n  }\n\n  setRealBounds(chartBounds: ChartBounds) {\n    this.minTick = chartBounds.tsmin;\n    this.maxTick = chartBounds.tsmax;\n    this._options.bounds = this._options.bounds || {};\n    this._options.bounds.minDate = this.minTick;\n    this._options.bounds.maxDate = this.maxTick;\n    const x = {\n      tick0: undefined,\n      range: []\n    };\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      x.tick0 = this.minTick / this.divider;\n      x.range = [this.minTick / this.divider, this.maxTick / this.divider];\n    } else {\n      x.tick0 = moment.tz(this.minTick / this.divider, this._options.timeZone).toISOString(true);\n      x.range = [\n        moment.tz(this.minTick / this.divider, this._options.timeZone).toISOString(true),\n        moment.tz(this.maxTick / this.divider, this._options.timeZone).toISOString(true)\n      ];\n    }\n    this.layout.xaxis = x;\n    this.layout = {...this.layout};\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {DataModel} from '../../model/dataModel';\nimport {ColorLib} from '../../utils/color-lib';\nimport {GTS} from '../../model/GTS';\nimport moment from 'moment-timezone';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport deepEqual from 'deep-equal';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {Param} from '../../model/param';\n\n@Component({\n  selector: 'warpview-polar',\n  templateUrl: './warp-view-polar.component.html',\n  styleUrls: ['./warp-view-polar.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\n/**\n *\n */\nexport class WarpViewPolarComponent extends WarpViewComponent implements OnInit {\n  layout: Partial<any> = {\n    paper_bgcolor: 'rgba(0,0,0,0)',\n    showlegend: true,\n    legend: {orientation: 'h'},\n    font: {size: 12, familly: '\\'Quicksand\\', sans-serif'},\n    polar: {\n      bgcolor: 'rgba(0,0,0,0)',\n      angularaxis: {\n        type: 'category'\n      },\n      radialaxis: {\n        visible: true,\n      }\n    },\n    orientation: 270,\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 10\n    }\n  };\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewPolarComponent, this._debug);\n  }\n\n  update(options, refresh): void {\n    this.LOG.debug(['onOptions', 'before'], this._options, options);\n    if (!deepEqual(options, this._options)) {\n      this.LOG.debug(['options', 'changed'], options);\n      this._options = ChartLib.mergeDeep(this._options, options as Param) as Param;\n    }\n    this.drawChart();\n  }\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.layout.polar.radialaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.polar.angularaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.showlegend = !!this.showLegend;\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.LOG.debug(['drawChart', 'this.plotlyData'], this.plotlyData);\n    this.loading = false;\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const dataset: Partial<any>[] = [];\n    const divider = GTSLib.getDivider(this._options.timeUnit);\n    const gtsList = GTSLib.flatDeep(GTSLib.flattenGtsIdArray(data.data as any[], 0).res);\n    this.LOG.debug(['convert', 'gtsList'], gtsList);\n    let minVal = Number.MAX_VALUE;\n    let maxVal = Number.MIN_VALUE;\n    gtsList.forEach((gts: GTS, i) => {\n      const c = ColorLib.getColor(i, this._options.scheme);\n      const color = ((data.params || [])[gts.id] || {datasetColor: c}).datasetColor || c;\n      const series: any = {\n        r: [],\n        theta: [],\n        marker: {\n          line: {color, width: 1},\n          color: ColorLib.transparentize(color),\n        },\n        fillcolor: ColorLib.transparentize(color),\n        hoverinfo: 'none',\n        name: GTSLib.serializeGtsMetadata(gts),\n        text: GTSLib.serializeGtsMetadata(gts),\n        fill: 'toself',\n        type: 'barpolar',\n      };\n      gts.v.forEach(value => {\n        const ts = value[0];\n        minVal = Math.min(minVal, value[value.length - 1]);\n        maxVal = Math.max(maxVal, value[value.length - 1]);\n        series.r.push(value[value.length - 1]);\n        if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n          series.theta.push(ts.toString());\n        } else {\n          series.theta.push(moment.tz(moment.utc(ts / this.divider), this._options.timeZone).toISOString());\n        }\n      });\n      if (this.unit) {\n        series.title = {\n          text: this.unit\n        };\n      }\n      dataset.push(series);\n    });\n    this.layout.polar.radialaxis.range = [minVal, maxVal];\n    return dataset;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {DataModel} from '../../model/dataModel';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\nimport {ColorLib} from '../../utils/color-lib';\nimport moment from 'moment-timezone';\nimport deepEqual from 'deep-equal';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {Param} from '../../model/param';\n\n@Component({\n  selector: 'warpview-radar',\n  templateUrl: './warp-view-radar.component.html',\n  styleUrls: ['./warp-view-radar.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\n/**\n *\n */\nexport class WarpViewRadarComponent extends WarpViewComponent implements OnInit {\n\n  layout: Partial<any> = {\n    paper_bgcolor: 'transparent',\n    showlegend: true,\n    legend: {orientation: 'h'},\n    font: {size: 12},\n    polar: {\n      bgcolor: 'transparent',\n      angularaxis: {type: 'category'},\n      radialaxis: {visible: true}\n    },\n    margin: {\n      t: 0,\n      b: 25,\n      r: 10,\n      l: 10\n    }\n  };\n\n  update(options, refresh): void {\n    this.LOG.debug(['onOptions', 'before'], this._options, options);\n    if (!deepEqual(options, this._options)) {\n      this.LOG.debug(['options', 'changed'], options);\n      this._options = ChartLib.mergeDeep(this._options, options as Param) as Param;\n    }\n    this.drawChart();\n  }\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewRadarComponent, this._debug);\n  }\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.layout.polar.radialaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.polar.angularaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.showlegend = this.showLegend;\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.LOG.debug(['drawChart', 'this.plotlyData'], this.plotlyData);\n    this.loading = false;\n  }\n\n  protected convert(data: DataModel): any[] {\n    const dataset: any[] = [];\n    const divider = GTSLib.getDivider(this._options.timeUnit);\n    const gtsList = GTSLib.flatDeep(GTSLib.flattenGtsIdArray(data.data as any[], 0).res);\n    this.LOG.debug(['convert', 'gtsList'], gtsList);\n    let minVal = Number.MAX_VALUE;\n    let maxVal = Number.MIN_VALUE;\n    gtsList.forEach((gts: GTS, i) => {\n      const c = ColorLib.getColor(i, this._options.scheme);\n      const color = ((data.params || [])[gts.id] || {datasetColor: c}).datasetColor || c;\n      const series: any = {\n        r: [],\n        theta: [],\n        line: {color},\n        marker: {\n          line: {color, width: 1},\n          color: ColorLib.transparentize(color)\n        },\n        fillcolor: ColorLib.transparentize(color),\n        hoverinfo: 'none',\n        name: GTSLib.serializeGtsMetadata(gts),\n        text: GTSLib.serializeGtsMetadata(gts),\n        type: 'scatterpolar',\n        fill: 'toself'\n      };\n      gts.v.forEach(value => {\n        const ts = value[0];\n        series.r.push(value[value.length - 1]);\n        minVal = Math.min(minVal, value[value.length - 1]);\n        maxVal = Math.max(maxVal, value[value.length - 1]);\n        if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n          series.theta.push(ts.toString());\n        } else {\n          series.theta.push(moment.tz(moment.utc(ts / this.divider), this._options.timeZone).toISOString());\n        }\n      });\n      dataset.push(series);\n    });\n    this.layout.polar.radialaxis.range = [minVal, maxVal];\n    return dataset;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {\n  AfterViewInit,\n  Component,\n  ElementRef,\n  EventEmitter,\n  HostListener,\n  Input,\n  NgZone,\n  OnInit,\n  Output,\n  Renderer2,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {WarpViewModalComponent} from '../warp-view-modal/warp-view-modal.component';\nimport {Param} from '../../model/param';\nimport {WarpViewChartComponent} from '../warp-view-chart/warp-view-chart.component';\nimport {WarpViewAnnotationComponent} from '../warp-view-annotation/warp-view-annotation.component';\nimport {WarpViewMapComponent} from '../warp-view-map/warp-view-map.component';\nimport {WarpViewGtsPopupComponent} from '../warp-view-gts-popup/warp-view-gts-popup.component';\nimport {ChartBounds} from '../../model/chartBounds';\nimport moment from 'moment-timezone';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\nimport {DataModel} from '../../model/dataModel';\nimport deepEqual from 'deep-equal';\nimport {Size, SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-plot',\n  templateUrl: './warp-view-plot.component.html',\n  styleUrls: ['./warp-view-plot.component.scss'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class WarpViewPlotComponent extends WarpViewComponent implements OnInit, AfterViewInit {\n\n  @ViewChild('mainPlotDiv', {static: true}) mainPlotDiv: ElementRef;\n  @ViewChild('timeClip', {static: true}) timeClip: WarpViewModalComponent;\n  @ViewChild('modal', {static: true}) modal: WarpViewModalComponent;\n  @ViewChild('chart', {static: false}) chart: WarpViewChartComponent;\n  @ViewChild('gtsPopupModal', {static: false}) gtsPopupModal: WarpViewGtsPopupComponent;\n  @ViewChild('annotation', {static: false}) annotation: WarpViewAnnotationComponent;\n  @ViewChild('map', {static: false}) map: WarpViewMapComponent;\n  @ViewChild('timeClipElement', {static: true}) timeClipElement: ElementRef;\n  @ViewChild('GTSTree', {static: true}) GTSTree: ElementRef;\n  @ViewChild('controls', {static: true}) controls: ElementRef;\n  @ViewChild('filterInput', {static: true}) filterInput: ElementRef;\n  @ViewChild('tzSelector', {static: false}) tzSelector: ElementRef;\n  @ViewChild('line', {static: false}) line: ElementRef;\n  @ViewChild('main', {static: false}) main: ElementRef;\n  private showLine = false;\n  private left: number;\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  get type() {\n    return this._type;\n  }\n\n  @Input('gtsFilter') set gtsFilter(gtsFilter) {\n    this._gtsFilter = gtsFilter;\n    this.drawChart();\n  }\n\n  get gtsFilter() {\n    return this._gtsFilter;\n  }\n\n  @Input('isAlone') isAlone = false;\n  @Input('initialChartHeight') initialChartHeight = 400;\n  @Input('initialMapHeight') initialMapHeight = 400;\n  @Output('warpViewChartResize') warpViewChartResize = new EventEmitter<any>();\n\n  _options: Param = {\n    ...new Param(), ...{\n      showControls: true,\n      showGTSTree: true,\n      showDots: true,\n      timeZone: 'UTC',\n      timeUnit: 'us',\n      timeMode: 'date',\n      bounds: {}\n    }\n  };\n  _toHide: number[] = [];\n  showChart = true;\n  showMap = false;\n  timeClipValue = '';\n  kbdLastKeyPressed: string[] = [];\n  warningMessage = '';\n  loading = false;\n  gtsIdList: number[] = [];\n\n  private kbdCounter = 0;\n  private gtsFilterCount = 0;\n  private gtsBrowserIndex = -1;\n  private _gtsFilter = 'x';\n  private _type = 'line';\n  private chartBounds: ChartBounds = {\n    tsmin: Number.MAX_VALUE,\n    tsmax: Number.MIN_VALUE,\n    msmax: '',\n    msmin: '',\n    marginLeft: 0\n  };\n  // key event are trapped in plot component.\n  // if one of this key is pressed, default action is prevented.\n  private preventDefaultKeyList: string[] = ['Escape', '/'];\n  private preventDefaultKeyListInModals: string[] = ['Escape', 'ArrowUp', 'ArrowDown', ' ', '/'];\n  gtsList: DataModel | GTS[] | string;\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewPlotComponent, this._debug);\n  }\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  ngAfterViewInit(): void {\n    this.drawChart(true);\n    this.resizeArea();\n  }\n\n  @HostListener('keydown', ['$event'])\n  handleKeydown(ev: KeyboardEvent) {\n    this.LOG.debug(['handleKeydown'], ev);\n    if (!this.isAlone) {\n      this.handleKeyPress(ev).then(() => {\n        // empty\n      });\n    }\n  }\n\n  stateChange(event: any) {\n    this.LOG.debug(['stateChange'], event);\n    switch (event.id) {\n      case 'timeSwitch' :\n        if (event.state) {\n          this._options.timeMode = 'timestamp';\n        } else {\n          this._options.timeMode = 'date';\n        }\n        this.drawChart();\n        break;\n      case 'typeSwitch' :\n        if (event.state) {\n          this._type = 'step';\n        } else {\n          this._type = 'line';\n        }\n        this.drawChart();\n        break;\n      case 'chartSwitch' :\n        this.showChart = event.state;\n        this.drawChart();\n        break;\n      case 'mapSwitch' :\n        this.showMap = event.state;\n        if (this.showMap) {\n          requestAnimationFrame(() => this.map.resize());\n        }\n        break;\n    }\n  }\n\n  boundsDidChange(event) {\n    this.LOG.debug(['updateBounds'], event);\n    this._options.bounds = this._options.bounds || {};\n    if (this._options.bounds.minDate !== event.bounds.min && this._options.bounds.maxDate !== event.bounds.max) {\n      this._options.bounds = this._options.bounds || {};\n      this._options.bounds.minDate = event.bounds.min;\n      this._options.bounds.maxDate = event.bounds.max;\n      if (event.source === 'chart') {\n        this.annotation.updateBounds(event.bounds.min, event.bounds.max, event.bounds.marginLeft);\n      } else if (event.source === 'annotation') {\n        this.chart.updateBounds(event.bounds.min, event.bounds.max);\n      }\n      this.LOG.debug(['updateBounds'],\n        moment.tz(event.bounds.min, this._options.timeZone).toDate(),\n        moment.tz(event.bounds.max, this._options.timeZone).toDate());\n      this.line.nativeElement.style.left = '-100px';\n    }\n  }\n\n  onWarpViewModalClose() {\n    this.mainPlotDiv.nativeElement.focus();\n  }\n\n  warpViewSelectedGTS(event) {\n    this.LOG.debug(['warpViewSelectedGTS'], event);\n    if (!this._toHide.find(i => {\n      return i === event.gts.id;\n    }) && !event.selected) { // if not in toHide and state false, put id in toHide\n      this._toHide.push(event.gts.id);\n    } else {\n      if (event.selected) { // if in toHide and state true, remove it from toHide\n        this._toHide = this._toHide.filter(i => {\n          return i !== event.gts.id;\n        });\n      }\n    }\n    this.LOG.debug(['warpViewSelectedGTS', 'this._toHide'], this._toHide);\n    this.ngZone.run(() => {\n      this._toHide = [...this._toHide];\n    });\n  }\n\n  handleMouseMove(evt: MouseEvent) {\n    evt.preventDefault();\n    if (this.showLine && this.line) {\n      this.line.nativeElement.style.left = Math.max(evt.pageX - this.left, 50) + 'px';\n    }\n  }\n\n  handleMouseEnter(evt: MouseEvent) {\n    evt.preventDefault();\n    this.left = this.left || this.main.nativeElement.getBoundingClientRect().left;\n    this.showLine = true;\n    if (this.line) {\n      this.renderer.setStyle(this.line.nativeElement, 'display', 'block');\n    }\n  }\n\n  handleMouseOut(evt: MouseEvent) {\n    // evt.preventDefault();\n    if (this.line) {\n      this.showLine = false;\n      this.renderer.setStyle(this.line.nativeElement, 'left', '-100px');\n      this.renderer.setStyle(this.line.nativeElement, 'display', 'none');\n    }\n  }\n\n  update(options, refresh): void {\n    if (options) {\n      let optionChanged = false;\n      Object.keys(options).forEach(opt => {\n        if (this._options.hasOwnProperty(opt)) {\n          optionChanged = optionChanged || !deepEqual(options[opt], this._options[opt]);\n        } else {\n          optionChanged = true; // new unknown option\n        }\n      });\n      if (this.LOG) {\n        this.LOG.debug(['onOptions', 'optionChanged'], optionChanged);\n      }\n      if (optionChanged) {\n        if (this.LOG) {\n          this.LOG.debug(['onOptions', 'options'], options);\n        }\n        this._options = options;\n        this.drawChart(false);\n      }\n      this.drawChart(refresh);\n    } else {\n      this.drawChart(refresh);\n    }\n  }\n\n  inputTextKeyboardEvents(e: KeyboardEvent) {\n    e.stopImmediatePropagation();\n    if (e.key === 'Enter') {\n      this.applyFilter();\n    } else if (e.key === 'Escape') {\n      this.pushKbdEvent('Escape');\n      this.modal.close();\n    }\n  }\n\n  tzSelected() {\n    const timeZone = this.tzSelector.nativeElement.value;\n    this.LOG.debug(['timezone', 'tzselect'], timeZone);\n    this._options.timeZone = timeZone;\n    this.tzSelector.nativeElement.setAttribute('class', timeZone === 'UTC' ? 'defaulttz' : 'customtz');\n    this.drawChart();\n  }\n\n  public getTimeClip(): Promise<ChartBounds> {\n    this.LOG.debug(['getTimeClip'], this.chart.getTimeClip());\n    return this.chart.getTimeClip();\n  }\n\n  resizeChart(event) {\n    this.LOG.debug(['resizeChart'], event);\n    this.sizeService.change(new Size(this.width, event));\n  }\n\n  drawChart(firstDraw: boolean = false) {\n    this.LOG.debug(['drawCharts'], this._data, this._options);\n    if (!this._data || !this._data.data || this._data.data.length === 0) {\n      return;\n    }\n    if (this.timeClip) {\n      this.timeClip.close();\n    }\n    if (this.modal) {\n      this.modal.close();\n    }\n    this.LOG.debug(['PPts'], 'firstdraw ', firstDraw);\n    if (firstDraw) { // on the first draw, we can set some default options.\n      // automatically switch to timestamp mode\n      // when the first tick and last tick of all the series are in the interval [-100ms 100ms]\n      const tsLimit = 100 * GTSLib.getDivider(this._options.timeUnit);\n      const dataList = this._data.data;\n      if (dataList) {\n        let gtsList = GTSLib.flattenGtsIdArray(dataList as any, 0).res;\n        gtsList = GTSLib.flatDeep(gtsList);\n        let timestampMode = true;\n        let totalDatapoints = 0;\n        gtsList.forEach(g => {\n          this.gtsIdList.push(g.id); // usefull for gts browse shortcut\n          if (g.v.length > 0) { // if gts not empty\n            timestampMode = timestampMode && (g.v[0][0] > -tsLimit && g.v[0][0] < tsLimit);\n            timestampMode = timestampMode && (g.v[g.v.length - 1][0] > -tsLimit && g.v[g.v.length - 1][0] < tsLimit);\n            totalDatapoints += g.v.length;\n          }\n        });\n        if (timestampMode) {\n          this._options.timeMode = 'timestamp';\n        }\n        this.LOG.debug(['drawCharts', 'parsed', 'timestampMode'], timestampMode);\n      }\n    }\n    this.gtsList = this._data;\n    this._options = {...this._options};\n\n    this.LOG.debug(['drawCharts', 'parsed'], this._data, this._options);\n    this.resizeArea();\n  }\n\n  focus(event: any) {\n    // read the first 4 letters of id of all elements in the click tree\n    const idListClicked = event.path.map(el => (el.id || '').slice(0, 4));\n    // if not alone on the page, and click is not on the timezone selector and not on the map, force focus.\n    if (!this.isAlone && idListClicked.indexOf('tzSe') < 0 && idListClicked.indexOf('map-') < 0) {\n      this.mainPlotDiv.nativeElement.focus();\n    } // prevent stealing focus of the timezone selector.\n  }\n\n  private async handleKeyPress(ev: KeyboardEvent) {\n    this.LOG.debug(['handleKeyPress'], ev);\n    if (this.preventDefaultKeyList.indexOf(ev.key) >= 0) {\n      ev.preventDefault();\n    }\n    if (await this.timeClip.isOpened() || await this.modal.isOpened() || await this.gtsPopupModal.isOpened()) {\n      if (this.preventDefaultKeyListInModals.indexOf(ev.key) >= 0) {\n        ev.preventDefault();\n      }\n    }\n    if (ev.key === '/') {\n      this.modal.open();\n      this.filterInput.nativeElement.focus();\n      this.filterInput.nativeElement.select();\n    } else if (ev.key === 't') {\n      this.chart.getTimeClip().then(tc => {\n        this.timeClipValue = `<p>keep data between\n          ${this._options.timeMode === 'timestamp' ? tc.tsmin : moment.tz(tc.tsmin, this._options.timeZone).toLocaleString()} and\n          ${this._options.timeMode === 'timestamp' ? tc.tsmax : moment.tz(tc.tsmax, this._options.timeZone).toLocaleString()}\n          ${this._options.timeUnit !== 'us' ? ' (for a ' + this._options.timeUnit + ' platform)' : ''}</p>\n          <pre><code>${Math.round(tc.tsmax)} ${Math.round(tc.tsmax - tc.tsmin)} TIMECLIP</code></pre>`;\n        this.timeClip.open();\n      });\n    } else if (ev.key === 'b' || ev.key === 'B') { // browse among all gts\n      if (this.gtsBrowserIndex < 0) {\n        this.gtsBrowserIndex = 0;\n      }\n      if (ev.key === 'b') { // increment index\n        this.gtsBrowserIndex++;\n        if (this.gtsBrowserIndex === this.gtsIdList.length) {\n          this.gtsBrowserIndex = 0;\n        }\n      } else { // decrement index\n        this.gtsBrowserIndex--;\n        if (this.gtsBrowserIndex < 0) {\n          this.gtsBrowserIndex = this.gtsIdList.length - 1;\n        }\n      }\n      this._toHide = this.gtsIdList.filter(v => v !== this.gtsIdList[this.gtsBrowserIndex]); // hide all but one\n    } else if (ev.key === 'n') {\n      this._toHide = [...this.gtsIdList];\n      return false;\n    } else if (ev.key === 'a') {\n      this._toHide = [];\n    } else if (ev.key === 'Escape') {\n      this.timeClip.isOpened().then(r => {\n        if (r) {\n          this.timeClip.close();\n        }\n      });\n      this.modal.isOpened().then(r => {\n        if (r) {\n          this.modal.close();\n        }\n      });\n      this.gtsPopupModal.isOpened().then(r => {\n        if (r) {\n          this.gtsPopupModal.close();\n        }\n      });\n    } else {\n      this.pushKbdEvent(ev.key);\n    }\n    this.LOG.debug(['handleKeyPress', 'this.gtsIdList'], this._toHide, this.gtsBrowserIndex);\n  }\n\n  applyFilter() {\n    this.gtsFilterCount++;\n    this._gtsFilter = this.gtsFilterCount.toString().slice(0, 1) + this.filterInput.nativeElement.value;\n    this.modal.close();\n  }\n\n  private pushKbdEvent(key: string) {\n    this.kbdCounter++;\n    this.kbdLastKeyPressed = [key, this.kbdCounter.toString()];\n  }\n\n  getTZ() {\n    return moment.tz.names();\n  }\n\n  protected convert(data: DataModel): any[] {\n    return [];\n  }\n\n  onChartDraw($event: any) {\n    if (\n      this.chartBounds\n      && $event\n      && this.chartBounds.tsmin !== Math.min(this.chartBounds.tsmin, $event.tsmin)\n      && this.chartBounds.tsmax !== Math.max(this.chartBounds.tsmax, $event.tsmax)\n    ) {\n      this.chartBounds.tsmin = Math.min(this.chartBounds.tsmin, $event.tsmin);\n      this.chartBounds.tsmax = Math.max(this.chartBounds.tsmax, $event.tsmax);\n      this.annotation.setRealBounds(this.chartBounds);\n      this.chart.setRealBounds(this.chartBounds);\n      this.chartDraw.emit();\n      this.LOG.debug(['onChartDraw', 'this.chartBounds'], this.chartBounds, $event);\n    }\n    this.chartDraw.emit($event);\n  }\n\n  private resizeArea() {\n    setTimeout(() => {\n      let h = this.el.nativeElement.getBoundingClientRect().height;\n      if (h > 0) {\n        if (!!this.GTSTree) {\n          h -= this.GTSTree.nativeElement.getBoundingClientRect().height;\n        }\n        if (!!this.controls) {\n          h -= this.controls.nativeElement.getBoundingClientRect().height;\n        }\n        this.initialChartHeight = h;\n      }\n    });\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {AfterViewInit, Component, ElementRef, EventEmitter, Input, Output, Renderer2, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {Logger} from '../../utils/logger';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-resize',\n  templateUrl: './warp-view-resize.component.html',\n  styleUrls: ['./warp-view-resize.component.scss'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class WarpViewResizeComponent implements AfterViewInit {\n  @ViewChild('handleDiv', {static: true}) handleDiv: ElementRef;\n  @ViewChild('wrapper', {static: true}) wrapper: ElementRef;\n  @Input('minHeight') minHeight = '10';\n  @Input('initialHeight') initialHeight = 100;\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Output('resize') resize = new EventEmitter();\n\n  private dragging = false;\n  private moveListener: EventListener;\n  private clickUpListener: EventListener;\n  private LOG: Logger;\n  private _debug = false;\n\n  constructor(private el: ElementRef, private renderer: Renderer2) {\n    this.LOG = new Logger(WarpViewResizeComponent, this._debug);\n  }\n\n  ngAfterViewInit(): void {\n    this.LOG.debug(['ngAfterViewInit'], this.initialHeight);\n    this.renderer.setStyle(this.wrapper.nativeElement, 'height', this.initialHeight + 'px');\n    // the click event on the handlebar attach mousemove and mouseup events to document.\n    this.handleDiv.nativeElement.addEventListener('mousedown', (ev: MouseEvent) => {\n      if (0 === ev.button) {\n        // keep left click only\n        this.moveListener = this.handleDraggingMove.bind(this);\n        this.clickUpListener = this.handleDraggingEnd.bind(this);\n        document.addEventListener('mousemove', this.moveListener, false);\n        document.addEventListener('mouseup', this.clickUpListener, false);\n      }\n    });\n  }\n\n  private handleDraggingEnd() {\n    this.dragging = false;\n    // the mouseup detach mousemove and mouseup events from document.\n    if (this.moveListener) {\n      document.removeEventListener('mousemove', this.moveListener, false);\n      this.moveListener = null;\n    }\n    if (this.clickUpListener) {\n      document.removeEventListener('mouseup', this.clickUpListener, false);\n      this.clickUpListener = null;\n    }\n  }\n\n  private handleDraggingMove(ev: MouseEvent) {\n    ev.preventDefault();\n    this.LOG.debug(['handleDraggingMove'], ev);\n    // compute Y of the parent div top relative to page\n    const yTopParent = this.handleDiv.nativeElement.parentElement.getBoundingClientRect().top\n      - document.body.getBoundingClientRect().top;\n    // compute new parent height\n    let h = ev.pageY - yTopParent + this.handleDiv.nativeElement.getBoundingClientRect().height / 2;\n    if (h < parseInt(this.minHeight, 10)) {\n      h = parseInt(this.minHeight, 10);\n    }\n    // apply new height\n    this.renderer.setStyle(this.handleDiv.nativeElement.parentElement, 'height', h + 'px');\n    this.LOG.debug(['handleDraggingMove'], h);\n    this.resize.emit(h);\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\nimport {AfterViewInit, Component, ElementRef, EventEmitter, Input, Output, ViewChild, ViewEncapsulation} from '@angular/core';\nimport moment from 'moment';\nimport {Logger} from '../../utils/logger';\nimport * as noUiSlider from 'nouislider';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-slider',\n  templateUrl: './warp-view-slider.component.html',\n  styleUrls: ['./warp-view-slider.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewSliderComponent implements AfterViewInit {\n  @ViewChild('slider', { static: false }) slider: ElementRef<HTMLDivElement>;\n\n  @Input('min') set min(m) {\n    this.LOG.debug(['min'], m);\n    this._min = m;\n    this.setOptions();\n  }\n\n  get min() {\n    return this._min;\n  }\n\n  @Input('max') set max(m) {\n    this.LOG.debug(['max'], m);\n    this._max = m;\n    this.setOptions();\n  }\n\n  get max() {\n    return this._max;\n  }\n\n\n  @Input('value') value: number;\n\n  @Input('step') set step(step: number) {\n    this.LOG.debug(['step'], step);\n    if (this._step !== step) {\n      this._step = step;\n      this.setOptions();\n    }\n  }\n\n  get step() {\n    return this._step;\n  }\n\n  @Input('mode') mode = 'timestamp';\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Output('change') change = new EventEmitter();\n\n  _min: number;\n  _max: number;\n  show = false;\n  protected _uiSlider;\n  protected _step = 0;\n  protected LOG: Logger;\n  loaded = false;\n  protected manualRefresh: EventEmitter<void> = new EventEmitter<void>();\n  protected _debug = false;\n\n  constructor() {\n    this.LOG = new Logger(WarpViewSliderComponent, this.debug);\n    this.LOG.debug(['constructor'], this.debug);\n  }\n\n  ngAfterViewInit(): void {\n    this.loaded = false;\n    this.setOptions();\n  }\n\n  protected setOptions() {\n    if (!this._min && !this._max) {\n      return;\n    }\n    this.LOG.debug(['_step'], this._step);\n    const tmpVAl = Math.min(Math.max(this.value || Number.MIN_VALUE, this._min), this._max);\n    if (tmpVAl !== this.value && this.loaded) {\n      this.change.emit(tmpVAl);\n    }\n    this.value = tmpVAl;\n    this.loaded = true;\n    this.LOG.debug(['noUiSlider'], this.slider);\n    if (this.slider) {\n      if (!this._uiSlider) {\n        const opts = {\n          start: [this.value + 1],\n          tooltips: [this.getFormat()],\n          range: {min: [this._min], max: [this._max]}\n        } as any;\n        if (!!this._step && this._step > 0) {\n          opts.step = Math.floor((this._max - this._min) / this._step);\n        }\n        this._uiSlider = noUiSlider.create(this.slider.nativeElement, opts);\n        this._uiSlider.on('end', event => {\n          this.LOG.debug(['onChange'], event);\n          this.value = parseInt(event[0], 10);\n          this.change.emit({value: parseInt(event[0], 10)});\n        });\n      } else {\n        this.updateSliderOptions();\n      }\n    }\n  }\n\n  protected updateSliderOptions() {\n    // tslint:disable-next-line:no-string-literal\n    this.slider.nativeElement['noUiSlider'].set([this.value]);\n    const opts = {range: {min: [this._min], max: [this._max]}} as any;\n    if (!!this._step && this._step > 0) {\n      opts.step = Math.floor((this._max - this._min) / this._step);\n    }\n    // tslint:disable-next-line:no-string-literal\n    this.slider.nativeElement['noUiSlider'].updateOptions(opts);\n  }\n\n  format(value: number) {\n    if (this.mode !== 'timestamp') {\n      return moment(value).utc(true).format('YYYY/MM/DD hh:mm:ss');\n    } else {\n      return value.toString();\n    }\n  }\n\n  protected getFormat() {\n    return {\n      to: value => this.format(value),\n      from: value => value.replace(',-', '')\n    };\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\nimport {AfterViewInit, Component, ElementRef, Input, OnInit, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {WarpViewSliderComponent} from '../warp-view-slider/warp-view-slider.component';\nimport {Logger} from '../../utils/logger';\nimport * as noUiSlider from 'nouislider';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-range-slider',\n  templateUrl: './warp-view-range-slider.component.html',\n  styleUrls: ['./warp-view-range-slider.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewRangeSliderComponent extends WarpViewSliderComponent implements OnInit, AfterViewInit {\n  @ViewChild('slider', { static: false }) slider: ElementRef<HTMLDivElement>;\n  @Input('minValue') minValue: number;\n  @Input('maxValue') maxValue: number;\n\n  constructor() {\n    super();\n    this.LOG = new Logger(WarpViewRangeSliderComponent, this.debug);\n    this.LOG.debug(['constructor'], this.debug);\n  }\n\n  ngOnInit(): void {\n    this.setOptions();\n    this.minValue = this.minValue || this._min;\n    this.maxValue = this.maxValue || this._max;\n  }\n\n  ngAfterViewInit(): void {\n    this.loaded = false;\n    this.setOptions();\n  }\n\n  onChange(val) {\n    this.change.emit({value: this.minValue, highValue: this.maxValue});\n    this.LOG.debug(['onChange'], val, {value: this.minValue, highValue: this.maxValue});\n  }\n\n  protected setOptions() {\n    this.LOG.debug(['setOptions'], this._min, this._max);\n    if (!this._min && !this._max) {\n      return;\n    }\n    this.loaded = true;\n    this.value = Math.max(this.value || Number.MIN_VALUE, this._min);\n    this.LOG.debug(['noUiSlider'], this.slider);\n    if (this.slider) {\n      if (!this._uiSlider) {\n        const opts = {\n          start: [this.minValue, this.maxValue],\n          connect: true,\n          tooltips: [this.getFormat(), this.getFormat()],\n          range: {min: [this._min], max: [this._max]}\n        } as any;\n        if (!!this._step && this._step > 0) {\n          opts.step = Math.floor((this._max - this._min) / this._step);\n        }\n        const uiSlider = noUiSlider.create(this.slider.nativeElement, opts);\n        uiSlider.on('end', event => {\n          this.LOG.debug(['onChange'], event);\n          this.change.emit({\n            min: parseInt(event[0], 10),\n            max: parseInt(event[1], 10)\n          });\n        });\n      } else {\n        this.updateSliderOptions();\n      }\n    }\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, Input, NgZone, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {VisibilityState, WarpViewComponent} from '../warp-view-component';\nimport {DataModel} from '../../model/dataModel';\nimport {Param} from '../../model/param';\nimport {ColorLib} from '../../utils/color-lib';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\nimport moment from 'moment-timezone';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\n\n@Component({\n  selector: 'warpview-spectrum',\n  templateUrl: './warp-view-spectrum.component.html',\n  styleUrls: ['./warp-view-spectrum.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewSpectrumComponent extends WarpViewComponent {\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  layout: Partial<any> = {\n    showlegend: false,\n    xaxis: {},\n    yaxis: {},\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 50\n    }\n  };\n  private _type = 'histogram2d';\n  private visibility: boolean[] = [];\n  private visibilityStatus: VisibilityState = 'unknown';\n  private maxTick = 0;\n  private minTick = 0;\n  private visibleGtsId = [];\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewSpectrumComponent, this._debug);\n  }\n\n  update(options: Param): void {\n    this.drawChart();\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.plotlyConfig.scrollZoom = true;\n    this.buildGraph();\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const type = this._options.histo || {histnorm: 'density', histfunc: 'count'};\n    const dataset: Partial<any>[] = [];\n    this.LOG.debug(['convert'], this._options);\n    this.visibility = [];\n    let gtsList = GTSLib.flatDeep(GTSLib.flattenGtsIdArray([ data.data] as any[], 0).res) || [];\n    this.maxTick = Number.NEGATIVE_INFINITY;\n    this.minTick = Number.POSITIVE_INFINITY;\n    this.visibleGtsId = [];\n    const nonPlottable = gtsList.filter(g => {\n      this.LOG.debug(['convert'], GTSLib.isGtsToPlot(g));\n      return (g.v && !GTSLib.isGtsToPlot(g));\n    });\n    gtsList = gtsList.filter(g => {\n      return (g.v && GTSLib.isGtsToPlot(g));\n    });\n    // initialize visibility status\n    if (this.visibilityStatus === 'unknown') {\n      this.visibilityStatus = gtsList.length > 0 ? 'plottableShown' : 'nothingPlottable';\n    }\n\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      this.layout.xaxis.type = 'linear';\n    } else {\n      this.layout.xaxis.type = 'date';\n    }\n    gtsList.forEach((gts: GTS, i) => {\n      if (gts.v && GTSLib.isGtsToPlot(gts)) {\n        const label = GTSLib.serializeGtsMetadata(gts);\n        const c = ColorLib.getColor(i, this._options.scheme);\n        const color = ((data.params || [])[gts.id] || {datasetColor: c}).datasetColor || c;\n        const series: Partial<any> = {\n          type: this._type,\n          histnorm: type.histnorm || 'density',\n          histfunc: type.histfunc || 'count',\n          contours: {\n            showlabels: true,\n            labelfont: {\n              color: 'white'\n            }\n          },\n          colorbar: {\n            tickcolor: this.getGridColor(this.el.nativeElement),\n            thickness: 0,\n            tickfont: {\n              color: this.getLabelColor(this.el.nativeElement)\n            },\n            x: 1 + gts.id / 20,\n            xpad: 0\n          },\n          showscale: this.showLegend,\n          colorscale: ColorLib.getColorGradient(gts.id, this._options.scheme),\n          autocolorscale: false,\n          name: label,\n          text: label,\n          x: [],\n          y: [],\n          line: {color},\n          hoverinfo: 'none',\n          connectgaps: false,\n          visible: this._hiddenData.filter(h => h === gts.id).length >= 0,\n        };\n        gts.v.forEach(value => {\n          const ts = value[0];\n          series.y.push(value[value.length - 1]);\n          if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n            series.x.push(ts);\n          } else {\n            series.x.push(moment.tz(moment.utc(ts / this.divider), this._options.timeZone).toISOString());\n          }\n        });\n        dataset.push(series);\n      }\n    });\n    this.LOG.debug(['convert', 'dataset'], dataset);\n\n    return dataset;\n  }\n\n  private buildGraph() {\n    this.LOG.debug(['drawChart', 'this.layout'], this.responsive);\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.layout.showlegend = this.showLegend;\n    this.layout.yaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.color = this.getGridColor(this.el.nativeElement);\n    this.loading = false;\n  }\n}\n","import {Component, ElementRef, Input, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {DataModel} from '../../model/dataModel';\nimport {Param} from '../../model/param';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {ColorLib} from '../../utils/color-lib';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\nimport moment from 'moment-timezone';\n\n@Component({\n  selector: 'warpview-box',\n  templateUrl: './warp-view-box.component.html',\n  styleUrls: ['./warp-view-box.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewBoxComponent extends WarpViewComponent implements OnInit {\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  layout: Partial<any> = {\n    showlegend: false,\n    xaxis: {\n      type: '-'\n    },\n    yaxis: {zeroline: false},\n    boxmode: 'group',\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 10\n    }\n  };\n  private _type = 'box';\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewBoxComponent, this._debug);\n  }\n\n  ngOnInit() {\n    this.drawChart();\n  }\n\n  update(options: Param): void {\n    this.drawChart();\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.plotlyConfig.scrollZoom = true;\n    this.buildGraph();\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const dataset: Partial<any>[] = [];\n    this.LOG.debug(['convert'], this._options, this._type);\n    let gtsList = GTSLib.flatDeep(GTSLib.flattenGtsIdArray(data.data as any[], 0).res);\n    gtsList = gtsList.filter(g => {\n      return (g.v && GTSLib.isGtsToPlot(g));\n    });\n    const pattern = 'YYYY/MM/DD hh:mm:ss';\n    const format = pattern.slice(0, pattern.lastIndexOf(this._options.split || 'D') + 1);\n    gtsList.forEach((gts: GTS, i) => {\n      if (gts.v) {\n        const label = GTSLib.serializeGtsMetadata(gts);\n        const c = ColorLib.getColor(gts.id, this._options.scheme);\n        const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n        const series: Partial<any> = {\n          type: 'box',\n          boxmean: 'sd',\n          marker: {color},\n          name: label,\n          x: this._type === 'box' ? undefined : [],\n          y: [],\n          //  hoverinfo: 'none',\n          boxpoints: false\n        };\n        if (!!this._options.showDots) {\n          series.boxpoints = 'all';\n        }\n        gts.v.forEach(value => {\n          series.y.push(value[value.length - 1]);\n          if (this._type === 'box-date') {\n            series.x.push(moment.tz(moment.utc(value[0] / this.divider), this._options.timeZone).toISOString());\n          }\n        });\n        dataset.push(series);\n      }\n    });\n    this.LOG.debug(['convert', 'dataset'], dataset, format);\n    return dataset;\n  }\n\n  private buildGraph() {\n    this.LOG.debug(['drawChart', 'this.layout'], this.responsive);\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.layout.showlegend = this.showLegend;\n    this.layout.xaxis.showticklabels = this._type === 'box-date';\n    this.layout.yaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.color = this.getGridColor(this.el.nativeElement);\n    this.loading = false;\n  }\n\n  hover(data: any) {\n\n  }\n}\n","import {Component, ElementRef, Input, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {Param} from '../../model/param';\nimport {DataModel} from '../../model/dataModel';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\nimport {ColorLib} from '../../utils/color-lib';\n\n@Component({\n  selector: 'warpview-3d-line',\n  templateUrl: './warp-view-3d-line.component.html',\n  styleUrls: ['./warp-view-3d-line.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpView3dLineComponent extends WarpViewComponent implements OnInit {\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  layout: Partial<any> = {\n    showlegend: false,\n    xaxis: {},\n    yaxis: {},\n    zaxis: {},\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 10\n    }\n  };\n  private _type = 'line3d';\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpView3dLineComponent, this._debug);\n  }\n\n  ngOnInit() {\n    this.drawChart();\n  }\n\n  update(options: Param): void {\n    this.drawChart();\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.plotlyConfig.scrollZoom = true;\n    this.buildGraph();\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const dataset: Partial<any>[] = [];\n    this.LOG.debug(['convert'], data, this._options, this._type);\n    GTSLib.flatDeep(GTSLib.flattenGtsIdArray(data.data as any[], 0).res)\n      .filter(g => (g.v && GTSLib.isGts(g)))\n      .forEach((gts: GTS, i) => {\n        if (gts.v) {\n          const label = GTSLib.serializeGtsMetadata(gts);\n          const c = ColorLib.getColor(gts.id, this._options.scheme);\n          const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n          const series: Partial<any> = {\n            mode: 'line',\n            type: 'scatter3d',\n            marker: {\n              color: ColorLib.transparentize(color),\n              size: 3,\n              symbol: 'circle',\n              line: {\n                color,\n                width: 0\n              }\n            },\n            line: {\n              color,\n              width: 1\n            },\n            name: label,\n            x: [],\n            y: [],\n            z: [],\n            //     hoverinfo: 'none',\n          };\n          gts.v.forEach(value => {\n            if (value.length > 2) { // lat lon\n              series.x.push(value[1]);\n              series.y.push(value[2]);\n              if (value.length > 4) {\n                series.z.push(value[3]);\n              } else {\n                series.z.push(0);\n              }\n            } else {\n              series.x.push(value[0]);\n              series.y.push(value[1]);\n              series.z.push(0);\n            }\n          });\n          dataset.push(series);\n        }\n      });\n    return dataset;\n  }\n\n  private buildGraph() {\n    this.LOG.debug(['drawChart', 'this.layout'], this.responsive);\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.layout.showlegend = this.showLegend;\n    this.layout.yaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.zaxis.color = this.getGridColor(this.el.nativeElement);\n    this.loading = false;\n  }\n}\n","import {Component, ElementRef, Input, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {Param} from '../../model/param';\nimport {DataModel} from '../../model/dataModel';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\nimport {ColorLib} from '../../utils/color-lib';\nimport {MapLib} from '../../utils/map-lib';\n\n@Component({\n  selector: 'warpview-globe',\n  templateUrl: './warp-view-globe.component.html',\n  styleUrls: ['./warp-view-globe.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewGlobeComponent extends WarpViewComponent implements OnInit {\n\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  layout: Partial<any> = {\n    showlegend: false,\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 10\n    },\n    geo: {\n      projection: {\n        type: 'orthographic',\n      },\n      showframe: true,\n      fitbounds: 'locations',\n      showocean: true,\n      oceancolor: ColorLib.transparentize('#004eff', 0.2),\n      showland: true,\n      landcolor: ColorLib.transparentize('#6F694E', 0.2),\n      showlakes: true,\n      lakecolor: ColorLib.transparentize('#004eff', 0.2),\n      showcountries: true,\n      lonaxis: {\n        showgrid: true,\n        gridcolor: 'rgb(102, 102, 102)'\n      },\n      lataxis: {\n        showgrid: true,\n        gridcolor: 'rgb(102, 102, 102)'\n      }\n    }\n  };\n  private _type = 'scattergeo';\n  private geoData: { path: { lat: number, lon: number }[] }[] = [];\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewGlobeComponent, this._debug);\n  }\n\n  ngOnInit() {\n    this.drawChart();\n  }\n\n  update(options: Param): void {\n    this.drawChart();\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.plotlyConfig.scrollZoom = true;\n    this.buildGraph();\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const dataset: Partial<any>[] = [];\n    this.geoData = [];\n    this.LOG.debug(['convert'], data, this._options, this._type);\n    GTSLib.flatDeep(GTSLib.flattenGtsIdArray(data.data as any[], 0).res)\n      .filter(g => (g.v && GTSLib.isGts(g)))\n      .forEach((gts: GTS, i) => {\n        if (gts.v) {\n          const geoData = {path: []};\n          const label = GTSLib.serializeGtsMetadata(gts);\n          const c = ColorLib.getColor(gts.id, this._options.scheme);\n          const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n          const series: Partial<any> = {\n            mode: 'lines',\n            type: 'scattergeo',\n            marker: {\n              color: ColorLib.transparentize(color),\n              size: 3,\n              symbol: 'circle',\n              line: {\n                color,\n                width: 0\n              }\n            },\n            line: {\n              color,\n              width: 1\n            },\n            name: label,\n            lon: [],\n            lat: [],\n            hoverinfo: 'none',\n          };\n          gts.v.forEach(value => {\n            if (value.length > 2) {\n              series.lat.push(value[1]);\n              series.lon.push(value[2]);\n              geoData.path.push({lat: value[1], lon: value[2]});\n            }\n          });\n          this.geoData.push(geoData);\n          dataset.push(series);\n        }\n      });\n    return dataset;\n  }\n\n  private buildGraph() {\n    this.LOG.debug(['drawChart', 'this.layout'], this._responsive);\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.layout.showlegend = this._showLegend;\n    const bounds = MapLib.getBoundsArray(this.geoData, [], [], []);\n    this.LOG.debug(['drawChart', 'bounds'], bounds);\n    this.layout.geo.lonaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.geo.lataxis.range = [bounds[0][0], bounds[1][0]];\n    this.layout.geo.lonaxis.range = [bounds[0][1], bounds[1][1]];\n    this.layout.geo.lataxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout = {...this.layout};\n    this.loading = false;\n  }\n\n}\n","import {\n  Component,\n  ElementRef,\n  EventEmitter,\n  Input,\n  NgZone,\n  OnDestroy,\n  OnInit,\n  Output,\n  Renderer2,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport deepEqual from 'deep-equal';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {Param} from '../../model/param';\nimport {DataModel} from '../../model/dataModel';\nimport {ColorLib} from '../../utils/color-lib';\nimport * as d3 from 'd3';\nimport eventDrops from 'event-drops';\nimport {GTSLib} from '../../utils/gts.lib';\nimport moment from 'moment-timezone';\nimport {select} from 'd3-selection';\n\n@Component({\n  selector: 'warpview-event-drop',\n  templateUrl: './warp-view-event-drop.component.html',\n  styleUrls: ['./warp-view-event-drop.component.scss'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class WarpViewEventDropComponent extends WarpViewComponent implements OnInit, OnDestroy {\n  @ViewChild('elemChart', {static: true}) elemChart: ElementRef;\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    const previousVisibility = JSON.stringify(this.visibility);\n    this.LOG.debug(['hiddenData', 'previousVisibility'], previousVisibility);\n    this._hiddenData = hiddenData;\n    this.visibility = [];\n    this.visibleGtsId.forEach(id => this.visibility.push(hiddenData.indexOf(id) < 0 && (id !== -1)));\n    this.LOG.debug(['hiddenData', 'hiddendygraphfullv'], this.visibility);\n    const newVisibility = JSON.stringify(this.visibility);\n    this.LOG.debug(['hiddenData', 'json'], previousVisibility, newVisibility);\n    if (previousVisibility !== newVisibility) {\n      this.drawChart();\n      this.LOG.debug(['hiddendygraphtrig', 'destroy'], 'redraw by visibility change');\n    }\n  }\n\n  @Output('pointHover') pointHover = new EventEmitter<any>();\n  @Output('warpViewChartResize') warpViewChartResize = new EventEmitter<any>();\n  @Output('chartDraw') chartDraw = new EventEmitter<any>();\n  @Output('boundsDidChange') boundsDidChange = new EventEmitter<any>();\n\n  private visibility: boolean[] = [];\n  private maxTick = Number.MIN_VALUE;\n  private minTick = Number.MAX_VALUE;\n  private visibleGtsId = [];\n  private _type = 'drops';\n  private eventConf = {\n    d3,\n    axis: {\n      verticalGrid: true,\n      tickPadding: 6,\n    },\n    indicator: false,\n    label: {\n      text: row => row.name,\n    },\n    drop: {\n      date: d => new Date(d.date),\n      color: d => d.color,\n      onMouseOver: g => {\n        this.LOG.debug(['onMouseOver'], g);\n        this.pointHover.emit({\n          x: d3.event.offsetX,\n          y: d3.event.offsetY\n        });\n        const t = d3\n          .select(this.toolTip.nativeElement);\n        t.transition()\n          .duration(200)\n          .style('opacity', 1)\n          .style('pointer-events', 'auto');\n        t.html(`<div class=\"tooltip-body\">\n<b class=\"tooltip-date\">${this._options.timeMode === 'timestamp'\n          ? g.date\n          : (moment(g.date.valueOf()).utc().toISOString() || '')}</b>\n<div><i class=\"chip\"  style=\"background-color: ${ColorLib.transparentize(g.color, 0.7)};border: 2px solid ${g.color};\"></i>\n${GTSLib.formatLabel(g.name)}: <span class=\"value\">${g.value}</span>\n</div></div>`\n        )\n          .style('left', `${d3.event.offsetX - 30}px`)\n          .style('top', `${d3.event.offsetY + 20}px`);\n      },\n      onMouseOut: () => {\n        select(this.toolTip.nativeElement)\n          .transition()\n          .duration(500)\n          .style('opacity', 0)\n          .style('pointer-events', 'none');\n      },\n    },\n  };\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewEventDropComponent, this._debug);\n  }\n\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  ngOnDestroy(): void {\n    if (!!this.elemChart) {\n      select(this.elemChart.nativeElement).remove();\n    }\n  }\n\n  update(options, refresh): void {\n    this.LOG.debug(['onOptions', 'before'], this._options, options);\n    if (!deepEqual(options, this._options)) {\n      this.LOG.debug(['options', 'changed'], options);\n      this._options = ChartLib.mergeDeep(this._options, options as Param) as Param;\n    }\n    this.drawChart();\n  }\n\n  updateBounds(min, max) {\n    this.LOG.debug(['updateBounds'], min, max, this._options);\n    this._options.bounds.minDate = min;\n    this._options.bounds.maxDate = max;\n\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      this.eventConf['range'] = {start: min, end: max};\n    } else {\n      this.eventConf['range'] = {\n        start: moment.tz(moment.utc(this.minTick / this.divider), this._options.timeZone).toDate(),\n        end: moment.tz(moment.utc(this.maxTick / this.divider), this._options.timeZone).toDate(),\n      };\n    }\n    this.eventConf = {...this.eventConf};\n    this.LOG.debug(['updateBounds'], this.eventConf);\n  }\n\n  drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.loading = false;\n    this.LOG.debug(['drawChart', 'plotlyData'], this.plotlyData, this._type);\n    if (this.elemChart.nativeElement) {\n      setTimeout(() => select(this.elemChart.nativeElement).data([this.plotlyData]).call(eventDrops(this.eventConf)));\n      this.loading = false;\n      this.chartDraw.emit();\n    }\n  }\n\n  protected convert(data: DataModel): any[] {\n    this.LOG.debug(['convert'], data);\n    const gtsList = GTSLib.flatDeep(data.data as any[]);\n    const dataList = [];\n    this.LOG.debug(['convert', 'gtsList'], gtsList);\n    if (!gtsList || gtsList.length === 0 || gtsList[0].length < 2) {\n      return;\n    }\n    gtsList.forEach((gts, i) => {\n      const c = ColorLib.getColor(gts.id || i, this._options.scheme);\n      const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n      const dataSet = {\n        name: GTSLib.serializeGtsMetadata(gts),\n        color,\n        data: []\n      };\n      (gts.v || []).forEach(value => {\n        const ts = value[0];\n        this.minTick = Math.min(this.minTick, ts);\n        this.maxTick = Math.max(this.maxTick, ts);\n        if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n          dataSet.data.push({date: ts, color, value: value[value.length - 1]});\n        } else {\n          dataSet.data.push({\n            date: moment.tz(moment.utc(ts / this.divider), this._options.timeZone).toDate(),\n            color,\n            value: value[value.length - 1],\n            name: dataSet.name\n          });\n        }\n      });\n      dataList.push(dataSet);\n    });\n    this.LOG.debug(['convert', 'dataList'], dataList);\n    this.eventConf['range'] = {\n      start: moment.tz(moment.utc(this.minTick / this.divider), this._options.timeZone).toDate(),\n      end: moment.tz(moment.utc(this.maxTick / this.divider), this._options.timeZone).toDate(),\n    };\n    return dataList;\n  }\n}\n","import {Component, ElementRef, EventEmitter, Input, NgZone, Output, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Size, SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {Param} from '../../model/param';\nimport {DataModel} from '../../model/dataModel';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {ResizedEvent} from 'angular-resize-event';\n\n@Component({\n  selector: 'warpview-result-tile',\n  templateUrl: './warp-view-result-tile.component.html',\n  styleUrls: ['./warp-view-result-tile.component.scss']\n})\nexport class WarpViewResultTileComponent extends WarpViewComponent {\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n  }\n\n  get type(): string {\n    if (this.dataModel && this.dataModel.globalParams) {\n      return this.dataModel.globalParams.type || this._type || 'plot';\n    } else {\n      return this._type || 'plot';\n    }\n  }\n\n  @Input('standalone') standalone = true;\n  @Output('pointHover') pointHover = new EventEmitter<any>();\n  @Output('warpViewChartResize') warpViewChartResize = new EventEmitter<any>();\n  @Output('chartDraw') chartDraw = new EventEmitter<any>();\n  @Output('boundsDidChange') boundsDidChange = new EventEmitter<any>();\n\n  loading = true;\n  dataModel: DataModel;\n  graphs = {\n    spectrum: ['histogram2dcontour', 'histogram2d'],\n    chart: ['line', 'spline', 'step', 'step-after', 'step-before', 'area', 'scatter'],\n    pie: ['pie', 'donut'],\n    polar: ['polar'],\n    radar: ['radar'],\n    bar: ['bar'],\n    bubble: ['bubble'],\n    annotation: ['annotation'],\n    'gts-tree': ['gts-tree'],\n    datagrid: ['datagrid'],\n    display: ['display'],\n    drilldown: ['drilldown'],\n    image: ['image'],\n    map: ['map'],\n    gauge: ['gauge', 'bullet'],\n    plot: ['plot'],\n    box: ['box', 'box-date'],\n    line3d: ['line3d'],\n    globe: ['globe'],\n    drops: ['drops']\n  };\n\n  private _type;\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewResultTileComponent, this._debug);\n  }\n\n  protected update(options: Param, refresh: boolean): void {\n    setTimeout(() => this.loading = true);\n    this.LOG.debug(['parseGTS', 'data'], this._data);\n    this.dataModel = this._data;\n    if (!!this.dataModel) {\n      this._options = ChartLib.mergeDeep(this._options, options) as Param;\n      this._options = ChartLib.mergeDeep(ChartLib.mergeDeep(this.defOptions, options),\n        this._data ? this._data.globalParams || {} : {}) as Param;\n      this.LOG.debug(['parseGTS', 'data'], this._data);\n      this.dataModel = this._data;\n      if (this._options) {\n        this._unit = this._options.unit || this._unit;\n        this._type = this._options.type || this._type || 'plot';\n      }\n      this.LOG.debug(['parseGTS', '_type'], this._type);\n      setTimeout(() => this.loading = false);\n    }\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    setTimeout(() => this.loading = true);\n    this.LOG.debug(['convert', 'data'], this._data, data);\n    this.dataModel = data;\n    if (this.dataModel.globalParams) {\n      this._unit = this.dataModel.globalParams.unit || this._unit;\n      this._type = this.dataModel.globalParams.type || this._type || 'plot';\n    }\n    this.LOG.debug(['convert', '_type'], this._type);\n    return [];\n  }\n\n  onResized(event: ResizedEvent) {\n    this.width = event.newWidth;\n    this.height = event.newHeight;\n    this.LOG.debug(['onResized'], event.newWidth, event.newHeight);\n    this.sizeService.change(new Size(this.width, this.height));\n  }\n\n  chartDrawn() {\n    this.LOG.debug(['chartDrawn']);\n    setTimeout(() => this.loading = false);\n    this.chartDraw.emit();\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {WarpViewChartComponent} from './elements/warp-view-chart/warp-view-chart.component';\nimport {WarpViewTileComponent} from './elements/warp-view-tile/warp-view-tile.component';\nimport {WarpViewSpinnerComponent} from './elements/warp-view-spinner/warp-view-spinner.component';\nimport {HttpClientModule} from '@angular/common/http';\nimport {HttpErrorHandler} from './services/http-error-handler.service';\nimport {WarpViewToggleComponent} from './elements/warp-view-toggle/warp-view-toggle.component';\nimport {WarpViewBarComponent} from './elements/warp-view-bar/warp-view-bar.component';\nimport {WarpViewBubbleComponent} from './elements/warp-view-bubble/warp-view-bubble.component';\nimport {WarpViewDatagridComponent} from './elements/warp-view-datagrid/warp-view-datagrid.component';\nimport {WarpViewPaginableComponent} from './elements/warp-view-datagrid/warp-view-paginable/warp-view-paginable.component';\nimport {WarpViewDisplayComponent} from './elements/warp-view-display/warp-view-display.component';\nimport {WarpViewDrillDownComponent} from './elements/warp-view-drill-down/warp-view-drill-down.component';\nimport {CalendarHeatmapComponent} from './elements/warp-view-drill-down/calendar-heatmap/calendar-heatmap.component';\nimport {WarpViewGtsPopupComponent} from './elements/warp-view-gts-popup/warp-view-gts-popup.component';\nimport {WarpViewModalComponent} from './elements/warp-view-modal/warp-view-modal.component';\nimport {WarpViewGtsTreeComponent} from './elements/warp-view-gts-tree/warp-view-gts-tree.component';\nimport {WarpViewTreeViewComponent} from './elements/warp-view-gts-tree/warp-view-tree-view/warp-view-tree-view.component';\nimport {WarpViewChipComponent} from './elements/warp-view-gts-tree/warp-view-chip/warp-view-chip.component';\nimport {WarpViewImageComponent} from './elements/warp-view-image/warp-view-image.component';\nimport {WarpViewMapComponent} from './elements/warp-view-map/warp-view-map.component';\nimport {WarpViewHeatmapSlidersComponent} from './elements/warp-view-map/warp-view-heatmap-sliders/warp-view-heatmap-sliders.component';\nimport {WarpViewPieComponent} from './elements/warp-view-pie/warp-view-pie.component';\nimport {WarpViewGaugeComponent} from './elements/warp-view-gauge/warp-view-gauge.component';\nimport {WarpViewAnnotationComponent} from './elements/warp-view-annotation/warp-view-annotation.component';\nimport {WarpViewPolarComponent} from './elements/warp-view-polar/warp-view-polar.component';\nimport {WarpViewRadarComponent} from './elements/warp-view-radar/warp-view-radar.component';\nimport {WarpViewPlotComponent} from './elements/warp-view-plot/warp-view-plot.component';\nimport {WarpViewResizeComponent} from './elements/warp-view-resize/warp-view-resize.component';\nimport {WarpViewSliderComponent} from './elements/warp-view-slider/warp-view-slider.component';\nimport {WarpViewRangeSliderComponent} from './elements/warp-view-range-slider/warp-view-range-slider.component';\nimport {FormsModule} from '@angular/forms';\nimport {AngularResizedEventModule} from 'angular-resize-event';\nimport {SizeService} from './services/resize.service';\nimport {WarpViewSpectrumComponent} from './elements/warp-view-spectrum/warp-view-spectrum.component';\nimport {PlotlyComponent} from './plotly/plotly.component';\nimport {WarpViewBoxComponent} from './elements/warp-view-box/warp-view-box.component';\nimport {WarpView3dLineComponent} from './elements/warp-view-3d-line/warp-view-3d-line.component';\nimport {WarpViewGlobeComponent} from './elements/warp-view-globe/warp-view-globe.component';\nimport {WarpViewEventDropComponent} from './elements/warp-view-event-drop/warp-view-event-drop.component';\nimport {WarpViewResultTileComponent} from './elements/warp-view-result-tile/warp-view-result-tile.component';\n\n@NgModule({\n  declarations: [\n    WarpViewTileComponent,\n    WarpViewChartComponent,\n    WarpViewSpinnerComponent,\n    WarpViewToggleComponent,\n    WarpViewBarComponent,\n    WarpViewBubbleComponent,\n    WarpViewDatagridComponent,\n    WarpViewPaginableComponent,\n    WarpViewDisplayComponent,\n    WarpViewDrillDownComponent,\n    CalendarHeatmapComponent,\n    WarpViewGtsPopupComponent,\n    WarpViewModalComponent,\n    WarpViewGtsTreeComponent,\n    WarpViewTreeViewComponent,\n    WarpViewChipComponent,\n    WarpViewImageComponent,\n    WarpViewMapComponent,\n    WarpViewHeatmapSlidersComponent,\n    WarpViewPieComponent,\n    WarpViewGaugeComponent,\n    WarpViewAnnotationComponent,\n    WarpViewPolarComponent,\n    WarpViewRadarComponent,\n    WarpViewPlotComponent,\n    WarpViewResizeComponent,\n    WarpViewSliderComponent,\n    WarpViewRangeSliderComponent,\n    WarpViewSpectrumComponent,\n    PlotlyComponent,\n    WarpViewBoxComponent,\n    WarpView3dLineComponent,\n    WarpViewGlobeComponent,\n    WarpViewEventDropComponent,\n    WarpViewResultTileComponent\n  ],\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    AngularResizedEventModule,\n    FormsModule\n  ],\n  exports: [\n    WarpViewTileComponent,\n    WarpViewChartComponent,\n    WarpViewSpinnerComponent,\n    WarpViewToggleComponent,\n    WarpViewBarComponent,\n    WarpViewBubbleComponent,\n    WarpViewDatagridComponent,\n    WarpViewPaginableComponent,\n    WarpViewDisplayComponent,\n    WarpViewDrillDownComponent,\n    CalendarHeatmapComponent,\n    WarpViewGtsPopupComponent,\n    WarpViewModalComponent,\n    WarpViewGtsTreeComponent,\n    WarpViewTreeViewComponent,\n    WarpViewChipComponent,\n    WarpViewImageComponent,\n    WarpViewMapComponent,\n    WarpViewHeatmapSlidersComponent,\n    WarpViewPieComponent,\n    WarpViewGaugeComponent,\n    WarpViewAnnotationComponent,\n    WarpViewPolarComponent,\n    WarpViewRadarComponent,\n    WarpViewPlotComponent,\n    WarpViewResizeComponent,\n    WarpViewSliderComponent,\n    WarpViewRangeSliderComponent,\n    WarpViewSpectrumComponent,\n    WarpViewBoxComponent,\n    WarpView3dLineComponent,\n    WarpViewGlobeComponent,\n    WarpViewEventDropComponent,\n    WarpViewResultTileComponent\n  ],\n  providers: [HttpErrorHandler, SizeService],\n  entryComponents: [\n    WarpViewTileComponent,\n    WarpViewChartComponent,\n    WarpViewSpinnerComponent,\n    WarpViewToggleComponent,\n    WarpViewBarComponent,\n    WarpViewBubbleComponent,\n    WarpViewDatagridComponent,\n    WarpViewPaginableComponent,\n    WarpViewDisplayComponent,\n    WarpViewDrillDownComponent,\n    CalendarHeatmapComponent,\n    WarpViewGtsPopupComponent,\n    WarpViewModalComponent,\n    WarpViewGtsTreeComponent,\n    WarpViewTreeViewComponent,\n    WarpViewChipComponent,\n    WarpViewImageComponent,\n    WarpViewMapComponent,\n    WarpViewHeatmapSlidersComponent,\n    WarpViewPieComponent,\n    WarpViewGaugeComponent,\n    WarpViewAnnotationComponent,\n    WarpViewPolarComponent,\n    WarpViewRadarComponent,\n    WarpViewPlotComponent,\n    WarpViewResizeComponent,\n    WarpViewSliderComponent,\n    WarpViewRangeSliderComponent,\n    WarpViewSpectrumComponent,\n    PlotlyComponent,\n    WarpViewBoxComponent,\n    WarpView3dLineComponent,\n    WarpViewGlobeComponent,\n    WarpViewEventDropComponent,\n    WarpViewResultTileComponent\n  ]\n})\nexport class WarpViewAngularModule {\n}\n"]}